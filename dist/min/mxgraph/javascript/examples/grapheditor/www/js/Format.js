/* 2017-11-21 */
Format=function(t,e){this.editorUi=t,this.container=e},Format.prototype.labelIndex=0,Format.prototype.currentIndex=0,Format.prototype.init=function(){var t=this.editorUi.editor.graph;this.update=mxUtils.bind(this,function(t,e){this.clearSelectionState(),this.refresh()}),t.getSelectionModel().addListener(mxEvent.CHANGE,this.update),t.addListener(mxEvent.EDITING_STARTED,this.update),t.addListener(mxEvent.EDITING_STOPPED,this.update),t.getModel().addListener(mxEvent.CHANGE,this.update),t.addListener(mxEvent.ROOT,mxUtils.bind(this,function(){this.refresh()})),this.refresh()},Format.prototype.clearSelectionState=function(){this.selectionState=null},Format.prototype.getSelectionState=function(){return null==this.selectionState&&(this.selectionState=this.createSelectionState()),this.selectionState},Format.prototype.createSelectionState=function(){for(var t=this.editorUi.editor.graph.getSelectionCells(),e=this.initSelectionState(),n=0;n<t.length;n++)this.updateSelectionStateForCell(e,t[n],t);return e},Format.prototype.initSelectionState=function(){return{vertices:[],edges:[],x:null,y:null,width:null,height:null,style:{},containsImage:!1,containsLabel:!1,fill:!0,glass:!0,rounded:!0,comic:!0,autoSize:!1,image:!0,shadow:!0,lineJumps:!0}},Format.prototype.updateSelectionStateForCell=function(t,e,n){var i=this.editorUi.editor.graph;if(i.getModel().isVertex(e)){t.vertices.push(e);var s=i.getCellGeometry(e);if(null!=s&&(s.width>0?null==t.width?t.width=s.width:t.width!=s.width&&(t.width=""):t.containsLabel=!0,s.height>0?null==t.height?t.height=s.height:t.height!=s.height&&(t.height=""):t.containsLabel=!0,!s.relative||null!=s.offset)){var l=s.relative?s.offset.x:s.x,o=s.relative?s.offset.y:s.y;null==t.x?t.x=l:t.x!=l&&(t.x=""),null==t.y?t.y=o:t.y!=o&&(t.y="")}}else i.getModel().isEdge(e)&&t.edges.push(e);var a=i.view.getState(e);if(null!=a){t.autoSize=t.autoSize||this.isAutoSizeState(a),t.glass=t.glass&&this.isGlassState(a),t.rounded=t.rounded&&this.isRoundedState(a),t.lineJumps=t.lineJumps&&this.isLineJumpState(a),t.comic=t.comic&&this.isComicState(a),t.image=t.image&&this.isImageState(a),t.shadow=t.shadow&&this.isShadowState(a),t.fill=t.fill&&this.isFillState(a);var r=mxUtils.getValue(a.style,mxConstants.STYLE_SHAPE,null);t.containsImage=t.containsImage||"image"==r;for(var d in a.style){var u=a.style[d];null!=u&&(null==t.style[d]?t.style[d]=u:t.style[d]!=u&&(t.style[d]=""))}}},Format.prototype.isFillState=function(t){return t.view.graph.model.isVertex(t.cell)||"arrow"==mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)||"filledEdge"==mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)||"flexArrow"==mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)},Format.prototype.isGlassState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"label"==e||"rectangle"==e||"internalStorage"==e||"ext"==e||"umlLifeline"==e||"swimlane"==e||"process"==e},Format.prototype.isRoundedState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"label"==e||"rectangle"==e||"internalStorage"==e||"corner"==e||"parallelogram"==e||"swimlane"==e||"triangle"==e||"trapezoid"==e||"ext"==e||"step"==e||"tee"==e||"process"==e||"link"==e||"rhombus"==e||"offPageConnector"==e||"loopLimit"==e||"hexagon"==e||"manualInput"==e||"curlyBracket"==e||"singleArrow"==e||"callout"==e||"doubleArrow"==e||"flexArrow"==e||"card"==e||"umlLifeline"==e},Format.prototype.isLineJumpState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"connector"==e||"filledEdge"==e},Format.prototype.isComicState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return mxUtils.indexOf(["label","rectangle","internalStorage","corner","parallelogram","note","collate","swimlane","triangle","trapezoid","ext","step","tee","process","link","rhombus","offPageConnector","loopLimit","hexagon","manualInput","singleArrow","doubleArrow","flexArrow","filledEdge","card","umlLifeline","connector","folder","component","sortShape","cross","umlFrame","cube","isoCube","isoRectangle","partialRectangle"],e)>=0},Format.prototype.isAutoSizeState=function(t){return"1"==mxUtils.getValue(t.style,mxConstants.STYLE_AUTOSIZE,null)},Format.prototype.isImageState=function(t){var e=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null);return"label"==e||"image"==e},Format.prototype.isShadowState=function(t){return"image"!=mxUtils.getValue(t.style,mxConstants.STYLE_SHAPE,null)},Format.prototype.clear=function(){if(this.container.innerHTML="",null!=this.panels)for(var t=0;t<this.panels.length;t++)this.panels[t].destroy();this.panels=[]},Format.prototype.refresh=function(){if("0px"!=this.container.style.width){this.clear();var t=this.editorUi,e=t.editor.graph,n=document.createElement("div");n.style.whiteSpace="nowrap",n.style.color="rgb(112, 112, 112)",n.style.textAlign="left",n.style.cursor="default";var i=document.createElement("div");if(i.style.border="1px solid #c0c0c0",i.style.borderWidth="0px 0px 1px 0px",i.style.textAlign="center",i.style.fontWeight="bold",i.style.overflow="hidden",i.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",i.style.paddingTop="8px",i.style.height=mxClient.IS_QUIRKS?"34px":"25px",i.style.width="100%",this.container.appendChild(n),e.isSelectionEmpty()){mxUtils.write(i,mxResources.get("diagram"));var s=document.createElement("img");s.setAttribute("border","0"),s.setAttribute("src",Dialog.prototype.closeImage),s.setAttribute("title",mxResources.get("hide")),s.style.position="absolute",s.style.display="block",s.style.right="0px",s.style.top="8px",s.style.cursor="pointer",s.style.marginTop="1px",s.style.marginRight="17px",s.style.border="1px solid transparent",s.style.padding="1px",s.style.opacity=.5,i.appendChild(s),mxEvent.addListener(s,"click",function(){t.actions.get("formatPanel").funct()}),n.appendChild(i),this.panels.push(new DiagramFormatPanel(this,t,n))}else if(e.isEditing())mxUtils.write(i,mxResources.get("text")),n.appendChild(i),this.panels.push(new TextFormatPanel(this,t,n));else{var l=this.getSelectionState().containsLabel,o=null,a=null,r=mxUtils.bind(this,function(t,e,n){var i=mxUtils.bind(this,function(i){o!=t&&(l?this.labelIndex=n:this.currentIndex=n,null!=o&&(o.style.backgroundColor="#d7d7d7",o.style.borderBottomWidth="1px"),(o=t).style.backgroundColor="",o.style.borderBottomWidth="0px",a!=e&&(null!=a&&(a.style.display="none"),(a=e).style.display=""))});mxEvent.addListener(t,"click",i),n==(l?this.labelIndex:this.currentIndex)&&i()}),d=0;i.style.backgroundColor="#d7d7d7",i.style.borderLeftWidth="1px",i.style.width=l?"50%":"33.3%",i.style.width=l?"50%":"33.3%";var u=i.cloneNode(!1),m=u.cloneNode(!1);if(u.style.backgroundColor="#d7d7d7",m.style.backgroundColor="#d7d7d7",l)u.style.borderLeftWidth="0px";else{i.style.borderLeftWidth="0px",mxUtils.write(i,mxResources.get("style")),n.appendChild(i);var p=n.cloneNode(!1);p.style.display="none",this.panels.push(new StyleFormatPanel(this,t,p)),this.container.appendChild(p),r(i,p,d++)}mxUtils.write(u,mxResources.get("text")),n.appendChild(u);var c=n.cloneNode(!1);c.style.display="none",this.panels.push(new TextFormatPanel(this,t,c)),this.container.appendChild(c),mxUtils.write(m,mxResources.get("arrange")),n.appendChild(m);var g=n.cloneNode(!1);g.style.display="none",this.panels.push(new ArrangePanel(this,t,g)),this.container.appendChild(g),r(u,c,d++),r(m,g,d++)}}},BaseFormatPanel=function(t,e,n){this.format=t,this.editorUi=e,this.container=n,this.listeners=[]},BaseFormatPanel.prototype.getSelectionState=function(){for(var t=this.editorUi.editor.graph,e=t.getSelectionCells(),n=null,i=0;i<e.length;i++){var s=t.view.getState(e[i]);if(null!=s){var l=mxUtils.getValue(s.style,mxConstants.STYLE_SHAPE,null);if(null!=l)if(null==n)n=l;else if(n!=l)return null}}return n},BaseFormatPanel.prototype.installInputHandler=function(t,e,n,i,s,l,o,a){l=null!=l?l:"",a=null!=a&&a;var r=this.editorUi,d=r.editor.graph;i=null!=i?i:1,s=null!=s?s:999;var u=null,m=!1,p=mxUtils.bind(this,function(p){var c=a?parseFloat(t.value):parseInt(t.value);if(isNaN(c)||e!=mxConstants.STYLE_ROTATION||(c=mxUtils.mod(Math.round(100*c),36e3)/100),c=Math.min(s,Math.max(i,isNaN(c)?n:c)),d.cellEditor.isContentEditing()&&o)m||(m=!0,null!=u&&(d.cellEditor.restoreSelection(u),u=null),o(c),t.value=c+l,m=!1);else if(c!=mxUtils.getValue(this.format.getSelectionState().style,e,n)){d.isEditing()&&d.stopEditing(!0),d.getModel().beginUpdate();try{if(d.setCellStyles(e,c,d.getSelectionCells()),e==mxConstants.STYLE_FONTSIZE)for(var g=d.getSelectionCells(),h=0;h<g.length;h++){var x=g[h];if(d.isHtmlLabel(x)){var y=document.createElement("div");y.innerHTML=d.convertValueToString(x);for(var S=y.getElementsByTagName("font"),C=0;C<S.length;C++)S[C].removeAttribute("size"),S[C].style.fontSize=c+"px";d.cellLabelChanged(x,y.innerHTML)}}}finally{d.getModel().endUpdate()}r.fireEvent(new mxEventObject("styleChanged","keys",[e],"values",[c],"cells",d.getSelectionCells()))}t.value=c+l,mxEvent.consume(p)});return o&&d.cellEditor.isContentEditing()&&(mxEvent.addListener(t,"mousedown",function(){u=d.cellEditor.saveSelection()}),mxEvent.addListener(t,"touchstart",function(){u=d.cellEditor.saveSelection()})),mxEvent.addListener(t,"change",p),mxEvent.addListener(t,"blur",p),p},BaseFormatPanel.prototype.createPanel=function(){var t=document.createElement("div");return t.style.padding="12px 0px 12px 18px",t.style.borderBottom="1px solid #c0c0c0",t},BaseFormatPanel.prototype.createTitle=function(t){var e=document.createElement("div");return e.style.padding="0px 0px 6px 0px",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.width="200px",e.style.fontWeight="bold",mxUtils.write(e,t),e},BaseFormatPanel.prototype.createStepper=function(t,e,n,i,s,l){n=null!=n?n:1,i=null!=i?i:8,mxClient.IS_QUIRKS?i-=2:(mxClient.IS_MT||document.documentMode>=8)&&(i+=1);var o=document.createElement("div");mxUtils.setPrefixedStyle(o.style,"borderRadius","3px"),o.style.border="1px solid rgb(192, 192, 192)",o.style.position="absolute";var a=document.createElement("div");a.style.borderBottom="1px solid rgb(192, 192, 192)",a.style.position="relative",a.style.height=i+"px",a.style.width="10px",a.className="geBtnUp",o.appendChild(a);var r=a.cloneNode(!1);if(r.style.border="none",r.style.height=i+"px",r.className="geBtnDown",o.appendChild(r),mxEvent.addListener(r,"click",function(i){""==t.value&&(t.value=l||"2");var s=parseInt(t.value);isNaN(s)||(t.value=s-n,null!=e&&e(i)),mxEvent.consume(i)}),mxEvent.addListener(a,"click",function(i){""==t.value&&(t.value=l||"0");var s=parseInt(t.value);isNaN(s)||(t.value=s+n,null!=e&&e(i)),mxEvent.consume(i)}),s){var d=null;mxEvent.addGestureListeners(o,function(t){(mxClient.IS_QUIRKS||8==document.documentMode)&&(d=document.selection.createRange()),mxEvent.consume(t)},null,function(t){if(null!=d){try{d.select()}catch(t){}d=null,mxEvent.consume(t)}})}return o},BaseFormatPanel.prototype.createOption=function(t,e,n,i){var s=document.createElement("div");s.style.padding="6px 0px 1px 0px",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.width="200px",s.style.height=mxClient.IS_QUIRKS?"27px":"18px";var l=document.createElement("input");l.setAttribute("type","checkbox"),l.style.margin="0px 6px 0px 0px",s.appendChild(l);var o=document.createElement("span");mxUtils.write(o,t),s.appendChild(o);var a=!1,r=e(),d=function(t){a||(a=!0,t?(l.setAttribute("checked","checked"),l.defaultChecked=!0,l.checked=!0):(l.removeAttribute("checked"),l.defaultChecked=!1,l.checked=!1),r!=t&&(r=t,e()!=r&&n(r)),a=!1)};return mxEvent.addListener(s,"click",function(t){var e=mxEvent.getSource(t);e!=s&&e!=o||(l.checked=!l.checked),d(l.checked)}),d(r),null!=i&&(i.install(d),this.listeners.push(i)),s},BaseFormatPanel.prototype.createCellOption=function(t,e,n,i,s,l,o,a){i=null!=i?"null"==i?null:i:"1",s=null!=s?"null"==s?null:s:"0";var r=this.editorUi,d=r.editor.graph;return this.createOption(t,function(){var t=d.view.getState(d.getSelectionCell());return null!=t?mxUtils.getValue(t.style,e,n)!=s:null},function(t){if(a&&d.stopEditing(),null!=o)o.funct();else{d.getModel().beginUpdate();try{var n=t?i:s;d.setCellStyles(e,n,d.getSelectionCells()),null!=l&&l(d.getSelectionCells(),n),r.fireEvent(new mxEventObject("styleChanged","keys",[e],"values",[n],"cells",d.getSelectionCells()))}finally{d.getModel().endUpdate()}}},{install:function(t){this.listener=function(){var i=d.view.getState(d.getSelectionCell());null!=i&&t(mxUtils.getValue(i.style,e,n)!=s)},d.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){d.getModel().removeListener(this.listener)}})},BaseFormatPanel.prototype.createColorOption=function(t,e,n,i,s,l,o){var a=document.createElement("div");a.style.padding="6px 0px 1px 0px",a.style.whiteSpace="nowrap",a.style.overflow="hidden",a.style.width="200px",a.style.height=mxClient.IS_QUIRKS?"27px":"18px";var r=document.createElement("input");r.setAttribute("type","checkbox"),r.style.margin="0px 6px 0px 0px",o||a.appendChild(r);var d=document.createElement("span");mxUtils.write(d,t),a.appendChild(d);var u=!1,m=e(),p=null,c=function(t,s){u||(u=!0,p.innerHTML='<div style="width:'+(mxClient.IS_QUIRKS?"30":"36")+"px;height:12px;margin:3px;border:1px solid black;background-color:"+(null!=t&&t!=mxConstants.NONE?t:i)+';"></div>',(mxClient.IS_MT||mxClient.IS_QUIRKS||8==document.documentMode)&&(p.firstChild.style.margin="0px"),null!=t&&t!=mxConstants.NONE?(r.setAttribute("checked","checked"),r.defaultChecked=!0,r.checked=!0):(r.removeAttribute("checked"),r.defaultChecked=!1,r.checked=!1),p.style.display=r.checked||o?"":"none",null!=l&&l(t),s||!o&&m==t||(m=t,(o||e()!=m)&&n(m)),u=!1)};return p=mxUtils.button("",mxUtils.bind(this,function(t){this.editorUi.pickColor(m,c),mxEvent.consume(t)})),p.style.position="absolute",p.style.marginTop="-4px",p.style.right=mxClient.IS_QUIRKS?"0px":"20px",p.style.height="22px",p.className="geColorBtn",p.style.display=r.checked||o?"":"none",a.appendChild(p),mxEvent.addListener(a,"click",function(t){var e=mxEvent.getSource(t);e!=r&&"INPUT"==e.nodeName||(e!=r&&(r.checked=!r.checked),r.checked||null==m||m==mxConstants.NONE||i==mxConstants.NONE||(i=m),c(r.checked?i:mxConstants.NONE))}),c(m,!0),null!=s&&(s.install(c),this.listeners.push(s)),a},BaseFormatPanel.prototype.createCellColorOption=function(t,e,n,i,s){var l=this.editorUi,o=l.editor.graph;return this.createColorOption(t,function(){var t=o.view.getState(o.getSelectionCell());return null!=t?mxUtils.getValue(t.style,e,null):null},function(t){o.getModel().beginUpdate();try{null!=s&&s(t),o.setCellStyles(e,t,o.getSelectionCells()),l.fireEvent(new mxEventObject("styleChanged","keys",[e],"values",[t],"cells",o.getSelectionCells()))}finally{o.getModel().endUpdate()}},n||mxConstants.NONE,{install:function(t){this.listener=function(){var n=o.view.getState(o.getSelectionCell());null!=n&&t(mxUtils.getValue(n.style,e,null))},o.getModel().addListener(mxEvent.CHANGE,this.listener)},destroy:function(){o.getModel().removeListener(this.listener)}},i)},BaseFormatPanel.prototype.addArrow=function(t,e){e=null!=e?e:10;var n=document.createElement("div");n.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",n.style.padding="6px",n.style.paddingRight="4px";var i=10-e;2==i?n.style.paddingTop="6px":i>0?n.style.paddingTop=6-i+"px":n.style.marginTop="-2px",n.style.height=e+"px",n.style.borderLeft="1px solid #a0a0a0",n.innerHTML='<img border="0" src="'+(mxClient.IS_SVG?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHBJREFUeNpidHB2ZyAGsACxDRBPIKCuA6TwCBB/h2rABu4A8SYmKCcXiP/iUFgAxL9gCi8A8SwsirZCMQMTkmANEH9E4v+CmsaArvAdyNFI/FlQ92EoBIE+qCRIUz168DBgsU4OqhinQpgHMABAgAEALY4XLIsJ20oAAAAASUVORK5CYII=":IMAGE_PATH+"/dropdown.png")+'" style="margin-bottom:4px;">',mxUtils.setOpacity(n,70);var s=t.getElementsByTagName("div")[0];return null!=s&&(s.style.paddingRight="6px",s.style.marginLeft="4px",s.style.marginTop="-1px",s.style.display=mxClient.IS_QUIRKS?"inline":"inline-block",mxUtils.setOpacity(s,60)),mxUtils.setOpacity(t,100),t.style.border="1px solid #a0a0a0",t.style.backgroundColor="white",t.style.backgroundImage="none",t.style.width="auto",t.className+=" geColorBtn",mxUtils.setPrefixedStyle(t.style,"borderRadius","3px"),t.appendChild(n),s},BaseFormatPanel.prototype.addUnitInput=function(t,e,n,i,s,l,o,a){o=null!=o?o:0;var r=document.createElement("input");r.style.position="absolute",r.style.textAlign="right",r.style.marginTop="-2px",r.style.right=n+12+"px",r.style.width=i+"px",t.appendChild(r);var d=this.createStepper(r,s,l,null,a);return d.style.marginTop=o-2+"px",d.style.right=n+"px",t.appendChild(d),r},BaseFormatPanel.prototype.createRelativeOption=function(t,e,n,i,s){function l(t){if(null!=i)i(r);else{var n=parseInt(r.value);n=Math.min(100,Math.max(0,isNaN(n)?100:n));var s=o.view.getState(o.getSelectionCell());null!=s&&n!=mxUtils.getValue(s.style,e,100)&&(100==n&&(n=null),o.setCellStyles(e,n,o.getSelectionCells())),r.value=(null!=n?n:"100")+" %"}mxEvent.consume(t)}n=null!=n?n:44;var o=this.editorUi.editor.graph,a=this.createPanel();a.style.paddingTop="10px",a.style.paddingBottom="10px",mxUtils.write(a,t),a.style.fontWeight="bold";var r=this.addUnitInput(a,"%",20,n,l,10,-15,null!=i);if(null!=e){var d=mxUtils.bind(this,function(t,n,i){if(i||r!=document.activeElement){var s=this.format.getSelectionState(),l=parseInt(mxUtils.getValue(s.style,e,100));r.value=isNaN(l)?"":l+" %"}});mxEvent.addListener(r,"keydown",function(t){13==t.keyCode?(o.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(d(null,null,!0),o.container.focus(),mxEvent.consume(t))}),o.getModel().addListener(mxEvent.CHANGE,d),this.listeners.push({destroy:function(){o.getModel().removeListener(d)}}),d()}return mxEvent.addListener(r,"blur",l),mxEvent.addListener(r,"change",l),null!=s&&s(r),a},BaseFormatPanel.prototype.addLabel=function(t,e,n,i){i=null!=i?i:61;var s=document.createElement("div");mxUtils.write(s,e),s.style.position="absolute",s.style.right=n+"px",s.style.width=i+"px",s.style.marginTop="6px",s.style.textAlign="center",t.appendChild(s)},BaseFormatPanel.prototype.addKeyHandler=function(t,e){mxEvent.addListener(t,"keydown",mxUtils.bind(this,function(t){13==t.keyCode?(this.editorUi.editor.graph.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(null!=e&&e(null,null,!0),this.editorUi.editor.graph.container.focus(),mxEvent.consume(t))}))},BaseFormatPanel.prototype.styleButtons=function(t){for(var e=0;e<t.length;e++)mxUtils.setPrefixedStyle(t[e].style,"borderRadius","3px"),mxUtils.setOpacity(t[e],100),t[e].style.border="1px solid #a0a0a0",t[e].style.padding="4px",t[e].style.paddingTop="3px",t[e].style.paddingRight="1px",t[e].style.margin="1px",t[e].style.width="24px",t[e].style.height="20px",t[e].className+=" geColorBtn"},BaseFormatPanel.prototype.destroy=function(){if(null!=this.listeners){for(var t=0;t<this.listeners.length;t++)this.listeners[t].destroy();this.listeners=null}},ArrangePanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(ArrangePanel,BaseFormatPanel),ArrangePanel.prototype.init=function(){this.editorUi.editor.graph;var t=this.format.getSelectionState();this.container.appendChild(this.addLayerOps(this.createPanel())),this.addGeometry(this.container),this.addEdgeGeometry(this.container),t.containsLabel&&0!=t.edges.length||this.container.appendChild(this.addAngle(this.createPanel())),t.containsLabel||0!=t.edges.length||this.container.appendChild(this.addFlip(this.createPanel())),t.vertices.length>1&&(this.container.appendChild(this.addAlign(this.createPanel())),this.container.appendChild(this.addDistribute(this.createPanel()))),this.container.appendChild(this.addGroupOps(this.createPanel()))},ArrangePanel.prototype.addLayerOps=function(t){var e=this.editorUi,n=mxUtils.button(mxResources.get("toFront"),function(t){e.actions.get("toFront").funct()});return n.setAttribute("title",mxResources.get("toFront")+" ("+this.editorUi.actions.get("toFront").shortcut+")"),n.style.width="100px",n.style.marginRight="2px",t.appendChild(n),(n=mxUtils.button(mxResources.get("toBack"),function(t){e.actions.get("toBack").funct()})).setAttribute("title",mxResources.get("toBack")+" ("+this.editorUi.actions.get("toBack").shortcut+")"),n.style.width="100px",t.appendChild(n),t},ArrangePanel.prototype.addGroupOps=function(t){var e=this.editorUi,n=e.editor.graph,i=n.getSelectionCell(),s=(this.format.getSelectionState(),0);return t.style.paddingTop="8px",t.style.paddingBottom="6px",n.getSelectionCount()>1?(btn=mxUtils.button(mxResources.get("group"),function(t){e.actions.get("group").funct()}),btn.setAttribute("title",mxResources.get("group")+" ("+this.editorUi.actions.get("group").shortcut+")"),btn.style.width="202px",btn.style.marginBottom="2px",t.appendChild(btn),s++):1==n.getSelectionCount()&&!n.getModel().isEdge(i)&&!n.isSwimlane(i)&&n.getModel().getChildCount(i)>0&&(btn=mxUtils.button(mxResources.get("ungroup"),function(t){e.actions.get("ungroup").funct()}),btn.setAttribute("title",mxResources.get("ungroup")+" ("+this.editorUi.actions.get("ungroup").shortcut+")"),btn.style.width="202px",btn.style.marginBottom="2px",t.appendChild(btn),s++),1==n.getSelectionCount()&&n.getModel().isVertex(i)&&n.getModel().isVertex(n.getModel().getParent(i))?(s>0&&mxUtils.br(t),btn=mxUtils.button(mxResources.get("removeFromGroup"),function(t){e.actions.get("removeFromGroup").funct()}),btn.setAttribute("title",mxResources.get("removeFromGroup")),btn.style.width="202px",btn.style.marginBottom="2px",t.appendChild(btn),s++):n.getSelectionCount()>0&&(s>0&&mxUtils.br(t),btn=mxUtils.button(mxResources.get("clearWaypoints"),mxUtils.bind(this,function(t){this.editorUi.actions.get("clearWaypoints").funct()})),btn.setAttribute("title",mxResources.get("clearWaypoints")+" ("+this.editorUi.actions.get("clearWaypoints").shortcut+")"),btn.style.width="202px",btn.style.marginBottom="2px",t.appendChild(btn),s++),1==n.getSelectionCount()&&(s>0&&mxUtils.br(t),btn=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editData").funct()})),btn.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")"),btn.style.width="100px",btn.style.marginBottom="2px",t.appendChild(btn),s++,btn=mxUtils.button(mxResources.get("editLink"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editLink").funct()})),btn.setAttribute("title",mxResources.get("editLink")),btn.style.width="100px",btn.style.marginLeft="2px",btn.style.marginBottom="2px",t.appendChild(btn),s++),0==s&&(t.style.display="none"),t},ArrangePanel.prototype.addAlign=function(t){var e=this.editorUi.editor.graph;t.style.paddingTop="6px",t.style.paddingBottom="12px",t.appendChild(this.createTitle(mxResources.get("align")));var n=document.createElement("div");n.style.position="relative",n.style.paddingLeft="0px",n.style.borderWidth="0px",n.className="geToolbarContainer",mxClient.IS_QUIRKS&&(t.style.height="60px");var i=this.editorUi.toolbar.addButton("geSprite-alignleft",mxResources.get("left"),function(){e.alignCells(mxConstants.ALIGN_LEFT)},n),s=this.editorUi.toolbar.addButton("geSprite-aligncenter",mxResources.get("center"),function(){e.alignCells(mxConstants.ALIGN_CENTER)},n),l=this.editorUi.toolbar.addButton("geSprite-alignright",mxResources.get("right"),function(){e.alignCells(mxConstants.ALIGN_RIGHT)},n),o=this.editorUi.toolbar.addButton("geSprite-aligntop",mxResources.get("top"),function(){e.alignCells(mxConstants.ALIGN_TOP)},n),a=this.editorUi.toolbar.addButton("geSprite-alignmiddle",mxResources.get("middle"),function(){e.alignCells(mxConstants.ALIGN_MIDDLE)},n),r=this.editorUi.toolbar.addButton("geSprite-alignbottom",mxResources.get("bottom"),function(){e.alignCells(mxConstants.ALIGN_BOTTOM)},n);return this.styleButtons([i,s,l,o,a,r]),l.style.marginRight="6px",t.appendChild(n),t},ArrangePanel.prototype.addFlip=function(t){var e=this.editorUi.editor.graph;t.style.paddingTop="6px",t.style.paddingBottom="10px";var n=document.createElement("div");n.style.marginTop="2px",n.style.marginBottom="8px",n.style.fontWeight="bold",mxUtils.write(n,mxResources.get("flip")),t.appendChild(n);var i=mxUtils.button(mxResources.get("horizontal"),function(t){e.toggleCellStyles(mxConstants.STYLE_FLIPH,!1)});return i.setAttribute("title",mxResources.get("horizontal")),i.style.width="100px",i.style.marginRight="2px",t.appendChild(i),(i=mxUtils.button(mxResources.get("vertical"),function(t){e.toggleCellStyles(mxConstants.STYLE_FLIPV,!1)})).setAttribute("title",mxResources.get("vertical")),i.style.width="100px",t.appendChild(i),t},ArrangePanel.prototype.addDistribute=function(t){var e=this.editorUi.editor.graph;t.style.paddingTop="6px",t.style.paddingBottom="12px",t.appendChild(this.createTitle(mxResources.get("distribute")));var n=mxUtils.button(mxResources.get("horizontal"),function(t){e.distributeCells(!0)});return n.setAttribute("title",mxResources.get("horizontal")),n.style.width="100px",n.style.marginRight="2px",t.appendChild(n),(n=mxUtils.button(mxResources.get("vertical"),function(t){e.distributeCells(!1)})).setAttribute("title",mxResources.get("vertical")),n.style.width="100px",t.appendChild(n),t},ArrangePanel.prototype.addAngle=function(t){var e=this.editorUi,n=e.editor.graph,i=this.format.getSelectionState();t.style.paddingBottom="8px";var s=document.createElement("div");s.style.position="absolute",s.style.width="70px",s.style.marginTop="0px",s.style.fontWeight="bold";var l=null,o=null,a=null;if(0==i.edges.length?(mxUtils.write(s,mxResources.get("angle")),t.appendChild(s),l=this.addUnitInput(t,"°",20,44,function(){o.apply(this,arguments)}),mxUtils.br(t),t.style.paddingTop="10px"):t.style.paddingTop="8px",!i.containsLabel){var r=mxResources.get("reverse");i.vertices.length>0&&i.edges.length>0?r=mxResources.get("turn")+" / "+r:i.vertices.length>0&&(r=mxResources.get("turn")),(a=mxUtils.button(r,function(t){e.actions.get("turn").funct()})).setAttribute("title",r+" ("+this.editorUi.actions.get("turn").shortcut+")"),a.style.width="202px",t.appendChild(a),null!=l&&(a.style.marginTop="8px")}if(null!=l){var d=mxUtils.bind(this,function(t,e,n){if(n||document.activeElement!=l){i=this.format.getSelectionState();var s=parseFloat(mxUtils.getValue(i.style,mxConstants.STYLE_ROTATION,0));l.value=isNaN(s)?"":s+"°"}});o=this.installInputHandler(l,mxConstants.STYLE_ROTATION,0,0,360,"°",null,!0),this.addKeyHandler(l,d),n.getModel().addListener(mxEvent.CHANGE,d),this.listeners.push({destroy:function(){n.getModel().removeListener(d)}}),d()}return t},ArrangePanel.prototype.addGeometry=function(t){var e=this.editorUi,n=e.editor.graph,i=this.format.getSelectionState(),s=this.createPanel();s.style.paddingBottom="8px";var l=document.createElement("div");l.style.position="absolute",l.style.width="50px",l.style.marginTop="0px",l.style.fontWeight="bold",mxUtils.write(l,mxResources.get("size")),s.appendChild(l);var o,a,r,d,u=this.addUnitInput(s,"pt",84,44,function(){o.apply(this,arguments)}),m=this.addUnitInput(s,"pt",20,44,function(){a.apply(this,arguments)}),p=document.createElement("div");p.className="geSprite geSprite-fit",p.setAttribute("title",mxResources.get("autosize")+" ("+this.editorUi.actions.get("autosize").shortcut+")"),p.style.position="relative",p.style.cursor="pointer",p.style.marginTop="-3px",p.style.border="0px",p.style.left="52px",mxUtils.setOpacity(p,50),mxEvent.addListener(p,"mouseenter",function(){mxUtils.setOpacity(p,100)}),mxEvent.addListener(p,"mouseleave",function(){mxUtils.setOpacity(p,50)}),mxEvent.addListener(p,"click",function(){e.actions.get("autosize").funct()}),s.appendChild(p),this.addLabel(s,mxResources.get("width"),84),this.addLabel(s,mxResources.get("height"),20),mxUtils.br(s);var c=document.createElement("div");c.style.paddingTop="8px",c.style.paddingRight="20px",c.style.whiteSpace="nowrap",c.style.textAlign="right";var g=this.createCellOption(mxResources.get("constrainProportions"),mxConstants.STYLE_ASPECT,null,"fixed","null");g.style.width="100%",c.appendChild(g),s.appendChild(c),this.addKeyHandler(u,S),this.addKeyHandler(m,S),o=this.addGeometryHandler(u,function(t,e){t.width>0&&(t.width=Math.max(1,e))}),a=this.addGeometryHandler(m,function(t,e){t.height>0&&(t.height=Math.max(1,e))}),t.appendChild(s);var h=this.createPanel();h.style.paddingBottom="30px",(l=document.createElement("div")).style.position="absolute",l.style.width="70px",l.style.marginTop="0px",l.style.fontWeight="bold",mxUtils.write(l,mxResources.get("position")),h.appendChild(l);var x=this.addUnitInput(h,"pt",84,44,function(){r.apply(this,arguments)}),y=this.addUnitInput(h,"pt",20,44,function(){d.apply(this,arguments)});mxUtils.br(h),this.addLabel(h,mxResources.get("left"),84),this.addLabel(h,mxResources.get("top"),20);var S=mxUtils.bind(this,function(t,e,l){(i=this.format.getSelectionState()).containsLabel||i.vertices.length!=n.getSelectionCount()||null==i.width||null==i.height?s.style.display="none":(s.style.display="",(l||document.activeElement!=u)&&(u.value=i.width+(""==i.width?"":" pt")),(l||document.activeElement!=m)&&(m.value=i.height+(""==i.height?"":" pt"))),i.vertices.length==n.getSelectionCount()&&null!=i.x&&null!=i.y?(h.style.display="",(l||document.activeElement!=x)&&(x.value=i.x+(""==i.x?"":" pt")),(l||document.activeElement!=y)&&(y.value=i.y+(""==i.y?"":" pt"))):h.style.display="none"});this.addKeyHandler(x,S),this.addKeyHandler(y,S),n.getModel().addListener(mxEvent.CHANGE,S),this.listeners.push({destroy:function(){n.getModel().removeListener(S)}}),S(),r=this.addGeometryHandler(x,function(t,e){t.relative?t.offset.x=e:t.x=e}),d=this.addGeometryHandler(y,function(t,e){t.relative?t.offset.y=e:t.y=e}),t.appendChild(h)},ArrangePanel.prototype.addGeometryHandler=function(t,e){function n(n){if(""!=t.value){var l=parseFloat(t.value);if(l!=s){i.getModel().beginUpdate();try{for(var o=i.getSelectionCells(),a=0;a<o.length;a++)if(i.getModel().isVertex(o[a])){var r=i.getCellGeometry(o[a]);null!=r&&(r=r.clone(),e(r,l),i.getModel().setGeometry(o[a],r))}}finally{i.getModel().endUpdate()}s=l,t.value=l+" pt"}else isNaN(l)&&(t.value=s+" pt")}mxEvent.consume(n)}var i=this.editorUi.editor.graph,s=null;return mxEvent.addListener(t,"blur",n),mxEvent.addListener(t,"change",n),mxEvent.addListener(t,"focus",function(){s=t.value}),n},ArrangePanel.prototype.addEdgeGeometry=function(t){function e(t){var e=parseInt(a.value);(e=Math.min(999,Math.max(1,isNaN(e)?1:e)))!=mxUtils.getValue(s.style,"width",mxCellRenderer.prototype.defaultShapes.flexArrow.prototype.defaultWidth)&&(i.setCellStyles("width",e,i.getSelectionCells()),n.fireEvent(new mxEventObject("styleChanged","keys",["width"],"values",[e],"cells",i.getSelectionCells()))),a.value=e+" pt",mxEvent.consume(t)}var n=this.editorUi,i=n.editor.graph,s=this.format.getSelectionState(),l=this.createPanel(),o=document.createElement("div");o.style.position="absolute",o.style.width="70px",o.style.marginTop="0px",o.style.fontWeight="bold",mxUtils.write(o,mxResources.get("width")),l.appendChild(o);var e,a=this.addUnitInput(l,"pt",20,44,function(){e.apply(this,arguments)});mxUtils.br(l),this.addKeyHandler(a,r),mxEvent.addListener(a,"blur",e),mxEvent.addListener(a,"change",e),t.appendChild(l);var r=mxUtils.bind(this,function(t,e,n){if("link"==(s=this.format.getSelectionState()).style.shape||"flexArrow"==s.style.shape){if(l.style.display="",n||document.activeElement!=a){var i=mxUtils.getValue(s.style,"width",mxCellRenderer.prototype.defaultShapes.flexArrow.prototype.defaultWidth);a.value=i+" pt"}}else l.style.display="none"});i.getModel().addListener(mxEvent.CHANGE,r),this.listeners.push({destroy:function(){i.getModel().removeListener(r)}}),r()},TextFormatPanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(TextFormatPanel,BaseFormatPanel),TextFormatPanel.prototype.init=function(){this.container.style.borderBottom="none",this.addFont(this.container)},TextFormatPanel.prototype.addFont=function(t){function e(t,e){mxClient.IS_IE&&(mxClient.IS_QUIRKS||document.documentMode<10)?t.style.filter=e?"progid:DXImageTransform.Microsoft.Gradient(StartColorStr='#c5ecff', EndColorStr='#87d4fb', GradientType=0)":"":t.style.backgroundImage=e?"linear-gradient(#c5ecff 0px,#87d4fb 100%)":""}var n=this.editorUi,i=n.editor.graph,s=this.format.getSelectionState(),l=this.createTitle(mxResources.get("font"));l.style.paddingLeft="18px",l.style.paddingTop="10px",l.style.paddingBottom="6px",t.appendChild(l);var o=this.createPanel();if(o.style.paddingTop="2px",o.style.paddingBottom="2px",o.style.position="relative",o.style.marginLeft="-2px",o.style.borderWidth="0px",o.className="geToolbarContainer",mxClient.IS_QUIRKS&&(o.style.display="block"),i.cellEditor.isContentEditing()){var a=o.cloneNode(),r=this.editorUi.toolbar.addMenu(mxResources.get("style"),mxResources.get("style"),!0,"formatBlock",a);r.style.color="rgb(112, 112, 112)",r.style.whiteSpace="nowrap",r.style.overflow="hidden",r.style.margin="0px",this.addArrow(r),r.style.width="192px",r.style.height="15px",(K=r.getElementsByTagName("div")[0]).style.cssFloat="right",t.appendChild(a)}t.appendChild(o);var d=this.createPanel();d.style.marginTop="8px",d.style.borderTop="1px solid #c0c0c0",d.style.paddingTop="6px",d.style.paddingBottom="6px";var u=this.editorUi.toolbar.addMenu("Helvetica",mxResources.get("fontFamily"),!0,"fontFamily",o);u.style.color="rgb(112, 112, 112)",u.style.whiteSpace="nowrap",u.style.overflow="hidden",u.style.margin="0px",this.addArrow(u),u.style.width="192px",u.style.height="15px",mxClient.IS_FF&&(u.getElementsByTagName("div")[0].style.marginTop="-18px");var m=o.cloneNode(!1);m.style.marginLeft="-3px";var p=this.editorUi.toolbar.addItems(["bold","italic","underline"],m,!0);p[0].setAttribute("title",mxResources.get("bold")+" ("+this.editorUi.actions.get("bold").shortcut+")"),p[1].setAttribute("title",mxResources.get("italic")+" ("+this.editorUi.actions.get("italic").shortcut+")"),p[2].setAttribute("title",mxResources.get("underline")+" ("+this.editorUi.actions.get("underline").shortcut+")");var c=this.editorUi.toolbar.addItems(["vertical"],m,!0)[0];mxClient.IS_QUIRKS&&mxUtils.br(t),t.appendChild(m),this.styleButtons(p),this.styleButtons([c]);var g=o.cloneNode(!1);g.style.marginLeft="-3px",g.style.paddingBottom="0px";var h=this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),i.cellEditor.isContentEditing()?function(){document.execCommand("justifyleft",!1,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_LEFT]),g),x=this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),i.cellEditor.isContentEditing()?function(){document.execCommand("justifycenter",!1,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_CENTER]),g),y=this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),i.cellEditor.isContentEditing()?function(){document.execCommand("justifyright",!1,null)}:this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_ALIGN],[mxConstants.ALIGN_RIGHT]),g);if(this.styleButtons([h,x,y]),i.cellEditor.isContentEditing()){var S=this.editorUi.toolbar.addButton("geSprite-removeformat",mxResources.get("removeFormat"),function(){document.execCommand("removeformat",!1,null)},m);this.styleButtons([S])}var C=this.editorUi.toolbar.addButton("geSprite-top",mxResources.get("top"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_TOP]),g),E=this.editorUi.toolbar.addButton("geSprite-middle",mxResources.get("middle"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_MIDDLE]),g),f=this.editorUi.toolbar.addButton("geSprite-bottom",mxResources.get("bottom"),this.editorUi.menus.createStyleChangeFunction([mxConstants.STYLE_VERTICAL_ALIGN],[mxConstants.ALIGN_BOTTOM]),g);this.styleButtons([C,E,f]),mxClient.IS_QUIRKS&&mxUtils.br(t),t.appendChild(g);var T,R,v,L,A,b,I;if(i.cellEditor.isContentEditing()){C.style.display="none",E.style.display="none",f.style.display="none",c.style.display="none",v=this.editorUi.toolbar.addButton("geSprite-justifyfull",null,function(){document.execCommand("justifyfull",!1,null)},g),this.styleButtons([v,T=this.editorUi.toolbar.addButton("geSprite-subscript",mxResources.get("subscript")+" ("+Editor.ctrlKey+"+,)",function(){document.execCommand("subscript",!1,null)},g),R=this.editorUi.toolbar.addButton("geSprite-superscript",mxResources.get("superscript")+" ("+Editor.ctrlKey+"+.)",function(){document.execCommand("superscript",!1,null)},g)]),v.style.marginRight="9px";var U=g.cloneNode(!1);U.style.paddingTop="4px";St=[this.editorUi.toolbar.addButton("geSprite-orderedlist",mxResources.get("numberedList"),function(){document.execCommand("insertorderedlist",!1,null)},U),this.editorUi.toolbar.addButton("geSprite-unorderedlist",mxResources.get("bulletedList"),function(){document.execCommand("insertunorderedlist",!1,null)},U),this.editorUi.toolbar.addButton("geSprite-outdent",mxResources.get("decreaseIndent"),function(){document.execCommand("outdent",!1,null)},U),this.editorUi.toolbar.addButton("geSprite-indent",mxResources.get("increaseIndent"),function(){document.execCommand("indent",!1,null)},U),this.editorUi.toolbar.addButton("geSprite-code",mxResources.get("html"),function(){i.cellEditor.toggleViewMode()},U)];this.styleButtons(St),St[St.length-1].style.marginLeft="9px",mxClient.IS_QUIRKS&&(mxUtils.br(t),U.style.height="40"),t.appendChild(U)}else p[2].style.marginRight="9px",y.style.marginRight="9px";var _=o.cloneNode(!1);_.style.marginLeft="0px",_.style.paddingTop="8px",_.style.paddingBottom="4px",_.style.fontWeight="normal",mxUtils.write(_,mxResources.get("position"));var N=document.createElement("select");N.style.position="absolute",N.style.right="20px",N.style.width="97px",N.style.marginTop="-2px";for(var O=["topLeft","top","topRight","left","center","right","bottomLeft","bottom","bottomRight"],w={topLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM],top:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM],topRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM],left:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE],center:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_MIDDLE],right:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_MIDDLE,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_MIDDLE],bottomLeft:[mxConstants.ALIGN_LEFT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_TOP],bottom:[mxConstants.ALIGN_CENTER,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_CENTER,mxConstants.ALIGN_TOP],bottomRight:[mxConstants.ALIGN_RIGHT,mxConstants.ALIGN_BOTTOM,mxConstants.ALIGN_LEFT,mxConstants.ALIGN_TOP]},F=0;F<O.length;F++){var Y=document.createElement("option");Y.setAttribute("value",O[F]),mxUtils.write(Y,mxResources.get(O[F])),N.appendChild(Y)}_.appendChild(N);var D=o.cloneNode(!1);D.style.marginLeft="0px",D.style.paddingTop="4px",D.style.paddingBottom="4px",D.style.fontWeight="normal",mxUtils.write(D,mxResources.get("writingDirection"));var B=document.createElement("select");B.style.position="absolute",B.style.right="20px",B.style.width="97px",B.style.marginTop="-2px";for(var P=["automatic","leftToRight","rightToLeft"],G={automatic:null,leftToRight:mxConstants.TEXT_DIRECTION_LTR,rightToLeft:mxConstants.TEXT_DIRECTION_RTL},F=0;F<P.length;F++){var H=document.createElement("option");H.setAttribute("value",P[F]),mxUtils.write(H,mxResources.get(P[F])),B.appendChild(H)}D.appendChild(B),i.isEditing()||(t.appendChild(_),mxEvent.addListener(N,"change",function(t){i.getModel().beginUpdate();try{var e=w[N.value];null!=e&&(i.setCellStyles(mxConstants.STYLE_LABEL_POSITION,e[0],i.getSelectionCells()),i.setCellStyles(mxConstants.STYLE_VERTICAL_LABEL_POSITION,e[1],i.getSelectionCells()),i.setCellStyles(mxConstants.STYLE_ALIGN,e[2],i.getSelectionCells()),i.setCellStyles(mxConstants.STYLE_VERTICAL_ALIGN,e[3],i.getSelectionCells()))}finally{i.getModel().endUpdate()}mxEvent.consume(t)}),t.appendChild(D),mxEvent.addListener(B,"change",function(t){i.setCellStyles(mxConstants.STYLE_TEXT_DIRECTION,G[B.value],i.getSelectionCells()),mxEvent.consume(t)}));var W=document.createElement("input");W.style.textAlign="right",W.style.marginTop="4px",mxClient.IS_QUIRKS||(W.style.position="absolute",W.style.right="32px"),W.style.width="46px",W.style.height=mxClient.IS_QUIRKS?"21px":"17px",m.appendChild(W);var M=null,k=this.installInputHandler(W,mxConstants.STYLE_FONTSIZE,Menus.prototype.defaultFontSize,1,999," pt",function(t){M=t,document.execCommand("fontSize",!1,"4");for(var e=i.cellEditor.textarea.getElementsByTagName("font"),n=0;n<e.length;n++)if("4"==e[n].getAttribute("size")){e[n].removeAttribute("size"),e[n].style.fontSize=M+"px",window.setTimeout(function(){W.value=M+" pt",M=null},0);break}},!0),V=this.createStepper(W,k,1,10,!0,Menus.prototype.defaultFontSize);V.style.display=W.style.display,V.style.marginTop="4px",mxClient.IS_QUIRKS||(V.style.right="20px"),m.appendChild(V);var K=u.getElementsByTagName("div")[0];K.style.cssFloat="right";var z=null,Q="#ffffff",Z=null,j="#000000",J=i.cellEditor.isContentEditing()?this.createColorOption(mxResources.get("backgroundColor"),function(){return Q},function(t){document.execCommand("backcolor",!1,t!=mxConstants.NONE?t:"transparent")},"#ffffff",{install:function(t){z=t},destroy:function(){z=null}},null,!0):this.createCellColorOption(mxResources.get("backgroundColor"),mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"#ffffff");J.style.fontWeight="bold";var X=this.createCellColorOption(mxResources.get("borderColor"),mxConstants.STYLE_LABEL_BORDERCOLOR,"#000000");X.style.fontWeight="bold";var q=i.cellEditor.isContentEditing()?this.createColorOption(mxResources.get("fontColor"),function(){return j},function(t){document.execCommand("forecolor",!1,t!=mxConstants.NONE?t:"transparent")},"#000000",{install:function(t){Z=t},destroy:function(){Z=null}},null,!0):this.createCellColorOption(mxResources.get("fontColor"),mxConstants.STYLE_FONTCOLOR,"#000000",function(t){null==t||t==mxConstants.NONE?J.style.display="none":J.style.display="",X.style.display=J.style.display},function(t){null==t||t==mxConstants.NONE?i.setCellStyles(mxConstants.STYLE_NOLABEL,"1",i.getSelectionCells()):i.setCellStyles(mxConstants.STYLE_NOLABEL,null,i.getSelectionCells())});q.style.fontWeight="bold",d.appendChild(q),d.appendChild(J),i.cellEditor.isContentEditing()||d.appendChild(X),t.appendChild(d);var $=this.createPanel();$.style.paddingTop="2px",$.style.paddingBottom="4px";var tt=this.createCellOption(mxResources.get("wordWrap"),mxConstants.STYLE_WHITE_SPACE,null,"wrap","null",null,null,!0);tt.style.fontWeight="bold",s.containsLabel||s.autoSize||0!=s.edges.length||$.appendChild(tt);var et=this.createCellOption(mxResources.get("formattedText"),"html","0",null,null,null,n.actions.get("formattedText"));et.style.fontWeight="bold",$.appendChild(et);var nt=this.createPanel();nt.style.paddingTop="10px",nt.style.paddingBottom="28px",nt.style.fontWeight="normal";var it=document.createElement("div");it.style.position="absolute",it.style.width="70px",it.style.marginTop="0px",it.style.fontWeight="bold",mxUtils.write(it,mxResources.get("spacing")),nt.appendChild(it);var st,lt,ot,at,rt,dt=this.addUnitInput(nt,"pt",91,44,function(){st.apply(this,arguments)}),ut=this.addUnitInput(nt,"pt",20,44,function(){lt.apply(this,arguments)});mxUtils.br(nt),this.addLabel(nt,mxResources.get("top"),91),this.addLabel(nt,mxResources.get("global"),20),mxUtils.br(nt),mxUtils.br(nt);var mt=this.addUnitInput(nt,"pt",162,44,function(){ot.apply(this,arguments)}),pt=this.addUnitInput(nt,"pt",91,44,function(){at.apply(this,arguments)}),ct=this.addUnitInput(nt,"pt",20,44,function(){rt.apply(this,arguments)});if(mxUtils.br(nt),this.addLabel(nt,mxResources.get("left"),162),this.addLabel(nt,mxResources.get("bottom"),91),this.addLabel(nt,mxResources.get("right"),20),i.cellEditor.isContentEditing()){var gt=null,ht=null;t.appendChild(this.createRelativeOption(mxResources.get("lineheight"),null,null,function(t){var e=""==t.value?120:parseInt(t.value);e=Math.max(0,isNaN(e)?120:e),null!=gt&&(i.cellEditor.restoreSelection(gt),gt=null);for(var n=i.getSelectedElement();null!=n&&n.nodeType!=mxConstants.NODETYPE_ELEMENT;)n=n.parentNode;null!=n&&n==i.cellEditor.textarea&&null!=i.cellEditor.textarea.firstChild&&("P"!=i.cellEditor.textarea.firstChild.nodeName&&(i.cellEditor.textarea.innerHTML="<p>"+i.cellEditor.textarea.innerHTML+"</p>"),n=i.cellEditor.textarea.firstChild),null!=n&&n!=i.cellEditor.textarea&&(n.style.lineHeight=e+"%"),t.value=e+" %"},function(t){ht=t,mxEvent.addListener(t,"mousedown",function(){gt=i.cellEditor.saveSelection()}),mxEvent.addListener(t,"touchstart",function(){gt=i.cellEditor.saveSelection()}),t.value="120 %"}));var xt=o.cloneNode(!1);xt.style.paddingLeft="0px";var yt=this.editorUi.toolbar.addItems(["link","image"],xt,!0),St=[this.editorUi.toolbar.addButton("geSprite-horizontalrule",mxResources.get("insertHorizontalRule"),function(){document.execCommand("inserthorizontalrule",!1,null)},xt),this.editorUi.toolbar.addMenuFunctionInContainer(xt,"geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.addInsertTableItem(t)}))];this.styleButtons(yt),this.styleButtons(St);var Ct=this.createPanel();Ct.style.paddingTop="10px",Ct.style.paddingBottom="10px",Ct.appendChild(this.createTitle(mxResources.get("insert"))),Ct.appendChild(xt),t.appendChild(Ct),mxClient.IS_QUIRKS&&(Ct.style.height="70");var Et=o.cloneNode(!1);Et.style.paddingLeft="0px";St=[this.editorUi.toolbar.addButton("geSprite-insertcolumnbefore",mxResources.get("insertColumnBefore"),function(){try{null!=A&&i.selectNode(i.insertColumn(A,null!=b?b.cellIndex:0))}catch(t){alert(t)}},Et),this.editorUi.toolbar.addButton("geSprite-insertcolumnafter",mxResources.get("insertColumnAfter"),function(){try{null!=A&&i.selectNode(i.insertColumn(A,null!=b?b.cellIndex+1:-1))}catch(t){alert(t)}},Et),this.editorUi.toolbar.addButton("geSprite-deletecolumn",mxResources.get("deleteColumn"),function(){try{null!=A&&null!=b&&i.deleteColumn(A,b.cellIndex)}catch(t){alert(t)}},Et),this.editorUi.toolbar.addButton("geSprite-insertrowbefore",mxResources.get("insertRowBefore"),function(){try{null!=A&&null!=I&&i.selectNode(i.insertRow(A,I.sectionRowIndex))}catch(t){alert(t)}},Et),this.editorUi.toolbar.addButton("geSprite-insertrowafter",mxResources.get("insertRowAfter"),function(){try{null!=A&&null!=I&&i.selectNode(i.insertRow(A,I.sectionRowIndex+1))}catch(t){alert(t)}},Et),this.editorUi.toolbar.addButton("geSprite-deleterow",mxResources.get("deleteRow"),function(){try{null!=A&&null!=I&&i.deleteRow(A,I.sectionRowIndex)}catch(t){alert(t)}},Et)];this.styleButtons(St),St[2].style.marginRight="9px";var ft=this.createPanel();ft.style.paddingTop="10px",ft.style.paddingBottom="10px",ft.appendChild(this.createTitle(mxResources.get("table"))),ft.appendChild(Et),mxClient.IS_QUIRKS&&(mxUtils.br(t),ft.style.height="70");var Tt=o.cloneNode(!1);Tt.style.paddingLeft="0px";St=[this.editorUi.toolbar.addButton("geSprite-strokecolor",mxResources.get("borderColor"),mxUtils.bind(this,function(){if(null!=A){var t=A.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)});this.editorUi.pickColor(t,function(t){null==t||t==mxConstants.NONE?(A.removeAttribute("border"),A.style.border="",A.style.borderCollapse=""):(A.setAttribute("border","1"),A.style.border="1px solid "+t,A.style.borderCollapse="collapse")})}}),Tt),this.editorUi.toolbar.addButton("geSprite-fillcolor",mxResources.get("backgroundColor"),mxUtils.bind(this,function(){if(null!=A){var t=A.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)});this.editorUi.pickColor(t,function(t){null==t||t==mxConstants.NONE?A.style.backgroundColor="":A.style.backgroundColor=t})}}),Tt),this.editorUi.toolbar.addButton("geSprite-fit",mxResources.get("spacing"),function(){if(null!=A){var t=A.getAttribute("cellPadding")||0,e=new FilenameDialog(n,t,mxResources.get("apply"),mxUtils.bind(this,function(t){null!=t&&t.length>0?A.setAttribute("cellPadding",t):A.removeAttribute("cellPadding")}),mxResources.get("spacing"));n.showDialog(e.container,300,80,!0,!0),e.init()}},Tt),this.editorUi.toolbar.addButton("geSprite-left",mxResources.get("left"),function(){null!=A&&A.setAttribute("align","left")},Tt),this.editorUi.toolbar.addButton("geSprite-center",mxResources.get("center"),function(){null!=A&&A.setAttribute("align","center")},Tt),this.editorUi.toolbar.addButton("geSprite-right",mxResources.get("right"),function(){null!=A&&A.setAttribute("align","right")},Tt)];this.styleButtons(St),St[2].style.marginRight="9px",mxClient.IS_QUIRKS&&(mxUtils.br(ft),mxUtils.br(ft)),ft.appendChild(Tt),t.appendChild(ft),L=ft}else t.appendChild($),t.appendChild(this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_TEXT_OPACITY)),t.appendChild(nt);var Rt=mxUtils.bind(this,function(t,n,i){s=this.format.getSelectionState();var l=mxUtils.getValue(s.style,mxConstants.STYLE_FONTSTYLE,0);if(e(p[0],(l&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD),e(p[1],(l&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC),e(p[2],(l&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE),u.firstChild.nodeValue=mxUtils.htmlEntities(mxUtils.getValue(s.style,mxConstants.STYLE_FONTFAMILY,Menus.prototype.defaultFont)),e(c,"0"==mxUtils.getValue(s.style,mxConstants.STYLE_HORIZONTAL,"1")),i||document.activeElement!=W){g=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_FONTSIZE,Menus.prototype.defaultFontSize));W.value=isNaN(g)?"":g+" pt"}var o=mxUtils.getValue(s.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_CENTER);e(h,o==mxConstants.ALIGN_LEFT),e(x,o==mxConstants.ALIGN_CENTER),e(y,o==mxConstants.ALIGN_RIGHT);var a=mxUtils.getValue(s.style,mxConstants.STYLE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);e(C,a==mxConstants.ALIGN_TOP),e(E,a==mxConstants.ALIGN_MIDDLE),e(f,a==mxConstants.ALIGN_BOTTOM);var r=mxUtils.getValue(s.style,mxConstants.STYLE_LABEL_POSITION,mxConstants.ALIGN_CENTER),d=mxUtils.getValue(s.style,mxConstants.STYLE_VERTICAL_LABEL_POSITION,mxConstants.ALIGN_MIDDLE);r==mxConstants.ALIGN_LEFT&&d==mxConstants.ALIGN_TOP?N.value="topLeft":r==mxConstants.ALIGN_CENTER&&d==mxConstants.ALIGN_TOP?N.value="top":r==mxConstants.ALIGN_RIGHT&&d==mxConstants.ALIGN_TOP?N.value="topRight":r==mxConstants.ALIGN_LEFT&&d==mxConstants.ALIGN_BOTTOM?N.value="bottomLeft":r==mxConstants.ALIGN_CENTER&&d==mxConstants.ALIGN_BOTTOM?N.value="bottom":r==mxConstants.ALIGN_RIGHT&&d==mxConstants.ALIGN_BOTTOM?N.value="bottomRight":r==mxConstants.ALIGN_LEFT?N.value="left":r==mxConstants.ALIGN_RIGHT?N.value="right":N.value="center";var m=mxUtils.getValue(s.style,mxConstants.STYLE_TEXT_DIRECTION,mxConstants.DEFAULT_TEXT_DIRECTION);if(m==mxConstants.TEXT_DIRECTION_RTL?B.value="rightToLeft":m==mxConstants.TEXT_DIRECTION_LTR?B.value="leftToRight":m==mxConstants.TEXT_DIRECTION_AUTO&&(B.value="automatic"),i||document.activeElement!=ut){g=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING,2));ut.value=isNaN(g)?"":g+" pt"}if(i||document.activeElement!=dt){g=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING_TOP,0));dt.value=isNaN(g)?"":g+" pt"}if(i||document.activeElement!=ct){g=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING_RIGHT,0));ct.value=isNaN(g)?"":g+" pt"}if(i||document.activeElement!=pt){g=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING_BOTTOM,0));pt.value=isNaN(g)?"":g+" pt"}if(i||document.activeElement!=mt){var g=parseFloat(mxUtils.getValue(s.style,mxConstants.STYLE_SPACING_LEFT,0));mt.value=isNaN(g)?"":g+" pt"}});if(lt=this.installInputHandler(ut,mxConstants.STYLE_SPACING,2,-999,999," pt"),st=this.installInputHandler(dt,mxConstants.STYLE_SPACING_TOP,0,-999,999," pt"),rt=this.installInputHandler(ct,mxConstants.STYLE_SPACING_RIGHT,0,-999,999," pt"),at=this.installInputHandler(pt,mxConstants.STYLE_SPACING_BOTTOM,0,-999,999," pt"),ot=this.installInputHandler(mt,mxConstants.STYLE_SPACING_LEFT,0,-999,999," pt"),this.addKeyHandler(W,Rt),this.addKeyHandler(ut,Rt),this.addKeyHandler(dt,Rt),this.addKeyHandler(ct,Rt),this.addKeyHandler(pt,Rt),this.addKeyHandler(mt,Rt),i.getModel().addListener(mxEvent.CHANGE,Rt),this.listeners.push({destroy:function(){i.getModel().removeListener(Rt)}}),Rt(),i.cellEditor.isContentEditing()){var vt=!1,Lt=function(){vt||(vt=!0,window.setTimeout(function(){for(var t=i.getSelectedElement();null!=t&&t.nodeType!=mxConstants.NODETYPE_ELEMENT;)t=t.parentNode;if(null!=t){t==i.cellEditor.textarea&&1==i.cellEditor.textarea.children.length&&i.cellEditor.textarea.firstChild.nodeType==mxConstants.NODETYPE_ELEMENT&&(t=i.cellEditor.textarea.firstChild);var n=mxUtils.getCurrentStyle(t);if(null!=n){if(e(p[0],"bold"==n.fontWeight||null!=i.getParentByName(t,"B",i.cellEditor.textarea)),e(p[1],"italic"==n.fontStyle||null!=i.getParentByName(t,"I",i.cellEditor.textarea)),e(p[2],null!=i.getParentByName(t,"U",i.cellEditor.textarea)),e(h,"left"==n.textAlign),e(x,"center"==n.textAlign),e(y,"right"==n.textAlign),e(v,"justify"==n.textAlign),e(R,null!=i.getParentByName(t,"SUP",i.cellEditor.textarea)),e(T,null!=i.getParentByName(t,"SUB",i.cellEditor.textarea)),A=i.getParentByName(t,"TABLE",i.cellEditor.textarea),I=null==A?null:i.getParentByName(t,"TR",A),b=null==A?null:i.getParentByName(t,"TD",A),L.style.display=null!=A?"":"none",document.activeElement!=W){"FONT"==t.nodeName&&"4"==t.getAttribute("size")&&null!=M?(t.removeAttribute("size"),t.style.fontSize=M+"px",M=null):W.value=parseFloat(n.fontSize)+" pt";var s=t.style.lineHeight||n.lineHeight,l=parseFloat(s);"px"==s.substring(s.length-2)&&(l/=parseFloat(n.fontSize)),"%"!=s.substring(s.length-1)&&(l*=100),ht.value=l+" %"}var o=n.color.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)}),a=n.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,function(t,e,n,i){return"#"+("0"+Number(e).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)});if(null!=Z&&(j="#"==o.charAt(0)?o:"#000000",Z(j,!0)),null!=z&&(Q="#"==a.charAt(0)?a:null,z(Q,!0)),null!=u.firstChild){var r=n.fontFamily;"'"==r.charAt(0)&&(r=r.substring(1)),"'"==r.charAt(r.length-1)&&(r=r.substring(0,r.length-1)),'"'==r.charAt(0)&&(r=r.substring(1)),'"'==r.charAt(r.length-1)&&(r=r.substring(0,r.length-1)),u.firstChild.nodeValue=r}}}vt=!1},0))};mxEvent.addListener(i.cellEditor.textarea,"input",Lt),mxEvent.addListener(i.cellEditor.textarea,"touchend",Lt),mxEvent.addListener(i.cellEditor.textarea,"mouseup",Lt),mxEvent.addListener(i.cellEditor.textarea,"keyup",Lt),this.listeners.push({destroy:function(){}}),Lt()}return t},StyleFormatPanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(StyleFormatPanel,BaseFormatPanel),StyleFormatPanel.prototype.init=function(){this.editorUi.editor.graph;var t=this.format.getSelectionState();t.containsImage&&"image"!=t.style.shape||this.container.appendChild(this.addFill(this.createPanel())),this.container.appendChild(this.addStroke(this.createPanel())),this.container.appendChild(this.addLineJumps(this.createPanel()));var e=this.createRelativeOption(mxResources.get("opacity"),mxConstants.STYLE_OPACITY,41);e.style.paddingTop="8px",e.style.paddingBottom="8px",this.container.appendChild(e),this.container.appendChild(this.addEffects(this.createPanel()));var n=this.addEditOps(this.createPanel());null!=n.firstChild&&mxUtils.br(n),this.container.appendChild(this.addStyleOps(n))},StyleFormatPanel.prototype.addEditOps=function(t){var e=this.format.getSelectionState(),n=null;if(1==this.editorUi.editor.graph.getSelectionCount()&&((n=mxUtils.button(mxResources.get("editStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editStyle").funct()}))).setAttribute("title",mxResources.get("editStyle")+" ("+this.editorUi.actions.get("editStyle").shortcut+")"),n.style.width="202px",n.style.marginBottom="2px",t.appendChild(n)),e.image){var i=mxUtils.button(mxResources.get("editImage"),mxUtils.bind(this,function(t){this.editorUi.actions.get("image").funct()}));i.setAttribute("title",mxResources.get("editImage")),i.style.marginBottom="2px",null==n?i.style.width="202px":(n.style.width="100px",i.style.width="100px",i.style.marginLeft="2px"),t.appendChild(i)}return t},StyleFormatPanel.prototype.addFill=function(t){var e=this.editorUi.editor.graph,n=this.format.getSelectionState();t.style.paddingTop="6px",t.style.paddingBottom="6px";var i=document.createElement("select");i.style.position="absolute",i.style.marginTop="-2px",i.style.right=mxClient.IS_QUIRKS?"52px":"72px",i.style.width="70px",mxEvent.addListener(i,"click",function(t){mxEvent.consume(t)});var s=this.createCellColorOption(mxResources.get("gradient"),mxConstants.STYLE_GRADIENTCOLOR,"#ffffff",function(t){null==t||t==mxConstants.NONE?i.style.display="none":i.style.display=""}),l="image"==n.style.shape?mxConstants.STYLE_IMAGE_BACKGROUND:mxConstants.STYLE_FILLCOLOR,o=this.createCellColorOption(mxResources.get("fill"),l,"#ffffff");o.style.fontWeight="bold";var a=mxUtils.getValue(n.style,l,null);s.style.display=null!=a&&a!=mxConstants.NONE&&n.fill&&"image"!=n.style.shape?"":"none";for(var r=[mxConstants.DIRECTION_NORTH,mxConstants.DIRECTION_EAST,mxConstants.DIRECTION_SOUTH,mxConstants.DIRECTION_WEST],d=0;d<r.length;d++){var u=document.createElement("option");u.setAttribute("value",r[d]),mxUtils.write(u,mxResources.get(r[d])),i.appendChild(u)}s.appendChild(i);var m=mxUtils.bind(this,function(){n=this.format.getSelectionState();var e=mxUtils.getValue(n.style,mxConstants.STYLE_GRADIENT_DIRECTION,mxConstants.DIRECTION_SOUTH);""==e&&(e=mxConstants.DIRECTION_SOUTH),i.value=e,t.style.display=n.fill?"":"none";var l=mxUtils.getValue(n.style,mxConstants.STYLE_FILLCOLOR,null);!n.fill||n.containsImage||null==l||l==mxConstants.NONE||"filledEdge"==n.style.shape?s.style.display="none":s.style.display=""});return e.getModel().addListener(mxEvent.CHANGE,m),this.listeners.push({destroy:function(){e.getModel().removeListener(m)}}),m(),mxEvent.addListener(i,"change",function(t){e.setCellStyles(mxConstants.STYLE_GRADIENT_DIRECTION,i.value,e.getSelectionCells()),mxEvent.consume(t)}),t.appendChild(o),t.appendChild(s),"swimlane"==n.style.shape&&t.appendChild(this.createCellColorOption(mxResources.get("laneColor"),"swimlaneFillColor","#ffffff")),t},StyleFormatPanel.prototype.addStroke=function(t){function e(t){var e=parseInt(E.value);(e=Math.min(999,Math.max(1,isNaN(e)?1:e)))!=mxUtils.getValue(l.style,mxConstants.STYLE_STROKEWIDTH,1)&&(s.setCellStyles(mxConstants.STYLE_STROKEWIDTH,e,s.getSelectionCells()),i.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[e],"cells",s.getSelectionCells()))),E.value=e+" pt",mxEvent.consume(t)}function n(t){var e=parseInt(f.value);(e=Math.min(999,Math.max(1,isNaN(e)?1:e)))!=mxUtils.getValue(l.style,mxConstants.STYLE_STROKEWIDTH,1)&&(s.setCellStyles(mxConstants.STYLE_STROKEWIDTH,e,s.getSelectionCells()),i.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_STROKEWIDTH],"values",[e],"cells",s.getSelectionCells()))),f.value=e+" pt",mxEvent.consume(t)}var i=this.editorUi,s=i.editor.graph,l=this.format.getSelectionState();t.style.paddingTop="4px",t.style.paddingBottom="4px",t.style.whiteSpace="normal";var o=document.createElement("div");o.style.fontWeight="bold";var a=document.createElement("select");a.style.position="absolute",a.style.marginTop="-2px",a.style.right="72px",a.style.width="80px";for(var r=["sharp","rounded","curved"],d=0;d<r.length;d++){var u=document.createElement("option");u.setAttribute("value",r[d]),mxUtils.write(u,mxResources.get(r[d])),a.appendChild(u)}mxEvent.addListener(a,"change",function(t){s.getModel().beginUpdate();try{var e=[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],n=["0",null];"rounded"==a.value?n=["1",null]:"curved"==a.value&&(n=[null,"1"]);for(var l=0;l<e.length;l++)s.setCellStyles(e[l],n[l],s.getSelectionCells());i.fireEvent(new mxEventObject("styleChanged","keys",e,"values",n,"cells",s.getSelectionCells()))}finally{s.getModel().endUpdate()}mxEvent.consume(t)}),mxEvent.addListener(a,"click",function(t){mxEvent.consume(t)});var m="image"==l.style.shape?mxConstants.STYLE_IMAGE_BORDER:mxConstants.STYLE_STROKECOLOR,p=this.createCellColorOption(mxResources.get("line"),m,"#000000");p.appendChild(a),o.appendChild(p);var c=o.cloneNode(!1);c.style.fontWeight="normal",c.style.whiteSpace="nowrap",c.style.position="relative",c.style.paddingLeft="16px",c.style.marginBottom="2px",c.style.marginTop="2px",c.className="geToolbarContainer";var g=mxUtils.bind(this,function(t,e,n,i,s){var l=this.editorUi.menus.styleChange(t,"",i,s,"geIcon",null),o=document.createElement("div");return o.style.width=e+"px",o.style.height="1px",o.style.borderBottom="1px "+n+" black",o.style.paddingTop="6px",l.firstChild.firstChild.style.padding="0px 4px 0px 4px",l.firstChild.firstChild.style.width=e+"px",l.firstChild.firstChild.appendChild(o),l}),h=this.editorUi.toolbar.addMenuFunctionInContainer(c,"geSprite-orthogonal",mxResources.get("pattern"),!1,mxUtils.bind(this,function(t){g(t,75,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid")),g(t,75,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed")),g(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)"),g(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)"),g(t,75,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")})),x=c.cloneNode(!1),y=this.editorUi.toolbar.addMenuFunctionInContainer(x,"geSprite-connection",mxResources.get("connection"),!1,mxUtils.bind(this,function(t){this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],[null,null,null,null],"geIcon geSprite geSprite-connection",null,!0).setAttribute("title",mxResources.get("line")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["link",null,null,null],"geIcon geSprite geSprite-linkedge",null,!0).setAttribute("title",mxResources.get("link")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["flexArrow",null,null,null],"geIcon geSprite geSprite-arrow",null,!0).setAttribute("title",mxResources.get("arrow")),this.editorUi.menus.styleChange(t,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["arrow",null,null,null],"geIcon geSprite geSprite-simplearrow",null,!0).setAttribute("title",mxResources.get("simpleArrow"))})),S=this.editorUi.toolbar.addMenuFunctionInContainer(x,"geSprite-orthogonal",mxResources.get("pattern"),!1,mxUtils.bind(this,function(t){g(t,33,"solid",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],[null,null]).setAttribute("title",mxResources.get("solid")),g(t,33,"dashed",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1",null]).setAttribute("title",mxResources.get("dashed")),g(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 1"]).setAttribute("title",mxResources.get("dotted")+" (1)"),g(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 2"]).setAttribute("title",mxResources.get("dotted")+" (2)"),g(t,33,"dotted",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],["1","1 4"]).setAttribute("title",mxResources.get("dotted")+" (3)")})),C=c.cloneNode(!1),E=document.createElement("input");E.style.textAlign="right",E.style.marginTop="2px",E.style.width="41px",E.setAttribute("title",mxResources.get("linewidth")),c.appendChild(E);var f=E.cloneNode(!0);x.appendChild(f);var T=this.createStepper(E,e,1,9);T.style.display=E.style.display,T.style.marginTop="2px",c.appendChild(T);var R=this.createStepper(f,n,1,9);R.style.display=f.style.display,R.style.marginTop="2px",x.appendChild(R),mxClient.IS_QUIRKS?(E.style.height="17px",f.style.height="17px"):(E.style.position="absolute",E.style.right="32px",E.style.height="15px",T.style.right="20px",f.style.position="absolute",f.style.right="32px",f.style.height="15px",R.style.right="20px"),mxEvent.addListener(E,"blur",e),mxEvent.addListener(E,"change",e),mxEvent.addListener(f,"blur",n),mxEvent.addListener(f,"change",n),mxClient.IS_QUIRKS&&(mxUtils.br(C),mxUtils.br(C));var v=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-orthogonal",mxResources.get("waypoints"),!1,mxUtils.bind(this,function(t){"arrow"!=l.style.shape&&(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,!0).setAttribute("title",mxResources.get("straight")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,!0).setAttribute("title",mxResources.get("orthogonal")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),"connector"==l.style.shape&&this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,!0).setAttribute("title",mxResources.get("curved")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,!0).setAttribute("title",mxResources.get("entityRelation")))})),L=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-startclassic",mxResources.get("linestart"),!1,mxUtils.bind(this,function(t){if("connector"==l.style.shape||"flexArrow"==l.style.shape){var e=this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.NONE,0],"geIcon",null,!1);e.setAttribute("title",mxResources.get("none")),e.firstChild.firstChild.innerHTML='<font style="font-size:10px;">'+mxUtils.htmlEntities(mxResources.get("none"))+"</font>","connector"==l.style.shape?(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-startclassic",null,!1).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,1],"geIcon geSprite geSprite-startclassicthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN,0],"geIcon geSprite geSprite-startopen",null,!1).setAttribute("title",mxResources.get("openArrow")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OPEN_THIN,0],"geIcon geSprite geSprite-startopenthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["openAsync",0],"geIcon geSprite geSprite-startopenasync",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-startblock",null,!1).setAttribute("title",mxResources.get("block")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,1],"geIcon geSprite geSprite-startblockthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",1],"geIcon geSprite geSprite-startasync",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-startoval",null,!1).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-startdiamond",null,!1).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-startthindiamond",null,!1).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-startclassictrans",null,!1).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_CLASSIC_THIN,0],"geIcon geSprite geSprite-startclassicthintrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-startblocktrans",null,!1).setAttribute("title",mxResources.get("block")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_BLOCK_THIN,0],"geIcon geSprite geSprite-startblockthintrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["async",0],"geIcon geSprite geSprite-startasynctrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-startovaltrans",null,!1).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-startdiamondtrans",null,!1).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-startthindiamondtrans",null,!1).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["dash",0],"geIcon geSprite geSprite-startdash",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["cross",0],"geIcon geSprite geSprite-startcross",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circlePlus",0],"geIcon geSprite geSprite-startcircleplus",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["circle",1],"geIcon geSprite geSprite-startcircle",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERone",0],"geIcon geSprite geSprite-starterone",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmandOne",0],"geIcon geSprite geSprite-starteronetoone",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERmany",0],"geIcon geSprite geSprite-startermany",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERoneToMany",0],"geIcon geSprite geSprite-starteronetomany",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToOne",1],"geIcon geSprite geSprite-starteroneopt",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW,"startFill"],["ERzeroToMany",1],"geIcon geSprite geSprite-startermanyopt",null,!1)):this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_STARTARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-startblocktrans",null,!1).setAttribute("title",mxResources.get("block"))}})),A=this.editorUi.toolbar.addMenuFunctionInContainer(C,"geSprite-endclassic",mxResources.get("lineend"),!1,mxUtils.bind(this,function(t){if("connector"==l.style.shape||"flexArrow"==l.style.shape){var e=this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.NONE,0],"geIcon",null,!1);e.setAttribute("title",mxResources.get("none")),e.firstChild.firstChild.innerHTML='<font style="font-size:10px;">'+mxUtils.htmlEntities(mxResources.get("none"))+"</font>","connector"==l.style.shape?(this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,1],"geIcon geSprite geSprite-endclassic",null,!1).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,1],"geIcon geSprite geSprite-endclassicthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN,0],"geIcon geSprite geSprite-endopen",null,!1).setAttribute("title",mxResources.get("openArrow")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OPEN_THIN,0],"geIcon geSprite geSprite-endopenthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["openAsync",0],"geIcon geSprite geSprite-endopenasync",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,1],"geIcon geSprite geSprite-endblock",null,!1).setAttribute("title",mxResources.get("block")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,1],"geIcon geSprite geSprite-endblockthin",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",1],"geIcon geSprite geSprite-endasync",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,1],"geIcon geSprite geSprite-endoval",null,!1).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,1],"geIcon geSprite geSprite-enddiamond",null,!1).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,1],"geIcon geSprite geSprite-endthindiamond",null,!1).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC,0],"geIcon geSprite geSprite-endclassictrans",null,!1).setAttribute("title",mxResources.get("classic")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_CLASSIC_THIN,0],"geIcon geSprite geSprite-endclassicthintrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK,0],"geIcon geSprite geSprite-endblocktrans",null,!1).setAttribute("title",mxResources.get("block")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_BLOCK_THIN,0],"geIcon geSprite geSprite-endblockthintrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["async",0],"geIcon geSprite geSprite-endasynctrans",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_OVAL,0],"geIcon geSprite geSprite-endovaltrans",null,!1).setAttribute("title",mxResources.get("oval")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND,0],"geIcon geSprite geSprite-enddiamondtrans",null,!1).setAttribute("title",mxResources.get("diamond")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],[mxConstants.ARROW_DIAMOND_THIN,0],"geIcon geSprite geSprite-endthindiamondtrans",null,!1).setAttribute("title",mxResources.get("diamondThin")),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["dash",0],"geIcon geSprite geSprite-enddash",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["cross",0],"geIcon geSprite geSprite-endcross",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circlePlus",0],"geIcon geSprite geSprite-endcircleplus",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["circle",1],"geIcon geSprite geSprite-endcircle",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERone",0],"geIcon geSprite geSprite-enderone",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmandOne",0],"geIcon geSprite geSprite-enderonetoone",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERmany",0],"geIcon geSprite geSprite-endermany",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERoneToMany",0],"geIcon geSprite geSprite-enderonetomany",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToOne",1],"geIcon geSprite geSprite-enderoneopt",null,!1),this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW,"endFill"],["ERzeroToMany",1],"geIcon geSprite geSprite-endermanyopt",null,!1)):this.editorUi.menus.edgeStyleChange(t,"",[mxConstants.STYLE_ENDARROW],[mxConstants.ARROW_BLOCK],"geIcon geSprite geSprite-endblocktrans",null,!1).setAttribute("title",mxResources.get("block"))}}));this.addArrow(y,8),this.addArrow(v),this.addArrow(L),this.addArrow(A);var b=this.addArrow(h,9);b.className="geIcon",b.style.width="84px";var I=this.addArrow(S,9);I.className="geIcon",I.style.width="22px";var U=document.createElement("div");U.style.width="85px",U.style.height="1px",U.style.borderBottom="1px solid black",U.style.marginBottom="9px",b.appendChild(U);var _=document.createElement("div");_.style.width="23px",_.style.height="1px",_.style.borderBottom="1px solid black",_.style.marginBottom="9px",I.appendChild(_),h.style.height="15px",S.style.height="15px",y.style.height="15px",v.style.height="17px",L.style.marginLeft="3px",L.style.height="17px",A.style.marginLeft="3px",A.style.height="17px",t.appendChild(o),t.appendChild(x),t.appendChild(c);var N=c.cloneNode(!1);N.style.paddingBottom="6px",N.style.paddingTop="4px",N.style.fontWeight="normal";var O=document.createElement("div");O.style.position="absolute",O.style.marginLeft="3px",O.style.marginBottom="12px",O.style.marginTop="2px",O.style.fontWeight="normal",O.style.width="76px",mxUtils.write(O,mxResources.get("lineend")),N.appendChild(O);var w,F,Y=this.addUnitInput(N,"pt",74,33,function(){w.apply(this,arguments)}),D=this.addUnitInput(N,"pt",20,33,function(){F.apply(this,arguments)});mxUtils.br(N);var B=document.createElement("div");B.style.height="8px",N.appendChild(B),O=O.cloneNode(!1),mxUtils.write(O,mxResources.get("linestart")),N.appendChild(O);var P,G,H=this.addUnitInput(N,"pt",74,33,function(){P.apply(this,arguments)}),W=this.addUnitInput(N,"pt",20,33,function(){G.apply(this,arguments)});mxUtils.br(N),this.addLabel(N,mxResources.get("spacing"),74,50),this.addLabel(N,mxResources.get("size"),20,50),mxUtils.br(N);var M=o.cloneNode(!1);M.style.fontWeight="normal",M.style.position="relative",M.style.paddingLeft="16px",M.style.marginBottom="2px",M.style.marginTop="6px",M.style.borderWidth="0px",M.style.paddingBottom="18px",(O=document.createElement("div")).style.position="absolute",O.style.marginLeft="3px",O.style.marginBottom="12px",O.style.marginTop="1px",O.style.fontWeight="normal",O.style.width="120px",mxUtils.write(O,mxResources.get("perimeter")),M.appendChild(O);var k,V=this.addUnitInput(M,"pt",20,41,function(){k.apply(this,arguments)});l.edges.length==s.getSelectionCount()?(t.appendChild(C),mxClient.IS_QUIRKS&&(mxUtils.br(t),mxUtils.br(t)),t.appendChild(N)):l.vertices.length==s.getSelectionCount()&&(mxClient.IS_QUIRKS&&mxUtils.br(t),t.appendChild(M));var K=mxUtils.bind(this,function(t,e,n){function o(t,e,n,s){var o=n.getElementsByTagName("div")[0];return o.className=i.getCssClassForMarker(s,l.style.shape,t,e),"geSprite geSprite-noarrow"==o.className&&(o.innerHTML=mxUtils.htmlEntities(mxResources.get("none")),o.style.backgroundImage="none",o.style.verticalAlign="top",o.style.marginTop="5px",o.style.fontSize="10px",o.nextSibling.style.marginTop="0px"),o}l=this.format.getSelectionState();mxUtils.getValue(l.style,m,null);if(n||document.activeElement!=E){h=parseInt(mxUtils.getValue(l.style,mxConstants.STYLE_STROKEWIDTH,1));E.value=isNaN(h)?"":h+" pt"}if(n||document.activeElement!=f){h=parseInt(mxUtils.getValue(l.style,mxConstants.STYLE_STROKEWIDTH,1));f.value=isNaN(h)?"":h+" pt"}a.style.visibility="connector"==l.style.shape||"filledEdge"==l.style.shape?"":"hidden","1"==mxUtils.getValue(l.style,mxConstants.STYLE_CURVED,null)?a.value="curved":"1"==mxUtils.getValue(l.style,mxConstants.STYLE_ROUNDED,null)&&(a.value="rounded"),"1"==mxUtils.getValue(l.style,mxConstants.STYLE_DASHED,null)?null==mxUtils.getValue(l.style,mxConstants.STYLE_DASH_PATTERN,null)?U.style.borderBottom="1px dashed black":U.style.borderBottom="1px dotted black":U.style.borderBottom="1px solid black",_.style.borderBottom=U.style.borderBottom;var r=v.getElementsByTagName("div")[0],d=mxUtils.getValue(l.style,mxConstants.STYLE_EDGE,null);"1"==mxUtils.getValue(l.style,mxConstants.STYLE_NOEDGESTYLE,null)&&(d=null),"orthogonalEdgeStyle"==d&&"1"==mxUtils.getValue(l.style,mxConstants.STYLE_CURVED,null)?r.className="geSprite geSprite-curved":r.className="straight"==d||"none"==d||null==d?"geSprite geSprite-straight":"entityRelationEdgeStyle"==d?"geSprite geSprite-entity":"elbowEdgeStyle"==d?"geSprite "+("vertical"==mxUtils.getValue(l.style,mxConstants.STYLE_ELBOW,null)?"geSprite-verticalelbow":"geSprite-horizontalelbow"):"isometricEdgeStyle"==d?"geSprite "+("vertical"==mxUtils.getValue(l.style,mxConstants.STYLE_ELBOW,null)?"geSprite-verticalisometric":"geSprite-horizontalisometric"):"geSprite geSprite-orthogonal";var u=y.getElementsByTagName("div")[0];"link"==l.style.shape?u.className="geSprite geSprite-linkedge":"flexArrow"==l.style.shape?u.className="geSprite geSprite-arrow":"arrow"==l.style.shape?u.className="geSprite geSprite-simplearrow":u.className="geSprite geSprite-connection",l.edges.length==s.getSelectionCount()?(x.style.display="",c.style.display="none"):(x.style.display="none",c.style.display="");var p=o(mxUtils.getValue(l.style,mxConstants.STYLE_STARTARROW,null),mxUtils.getValue(l.style,"startFill","1"),L,"start"),g=o(mxUtils.getValue(l.style,mxConstants.STYLE_ENDARROW,null),mxUtils.getValue(l.style,"endFill","1"),A,"end");if("arrow"==l.style.shape?(p.className="geSprite geSprite-noarrow",g.className="geSprite geSprite-endblocktrans"):"link"==l.style.shape&&(p.className="geSprite geSprite-noarrow",g.className="geSprite geSprite-noarrow"),mxUtils.setOpacity(v,"arrow"==l.style.shape?30:100),"connector"!=l.style.shape&&"flexArrow"!=l.style.shape?(mxUtils.setOpacity(L,30),mxUtils.setOpacity(A,30)):(mxUtils.setOpacity(L,100),mxUtils.setOpacity(A,100)),n||document.activeElement!=W){h=parseInt(mxUtils.getValue(l.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE));W.value=isNaN(h)?"":h+" pt"}if(n||document.activeElement!=H){h=parseInt(mxUtils.getValue(l.style,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0));H.value=isNaN(h)?"":h+" pt"}if(n||document.activeElement!=D){h=parseInt(mxUtils.getValue(l.style,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE));D.value=isNaN(h)?"":h+" pt"}if(n||document.activeElement!=H){h=parseInt(mxUtils.getValue(l.style,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0));Y.value=isNaN(h)?"":h+" pt"}if(n||document.activeElement!=V){var h=parseInt(mxUtils.getValue(l.style,mxConstants.STYLE_PERIMETER_SPACING,0));V.value=isNaN(h)?"":h+" pt"}});return G=this.installInputHandler(W,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt"),P=this.installInputHandler(H,mxConstants.STYLE_SOURCE_PERIMETER_SPACING,0,-999,999," pt"),F=this.installInputHandler(D,mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE,0,999," pt"),w=this.installInputHandler(Y,mxConstants.STYLE_TARGET_PERIMETER_SPACING,0,-999,999," pt"),k=this.installInputHandler(V,mxConstants.STYLE_PERIMETER_SPACING,0,0,999," pt"),this.addKeyHandler(E,K),this.addKeyHandler(W,K),this.addKeyHandler(H,K),this.addKeyHandler(D,K),this.addKeyHandler(Y,K),this.addKeyHandler(V,K),s.getModel().addListener(mxEvent.CHANGE,K),this.listeners.push({destroy:function(){s.getModel().removeListener(K)}}),K(),t},StyleFormatPanel.prototype.addLineJumps=function(t){var e=this.format.getSelectionState();if(Graph.lineJumpsEnabled&&e.edges.length>0&&0==e.vertices.length&&e.lineJumps){t.style.padding="8px 0px 24px 18px";var n=this.editorUi,i=n.editor.graph,s=document.createElement("div");s.style.position="absolute",s.style.fontWeight="bold",s.style.width="80px",mxUtils.write(s,mxResources.get("lineJumps")),t.appendChild(s);var l=document.createElement("select");l.style.position="absolute",l.style.marginTop="-2px",l.style.right="76px",l.style.width="62px";for(var o=["none","arc","gap","sharp"],a=0;a<o.length;a++){var r=document.createElement("option");r.setAttribute("value",o[a]),mxUtils.write(r,mxResources.get(o[a])),l.appendChild(r)}mxEvent.addListener(l,"change",function(t){i.getModel().beginUpdate();try{i.setCellStyles("jumpStyle",l.value,i.getSelectionCells()),n.fireEvent(new mxEventObject("styleChanged","keys",["jumpStyle"],"values",[l.value],"cells",i.getSelectionCells()))}finally{i.getModel().endUpdate()}mxEvent.consume(t)}),mxEvent.addListener(l,"click",function(t){mxEvent.consume(t)}),t.appendChild(l);var d,u=this.addUnitInput(t,"pt",22,33,function(){d.apply(this,arguments)});d=this.installInputHandler(u,"jumpSize",Graph.defaultJumpSize,0,999," pt");var m=mxUtils.bind(this,function(t,n,i){if(e=this.format.getSelectionState(),l.value=mxUtils.getValue(e.style,"jumpStyle","none"),i||document.activeElement!=u){var s=parseInt(mxUtils.getValue(e.style,"jumpSize",Graph.defaultJumpSize));u.value=isNaN(s)?"":s+" pt"}});this.addKeyHandler(u,m),i.getModel().addListener(mxEvent.CHANGE,m),this.listeners.push({destroy:function(){i.getModel().removeListener(m)}}),m()}else t.style.display="none";return t},StyleFormatPanel.prototype.addEffects=function(t){var e=this.editorUi.editor.graph,n=this.format.getSelectionState();t.style.paddingTop="0px",t.style.paddingBottom="2px";var i=document.createElement("table");mxClient.IS_QUIRKS&&(i.style.fontSize="1em"),i.style.width="100%",i.style.fontWeight="bold",i.style.paddingRight="20px";var s=document.createElement("tbody"),l=document.createElement("tr");l.style.padding="0px";var o=document.createElement("td");o.style.padding="0px",o.style.width="50%",o.setAttribute("valign","top");var a=o.cloneNode(!0);a.style.paddingLeft="8px",l.appendChild(o),l.appendChild(a),s.appendChild(l),i.appendChild(s),t.appendChild(i);var r=o,d=0,u=mxUtils.bind(this,function(t,e,n){var i=this.createCellOption(t,e,n);i.style.width="100%",r.appendChild(i),r=r==o?a:o,d++}),m=mxUtils.bind(this,function(e,i,s){n=this.format.getSelectionState(),o.innerHTML="",a.innerHTML="",r=o,n.rounded&&u(mxResources.get("rounded"),mxConstants.STYLE_ROUNDED,0),"swimlane"==n.style.shape&&u(mxResources.get("divider"),"swimlaneLine",1),n.containsImage||u(mxResources.get("shadow"),mxConstants.STYLE_SHADOW,0),n.glass&&u(mxResources.get("glass"),mxConstants.STYLE_GLASS,0),n.comic&&u(mxResources.get("comic"),"comic",0),0==d&&(t.style.display="none")});return e.getModel().addListener(mxEvent.CHANGE,m),this.listeners.push({destroy:function(){e.getModel().removeListener(m)}}),m(),t},StyleFormatPanel.prototype.addStyleOps=function(t){t.style.paddingTop="10px",t.style.paddingBottom="10px";var e=mxUtils.button(mxResources.get("setAsDefaultStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("setAsDefaultStyle").funct()}));return e.setAttribute("title",mxResources.get("setAsDefaultStyle")+" ("+this.editorUi.actions.get("setAsDefaultStyle").shortcut+")"),e.style.width="202px",t.appendChild(e),t},DiagramFormatPanel=function(t,e,n){BaseFormatPanel.call(this,t,e,n),this.init()},mxUtils.extend(DiagramFormatPanel,BaseFormatPanel),DiagramFormatPanel.prototype.showBackgroundImageOption=!0,DiagramFormatPanel.prototype.init=function(){var t=this.editorUi.editor.graph;this.container.appendChild(this.addView(this.createPanel())),t.isEnabled()&&(this.container.appendChild(this.addOptions(this.createPanel())),this.container.appendChild(this.addPaperSize(this.createPanel())),this.container.appendChild(this.addStyleOps(this.createPanel())))},DiagramFormatPanel.prototype.addView=function(t){var e=this.editorUi,n=e.editor.graph;if(t.appendChild(this.createTitle(mxResources.get("view"))),this.addGridOption(t),n.isEnabled()){t.appendChild(this.createOption(mxResources.get("guides"),function(){return n.graphHandler.guidesEnabled},function(t){e.actions.get("guides").funct()},{install:function(t){this.listener=function(){t(n.graphHandler.guidesEnabled)},e.addListener("guidesEnabledChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}})),t.appendChild(this.createOption(mxResources.get("pageView"),function(){return n.pageVisible},function(t){e.actions.get("pageView").funct()},{install:function(t){this.listener=function(){t(n.pageVisible)},e.addListener("pageViewChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}));var i=this.createColorOption(mxResources.get("background"),function(){return n.background},function(t){var i=new ChangePageSetup(e,t);i.ignoreImage=!0,n.model.execute(i)},"#ffffff",{install:function(t){this.listener=function(){t(n.background)},e.addListener("backgroundColorChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}});if(this.showBackgroundImageOption){var s=mxUtils.button(mxResources.get("image"),function(t){e.showBackgroundImageDialog(),mxEvent.consume(t)});s.style.position="absolute",s.className="geColorBtn",s.style.marginTop="-4px",s.style.paddingBottom=11==document.documentMode||mxClient.IS_MT?"0px":"2px",s.style.height="22px",s.style.right=mxClient.IS_QUIRKS?"52px":"72px",s.style.width="56px",i.appendChild(s)}t.appendChild(i)}return t},DiagramFormatPanel.prototype.addOptions=function(t){var e=this.editorUi,n=e.editor.graph;return t.appendChild(this.createTitle(mxResources.get("options"))),n.isEnabled()&&(t.appendChild(this.createOption(mxResources.get("connectionArrows"),function(){return n.connectionArrowsEnabled},function(t){e.actions.get("connectionArrows").funct()},{install:function(t){this.listener=function(){t(n.connectionArrowsEnabled)},e.addListener("connectionArrowsChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}})),t.appendChild(this.createOption(mxResources.get("connectionPoints"),function(){return n.connectionHandler.isEnabled()},function(t){e.actions.get("connectionPoints").funct()},{install:function(t){this.listener=function(){t(n.connectionHandler.isEnabled())},e.addListener("connectionPointsChanged",this.listener)},destroy:function(){e.removeListener(this.listener)}}))),t},DiagramFormatPanel.prototype.addGridOption=function(t){function e(t){var e=parseInt(s.value);(e=Math.max(1,isNaN(e)?10:e))!=i.getGridSize()&&i.setGridSize(e),s.value=e+" pt",mxEvent.consume(t)}var n=this.editorUi,i=n.editor.graph,s=document.createElement("input");s.style.position="absolute",s.style.textAlign="right",s.style.width="38px",s.value=i.getGridSize()+" pt";var l=this.createStepper(s,e);if(s.style.display=i.isGridEnabled()?"":"none",l.style.display=s.style.display,mxEvent.addListener(s,"keydown",function(t){13==t.keyCode?(i.container.focus(),mxEvent.consume(t)):27==t.keyCode&&(s.value=i.getGridSize(),i.container.focus(),mxEvent.consume(t))}),mxEvent.addListener(s,"blur",e),mxEvent.addListener(s,"change",e),mxClient.IS_SVG){s.style.marginTop="-2px",s.style.right="84px",l.style.marginTop="-16px",l.style.right="72px";var o=this.createColorOption(mxResources.get("grid"),function(){var t=i.view.gridColor;return i.isGridEnabled()?t:null},function(t){t==mxConstants.NONE?(i.setGridEnabled(!1),n.fireEvent(new mxEventObject("gridEnabledChanged"))):(i.setGridEnabled(!0),n.setGridColor(t)),s.style.display=i.isGridEnabled()?"":"none",l.style.display=s.style.display},"#e0e0e0",{install:function(t){this.listener=function(){t(i.isGridEnabled()?i.view.gridColor:null)},n.addListener("gridColorChanged",this.listener),n.addListener("gridEnabledChanged",this.listener)},destroy:function(){n.removeListener(this.listener)}});o.appendChild(s),o.appendChild(l),t.appendChild(o)}else s.style.marginTop="2px",s.style.right="32px",l.style.marginTop="2px",l.style.right="20px",t.appendChild(s),t.appendChild(l),t.appendChild(this.createOption(mxResources.get("grid"),function(){return i.isGridEnabled()},function(t){i.setGridEnabled(t),i.isGridEnabled()&&(i.view.gridColor="#e0e0e0"),n.fireEvent(new mxEventObject("gridEnabledChanged"))},{install:function(t){this.listener=function(){s.style.display=i.isGridEnabled()?"":"none",l.style.display=s.style.display,t(i.isGridEnabled())},n.addListener("gridEnabledChanged",this.listener)},destroy:function(){n.removeListener(this.listener)}}))},DiagramFormatPanel.prototype.addDocumentProperties=function(t){this.editorUi.editor.graph;return t.appendChild(this.createTitle(mxResources.get("options"))),t},DiagramFormatPanel.prototype.addPaperSize=function(t){var e=this.editorUi,n=e.editor.graph;t.appendChild(this.createTitle(mxResources.get("paperSize")));var i=PageSetupDialog.addPageFormatPanel(t,"formatpanel",n.pageFormat,function(t){if(null==n.pageFormat||n.pageFormat.width!=t.width||n.pageFormat.height!=t.height){var i=new ChangePageSetup(e,null,null,t);i.ignoreColor=!0,i.ignoreImage=!0,n.model.execute(i)}});this.addKeyHandler(i.widthInput,function(){i.set(n.pageFormat)}),this.addKeyHandler(i.heightInput,function(){i.set(n.pageFormat)});var s=function(){i.set(n.pageFormat)};return e.addListener("pageFormatChanged",s),this.listeners.push({destroy:function(){e.removeListener(s)}}),n.getModel().addListener(mxEvent.CHANGE,s),this.listeners.push({destroy:function(){n.getModel().removeListener(s)}}),t},DiagramFormatPanel.prototype.addStyleOps=function(t){var e=mxUtils.button(mxResources.get("editData"),mxUtils.bind(this,function(t){this.editorUi.actions.get("editData").funct()}));return e.setAttribute("title",mxResources.get("editData")+" ("+this.editorUi.actions.get("editData").shortcut+")"),e.style.width="202px",e.style.marginBottom="2px",t.appendChild(e),mxUtils.br(t),(e=mxUtils.button(mxResources.get("clearDefaultStyle"),mxUtils.bind(this,function(t){this.editorUi.actions.get("clearDefaultStyle").funct()}))).setAttribute("title",mxResources.get("clearDefaultStyle")+" ("+this.editorUi.actions.get("clearDefaultStyle").shortcut+")"),e.style.width="202px",t.appendChild(e),t},DiagramFormatPanel.prototype.destroy=function(){BaseFormatPanel.prototype.destroy.apply(this,arguments),this.gridEnabledListener&&(this.editorUi.removeListener(this.gridEnabledListener),this.gridEnabledListener=null)};
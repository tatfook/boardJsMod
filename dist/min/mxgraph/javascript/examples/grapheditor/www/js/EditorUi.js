/* 2017-11-22 */
function ChangePageSetup(t,e,i,n){this.ui=t,this.previousColor=e,this.previousImage=i,this.previousFormat=n,this.ignoreColor=!1,this.ignoreImage=!1}EditorUi=function(t,e,i){mxEventSource.call(this),this.destroyFunctions=[],this.editor=t||new Editor,this.container=e||document.body;var n=this.editor.graph;n.lightbox=i,mxClient.IS_SVG?mxPopupMenu.prototype.submenuImage="data:image/gif;base64,R0lGODlhCQAJAIAAAP///zMzMyH5BAEAAAAALAAAAAAJAAkAAAIPhI8WebHsHopSOVgb26AAADs=":(new Image).src=mxPopupMenu.prototype.submenuImage,mxClient.IS_SVG||null==mxConnectionHandler.prototype.connectImage||((new Image).src=mxConnectionHandler.prototype.connectImage.src),this.editor.chromeless&&(this.footerHeight=0,n.isEnabled=function(){return!1},n.panningHandler.isForcePanningEvent=function(t){return!mxEvent.isPopupTrigger(t.getEvent())}),this.actions=new Actions(this),this.menus=this.createMenus(),this.createDivs(),this.createUi(),this.refresh();var o=mxUtils.bind(this,function(t){return null==t&&(t=window.event),this.isSelectionAllowed(t)||n.isEditing()});this.container==document.body&&(this.menubarContainer.onselectstart=o,this.menubarContainer.onmousedown=o,this.toolbarContainer.onselectstart=o,this.toolbarContainer.onmousedown=o,this.diagramContainer.onselectstart=o,this.diagramContainer.onmousedown=o,this.sidebarContainer.onselectstart=o,this.sidebarContainer.onmousedown=o,this.formatContainer.onselectstart=o,this.formatContainer.onmousedown=o,this.footerContainer.onselectstart=o,this.footerContainer.onmousedown=o,null!=this.tabContainer&&(this.tabContainer.onselectstart=o)),this.editor.chromeless?n.panningHandler.usePopupTrigger=!1:mxClient.IS_IE&&(void 0===document.documentMode||document.documentMode<9)?mxEvent.addListener(this.diagramContainer,"contextmenu",o):this.diagramContainer.oncontextmenu=o,n.init(this.diagramContainer),this.hoverIcons=this.createHoverIcons(),mxEvent.addListener(this.diagramContainer,"mousemove",mxUtils.bind(this,function(t){var e=mxUtils.getOffset(this.diagramContainer);mxEvent.getClientX(t)-e.x-this.diagramContainer.clientWidth>0||mxEvent.getClientY(t)-e.y-this.diagramContainer.clientHeight>0?this.diagramContainer.setAttribute("title",mxResources.get("panTooltip")):this.diagramContainer.removeAttribute("title")}));var r=!1,s=this.hoverIcons.isResetEvent;this.hoverIcons.isResetEvent=function(t,e){return r||s.apply(this,arguments)},this.keydownHandler=mxUtils.bind(this,function(t){32==t.which?(r=!0,this.hoverIcons.reset(),n.container.style.cursor="move",n.isEditing()||mxEvent.getSource(t)!=n.container||mxEvent.consume(t)):mxEvent.isConsumed(t)||27!=t.keyCode||this.hideDialog()}),mxEvent.addListener(document,"keydown",this.keydownHandler),this.keyupHandler=mxUtils.bind(this,function(t){n.container.style.cursor="",r=!1}),mxEvent.addListener(document,"keyup",this.keyupHandler);var l=n.panningHandler.isForcePanningEvent;n.panningHandler.isForcePanningEvent=function(t){return l.apply(this,arguments)||r||mxEvent.isMouseEvent(t.getEvent())&&(this.usePopupTrigger||!mxEvent.isPopupTrigger(t.getEvent()))&&(!mxEvent.isControlDown(t.getEvent())&&mxEvent.isRightMouseButton(t.getEvent())||mxEvent.isMiddleMouseButton(t.getEvent()))};var a=n.cellEditor.isStopEditingEvent;n.cellEditor.isStopEditingEvent=function(t){return a.apply(this,arguments)||13==t.keyCode&&(!mxClient.IS_SF&&mxEvent.isControlDown(t)||mxClient.IS_MAC&&mxEvent.isMetaDown(t)||mxClient.IS_SF&&mxEvent.isShiftDown(t))};var d=!1,h=null,c=null,u=null,g=mxUtils.bind(this,function(){if(d!=n.cellEditor.isContentEditing()){for(var t=this.toolbar.container.firstChild,e=[];null!=t;){var i=t.nextSibling;mxUtils.indexOf(this.toolbar.staticElements,t)<0&&(t.parentNode.removeChild(t),e.push(t)),t=i}var o=this.toolbar.fontMenu,r=this.toolbar.sizeMenu;if(null==u)this.toolbar.createTextToolbar();else{for(var s=0;s<u.length;s++)this.toolbar.container.appendChild(u[s]);this.toolbar.fontMenu=h,this.toolbar.sizeMenu=c}d=n.cellEditor.isContentEditing(),h=o,c=r,u=e}}),m=this,p=n.cellEditor.startEditing;n.cellEditor.startEditing=function(){if(p.apply(this,arguments),g(),n.cellEditor.isContentEditing()){var t=!1,e=function(){t||(t=!0,window.setTimeout(function(){for(var e=n.getSelectedElement();null!=e&&e.nodeType!=mxConstants.NODETYPE_ELEMENT;)e=e.parentNode;if(null!=e){var i=mxUtils.getCurrentStyle(e);if(null!=i&&null!=m.toolbar){var o=i.fontFamily;"'"==o.charAt(0)&&(o=o.substring(1)),"'"==o.charAt(o.length-1)&&(o=o.substring(0,o.length-1)),m.toolbar.setFontName(o),m.toolbar.setFontSize(parseInt(i.fontSize))}}t=!1},0))};mxEvent.addListener(n.cellEditor.textarea,"input",e),mxEvent.addListener(n.cellEditor.textarea,"touchend",e),mxEvent.addListener(n.cellEditor.textarea,"mouseup",e),mxEvent.addListener(n.cellEditor.textarea,"keyup",e),e()}};var f=n.cellEditor.stopEditing;if(n.cellEditor.stopEditing=function(t,e){f.apply(this,arguments),g()},n.container.setAttribute("tabindex","0"),n.container.style.cursor="default",window.self===window.top&&null!=n.container.parentNode)try{n.container.focus()}catch(t){}var x=n.fireMouseEvent;n.fireMouseEvent=function(t,e,i){t==mxEvent.MOUSE_DOWN&&this.container.focus(),x.apply(this,arguments)},n.popupMenuHandler.autoExpand=!0,null!=this.menus&&(n.popupMenuHandler.factoryMethod=mxUtils.bind(this,function(t,e,i){this.menus.createPopupMenu(t,e,i)})),mxEvent.addGestureListeners(document,mxUtils.bind(this,function(t){n.popupMenuHandler.hideMenu()})),this.keyHandler=this.createKeyHandler(t),this.getKeyHandler=function(){return keyHandler};var v=["rounded","shadow","glass","dashed","dashPattern","comic","labelBackgroundColor"],y=["shape","edgeStyle","curved","rounded","elbow","comic","jumpStyle","jumpSize"];this.setDefaultStyle=function(t){var e=n.view.getState(t);if(null!=e){var i=t.clone();i.style="";var o=n.getCellStyle(i),r=[],s=[];for(var l in e.style)o[l]!=e.style[l]&&(r.push(e.style[l]),s.push(l));for(var a=n.getModel().getStyle(e.cell),d=null!=a?a.split(";"):[],h=0;h<d.length;h++){var c=d[h],u=c.indexOf("=");if(u>=0){var l=c.substring(0,u),g=c.substring(u+1);null!=o[l]&&"none"==g&&(r.push(g),s.push(l))}}n.getModel().isEdge(e.cell)?n.currentEdgeStyle={}:n.currentVertexStyle={},this.fireEvent(new mxEventObject("styleChanged","keys",s,"values",r,"cells",[e.cell]))}},this.clearDefaultStyle=function(){n.currentEdgeStyle=mxUtils.clone(n.defaultEdgeStyle),n.currentVertexStyle=mxUtils.clone(n.defaultVertexStyle),this.fireEvent(new mxEventObject("styleChanged","keys",[],"values",[],"cells",[]))};for(var E=["fontFamily","fontSize","fontColor"],b=["edgeStyle","startArrow","startFill","startSize","endArrow","endFill","endSize","jettySize","orthogonalLoop"],C=[["startArrow","startFill","startSize","endArrow","endFill","endSize","jettySize","orthogonalLoop"],["strokeColor","strokeWidth"],["fillColor","gradientColor"],E,["align"],["html"]],S=0;S<C.length;S++)for(var w=0;w<C[S].length;w++)v.push(C[S][w]);for(S=0;S<y.length;S++)mxUtils.indexOf(v,y[S])<0&&v.push(y[S]);var U=function(t,e){n.getModel().beginUpdate();try{if(e)for(var i=(S=n.getModel().isEdge(a))?n.currentEdgeStyle:n.currentVertexStyle,o=["fontSize","fontFamily","fontColor"],r=0;r<o.length;r++){var s=i[o[r]];null!=s&&n.setCellStyles(o[r],s,t)}else for(var l=0;l<t.length;l++){for(var a=t[l],d=n.getModel().getStyle(a),h=null!=d?d.split(";"):[],c=v.slice(),r=0;r<h.length;r++){var u=h[r],g=u.indexOf("=");if(g>=0){var m=u.substring(0,g),p=mxUtils.indexOf(c,m);p>=0&&c.splice(p,1);for(var f=0;f<C.length;f++){var x=C[f];if(mxUtils.indexOf(x,m)>=0)for(var E=0;E<x.length;E++){var b=mxUtils.indexOf(c,x[E]);b>=0&&c.splice(b,1)}}}}for(var S=n.getModel().isEdge(a),i=S?n.currentEdgeStyle:n.currentVertexStyle,r=0;r<c.length;r++){var w=i[m=c[r]];null==w||"shape"==m&&!S||(!S||mxUtils.indexOf(y,m)<0)&&n.setCellStyles(m,w,[a])}}}finally{n.getModel().endUpdate()}};if(n.addListener("cellsInserted",function(t,e){U(e.getProperty("cells"))}),n.addListener("textInserted",function(t,e){U(e.getProperty("cells"),!0)}),n.connectionHandler.addListener(mxEvent.CONNECT,function(t,e){var i=[e.getProperty("cell")];e.getProperty("terminalInserted")&&i.push(e.getProperty("terminal")),U(i)}),this.addListener("styleChanged",mxUtils.bind(this,function(t,e){var i=e.getProperty("cells"),o=!1,r=!1;if(i.length>0)for(a=0;a<i.length&&(o=n.getModel().isVertex(i[a])||o,!(r=n.getModel().isEdge(i[a])||r)||!o);a++);else o=!0,r=!0;for(var s=e.getProperty("keys"),l=e.getProperty("values"),a=0;a<s.length;a++){var d=mxUtils.indexOf(E,s[a])>=0;("strokeColor"!=s[a]||null!=l[a]&&"none"!=l[a])&&(mxUtils.indexOf(y,s[a])>=0?r||mxUtils.indexOf(b,s[a])>=0?null==l[a]?delete n.currentEdgeStyle[s[a]]:n.currentEdgeStyle[s[a]]=l[a]:o&&mxUtils.indexOf(v,s[a])>=0&&(null==l[a]?delete n.currentVertexStyle[s[a]]:n.currentVertexStyle[s[a]]=l[a]):mxUtils.indexOf(v,s[a])>=0&&((o||d)&&(null==l[a]?delete n.currentVertexStyle[s[a]]:n.currentVertexStyle[s[a]]=l[a]),(r||d||mxUtils.indexOf(b,s[a])>=0)&&(null==l[a]?delete n.currentEdgeStyle[s[a]]:n.currentEdgeStyle[s[a]]=l[a])))}if(null!=this.toolbar){if(this.toolbar.setFontName(n.currentVertexStyle.fontFamily||Menus.prototype.defaultFont),this.toolbar.setFontSize(n.currentVertexStyle.fontSize||Menus.prototype.defaultFontSize),null!=this.toolbar.edgeStyleMenu){var h=this.toolbar.edgeStyleMenu.getElementsByTagName("div")[0];"orthogonalEdgeStyle"==n.currentEdgeStyle.edgeStyle&&"1"==n.currentEdgeStyle.curved?h.className="geSprite geSprite-curved":"straight"==n.currentEdgeStyle.edgeStyle||"none"==n.currentEdgeStyle.edgeStyle||null==n.currentEdgeStyle.edgeStyle?h.className="geSprite geSprite-straight":"entityRelationEdgeStyle"==n.currentEdgeStyle.edgeStyle?h.className="geSprite geSprite-entity":"elbowEdgeStyle"==n.currentEdgeStyle.edgeStyle?h.className="geSprite geSprite-"+("vertical"==n.currentEdgeStyle.elbow?"verticalelbow":"horizontalelbow"):"isometricEdgeStyle"==n.currentEdgeStyle.edgeStyle?h.className="geSprite geSprite-"+("vertical"==n.currentEdgeStyle.elbow?"verticalisometric":"horizontalisometric"):h.className="geSprite geSprite-orthogonal"}if(null!=this.toolbar.edgeShapeMenu){var c=this.toolbar.edgeShapeMenu.getElementsByTagName("div")[0];"link"==n.currentEdgeStyle.shape?c.className="geSprite geSprite-linkedge":"flexArrow"==n.currentEdgeStyle.shape?c.className="geSprite geSprite-arrow":"arrow"==n.currentEdgeStyle.shape?c.className="geSprite geSprite-simplearrow":c.className="geSprite geSprite-connection"}null!=this.toolbar.lineStartMenu&&(this.toolbar.lineStartMenu.getElementsByTagName("div")[0].className=this.getCssClassForMarker("start",n.currentEdgeStyle.shape,n.currentEdgeStyle[mxConstants.STYLE_STARTARROW],mxUtils.getValue(n.currentEdgeStyle,"startFill","1"))),null!=this.toolbar.lineEndMenu&&(this.toolbar.lineEndMenu.getElementsByTagName("div")[0].className=this.getCssClassForMarker("end",n.currentEdgeStyle.shape,n.currentEdgeStyle[mxConstants.STYLE_ENDARROW],mxUtils.getValue(n.currentEdgeStyle,"endFill","1")))}})),null!=this.toolbar){var M=mxUtils.bind(this,function(){var t=n.currentVertexStyle.fontFamily||"Helvetica",e=String(n.currentVertexStyle.fontSize||"12"),i=n.getView().getState(n.getSelectionCell());null!=i&&(t=i.style[mxConstants.STYLE_FONTFAMILY]||t,e=i.style[mxConstants.STYLE_FONTSIZE]||e,t.length>10&&(t=t.substring(0,8)+"...")),this.toolbar.setFontName(t),this.toolbar.setFontSize(e)});n.getSelectionModel().addListener(mxEvent.CHANGE,M),n.getModel().addListener(mxEvent.CHANGE,M)}n.addListener(mxEvent.CELLS_ADDED,function(t,e){var i=e.getProperty("cells"),o=e.getProperty("parent");n.getModel().isLayer(o)&&!n.isCellVisible(o)&&null!=i&&i.length>0&&n.getModel().setVisible(o,!0)}),this.gestureHandler=mxUtils.bind(this,function(t){null!=this.currentMenu&&mxEvent.getSource(t)!=this.currentMenu.div&&this.hideCurrentMenu()}),mxEvent.addGestureListeners(document,this.gestureHandler),this.resizeHandler=mxUtils.bind(this,function(){window.setTimeout(mxUtils.bind(this,function(){this.refresh()}),0)}),mxEvent.addListener(window,"resize",this.resizeHandler),this.orientationChangeHandler=mxUtils.bind(this,function(){this.refresh()}),mxEvent.addListener(window,"orientationchange",this.orientationChangeHandler),mxClient.IS_IOS&&!window.navigator.standalone&&(this.scrollHandler=mxUtils.bind(this,function(){window.scrollTo(0,0)}),mxEvent.addListener(window,"scroll",this.scrollHandler)),this.editor.addListener("resetGraphView",mxUtils.bind(this,function(){this.resetScrollbars()})),this.addListener("gridEnabledChanged",mxUtils.bind(this,function(){n.view.validateBackground()})),this.addListener("backgroundColorChanged",mxUtils.bind(this,function(){n.view.validateBackground()})),n.addListener("gridSizeChanged",mxUtils.bind(this,function(){n.isGridEnabled()&&n.view.validateBackground()})),this.editor.resetGraph(),this.init(),this.open()},mxUtils.extend(EditorUi,mxEventSource),EditorUi.compactUi=!0,EditorUi.prototype.splitSize=mxClient.IS_TOUCH||mxClient.IS_POINTER?12:8,EditorUi.prototype.menubarHeight=30,EditorUi.prototype.formatEnabled=!0,EditorUi.prototype.formatWidth=240,EditorUi.prototype.toolbarHeight=34,EditorUi.prototype.footerHeight=28,EditorUi.prototype.sidebarFooterHeight=34,EditorUi.prototype.editButtonLink=null,EditorUi.prototype.hsplitPosition=screen.width<=640?118:208,EditorUi.prototype.allowAnimation=!0,EditorUi.prototype.init=function(){var t=this.editor.graph;mxEvent.addListener(t.container,"keydown",mxUtils.bind(this,function(t){this.onKeyDown(t)})),mxEvent.addListener(t.container,"keypress",mxUtils.bind(this,function(t){this.onKeyPress(t)})),this.addUndoListener(),this.addBeforeUnloadListener(),t.getSelectionModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.updateActionStates()})),t.getModel().addListener(mxEvent.CHANGE,mxUtils.bind(this,function(){this.updateActionStates()}));var e=t.setDefaultParent,i=this;this.editor.graph.setDefaultParent=function(){e.apply(this,arguments),i.updateActionStates()},t.editLink=i.actions.get("editLink").funct,this.updateActionStates(),this.initClipboard(),this.initCanvas(),null!=this.format&&this.format.init()},EditorUi.prototype.onKeyDown=function(t){var e=this.editor.graph;9==t.which&&e.isEnabled()&&!mxEvent.isAltDown(t)&&(e.isEditing()?e.stopEditing(!1):e.selectCell(!mxEvent.isShiftDown(t)),mxEvent.consume(t))},EditorUi.prototype.onKeyPress=function(t){var e=this.editor.graph;if(this.isImmediateEditingEvent(t)&&!e.isEditing()&&!e.isSelectionEmpty()&&0!==t.which&&!mxEvent.isAltDown(t)&&!mxEvent.isControlDown(t)&&!mxEvent.isMetaDown(t)&&(e.escape(),e.startEditing(),mxClient.IS_FF)){var i=e.cellEditor;i.textarea.innerHTML=String.fromCharCode(t.which);var n=document.createRange();n.selectNodeContents(i.textarea),n.collapse(!1);var o=window.getSelection();o.removeAllRanges(),o.addRange(n)}},EditorUi.prototype.isImmediateEditingEvent=function(t){return!0},EditorUi.prototype.getCssClassForMarker=function(t,e,i,n){return"flexArrow"==e?null!=i&&i!=mxConstants.NONE?"geSprite geSprite-"+t+"blocktrans":"geSprite geSprite-noarrow":i==mxConstants.ARROW_CLASSIC?"1"==n?"geSprite geSprite-"+t+"classic":"geSprite geSprite-"+t+"classictrans":i==mxConstants.ARROW_CLASSIC_THIN?"1"==n?"geSprite geSprite-"+t+"classicthin":"geSprite geSprite-"+t+"classicthintrans":i==mxConstants.ARROW_OPEN?"geSprite geSprite-"+t+"open":i==mxConstants.ARROW_OPEN_THIN?"geSprite geSprite-"+t+"openthin":i==mxConstants.ARROW_BLOCK?"1"==n?"geSprite geSprite-"+t+"block":"geSprite geSprite-"+t+"blocktrans":i==mxConstants.ARROW_BLOCK_THIN?"1"==n?"geSprite geSprite-"+t+"blockthin":"geSprite geSprite-"+t+"blockthintrans":i==mxConstants.ARROW_OVAL?"1"==n?"geSprite geSprite-"+t+"oval":"geSprite geSprite-"+t+"ovaltrans":i==mxConstants.ARROW_DIAMOND?"1"==n?"geSprite geSprite-"+t+"diamond":"geSprite geSprite-"+t+"diamondtrans":i==mxConstants.ARROW_DIAMOND_THIN?"1"==n?"geSprite geSprite-"+t+"thindiamond":"geSprite geSprite-"+t+"thindiamondtrans":"openAsync"==i?"geSprite geSprite-"+t+"openasync":"dash"==i?"geSprite geSprite-"+t+"dash":"cross"==i?"geSprite geSprite-"+t+"cross":"async"==i?"1"==n?"geSprite geSprite-"+t+"async":"geSprite geSprite-"+t+"asynctrans":"circle"==i||"circlePlus"==i?"1"==n||"circle"==i?"geSprite geSprite-"+t+"circle":"geSprite geSprite-"+t+"circleplus":"ERone"==i?"geSprite geSprite-"+t+"erone":"ERmandOne"==i?"geSprite geSprite-"+t+"eronetoone":"ERmany"==i?"geSprite geSprite-"+t+"ermany":"ERoneToMany"==i?"geSprite geSprite-"+t+"eronetomany":"ERzeroToOne"==i?"geSprite geSprite-"+t+"eroneopt":"ERzeroToMany"==i?"geSprite geSprite-"+t+"ermanyopt":"geSprite geSprite-noarrow"},EditorUi.prototype.createMenus=function(){return null},EditorUi.prototype.updatePasteActionStates=function(){var t=this.editor.graph,e=this.actions.get("paste"),i=this.actions.get("pasteHere");e.setEnabled(this.editor.graph.cellEditor.isContentEditing()||!mxClipboard.isEmpty()&&t.isEnabled()&&!t.isCellLocked(t.getDefaultParent())),i.setEnabled(e.isEnabled())},EditorUi.prototype.initClipboard=function(){var t=this,e=mxClipboard.cut;mxClipboard.cut=function(i){i.cellEditor.isContentEditing()?document.execCommand("cut",!1,null):e.apply(this,arguments),t.updatePasteActionStates()};var i=mxClipboard.copy;mxClipboard.copy=function(e){e.cellEditor.isContentEditing()?document.execCommand("copy",!1,null):i.apply(this,arguments),t.updatePasteActionStates()};var n=mxClipboard.paste;mxClipboard.paste=function(e){var i=null;return e.cellEditor.isContentEditing()?document.execCommand("paste",!1,null):i=n.apply(this,arguments),t.updatePasteActionStates(),i};var o=this.editor.graph.cellEditor.startEditing;this.editor.graph.cellEditor.startEditing=function(){o.apply(this,arguments),t.updatePasteActionStates()};var r=this.editor.graph.cellEditor.stopEditing;this.editor.graph.cellEditor.stopEditing=function(e,i){r.apply(this,arguments),t.updatePasteActionStates()},this.updatePasteActionStates()},EditorUi.prototype.initCanvas=function(){var t=this.editor.graph;(t=this.editor.graph).timerAutoScroll=!0,t.getPagePadding=function(){return new mxPoint(Math.max(0,Math.round((t.container.offsetWidth-34)/t.view.scale)),Math.max(0,Math.round((t.container.offsetHeight-34)/t.view.scale)))},t.view.getBackgroundPageBounds=function(){var t=this.graph.getPageLayout(),e=this.graph.getPageSize();return new mxRectangle(this.scale*(this.translate.x+t.x*e.width),this.scale*(this.translate.y+t.y*e.height),this.scale*t.width*e.width,this.scale*t.height*e.height)},t.getPreferredPageSize=function(t,e,i){var n=this.getPageLayout(),o=this.getPageSize();return new mxRectangle(0,0,n.width*o.width,n.height*o.height)};var e=null;if(this.editor.chromeless){e=mxUtils.bind(this,function(e,i){if(null!=t.container){var n=t.pageVisible?t.view.getBackgroundPageBounds():t.getGraphBounds(),o=t.view.translate,r=t.view.scale;(n=mxRectangle.fromRectangle(n)).x=n.x/r-o.x,n.y=n.y/r-o.y,n.width/=r,n.height/=r;var s=t.container.scrollTop,l=t.container.scrollLeft,a=mxClient.IS_QUIRKS||document.documentMode>=8?20:14;8!=document.documentMode&&9!=document.documentMode||(a+=3);var d=t.container.offsetWidth-a,h=t.container.offsetHeight-a,c=e?Math.max(.3,Math.min(i||1,d/n.width)):r,u=Math.max((d-c*n.width)/2,0)/c,g=Math.max((h-c*n.height)/4,0)/c;t.view.scaleAndTranslate(c,u-n.x,g-n.y),t.container.scrollTop=s*c/r,t.container.scrollLeft=l*c/r}}),this.chromelessResize=e;var i=mxUtils.bind(this,function(){e(!1)});mxEvent.addListener(window,"resize",i),this.destroyFunctions.push(function(){mxEvent.removeListener(window,"resize",i)}),this.editor.addListener("resetGraphView",mxUtils.bind(this,function(){e(!0)})),this.actions.get("zoomIn").funct=function(i){t.zoomIn(),e(!1)},this.actions.get("zoomOut").funct=function(i){t.zoomOut(),e(!1)},this.chromelessToolbar=document.createElement("div"),this.chromelessToolbar.style.position="fixed",this.chromelessToolbar.style.overflow="hidden",this.chromelessToolbar.style.boxSizing="border-box",this.chromelessToolbar.style.whiteSpace="nowrap",this.chromelessToolbar.style.backgroundColor="#000000",this.chromelessToolbar.style.padding="10px 10px 8px 10px",this.chromelessToolbar.style.left="50%",mxClient.IS_VML||(mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"borderRadius","20px"),mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"transition","opacity 600ms ease-in-out"));var n=mxUtils.bind(this,function(){var e=mxUtils.getCurrentStyle(t.container);this.chromelessToolbar.style.bottom=(null!=e?parseInt(e["margin-bottom"]||0):0)+(null!=this.tabContainer?20+parseInt(this.tabContainer.style.height):20)+"px"});this.editor.addListener("resetGraphView",n),n();var o=0,r=mxUtils.bind(this,function(t,e,i){o++;var n=document.createElement("span");n.style.paddingLeft="8px",n.style.paddingRight="8px",n.style.cursor="pointer",mxEvent.addListener(n,"click",t),null!=i&&n.setAttribute("title",i);var r=document.createElement("img");return r.setAttribute("border","0"),r.setAttribute("src",e),n.appendChild(r),this.chromelessToolbar.appendChild(n),n}),s=r(mxUtils.bind(this,function(t){this.actions.get("previousPage").funct(),mxEvent.consume(t)}),Editor.previousLargeImage,mxResources.get("previousPage")),l=document.createElement("div");l.style.display="inline-block",l.style.verticalAlign="top",l.style.fontFamily="Helvetica,Arial",l.style.marginTop="8px",l.style.color="#ffffff",this.chromelessToolbar.appendChild(l);var a=r(mxUtils.bind(this,function(t){this.actions.get("nextPage").funct(),mxEvent.consume(t)}),Editor.nextLargeImage,mxResources.get("nextPage")),d=mxUtils.bind(this,function(){null!=this.pages&&this.pages.length>1&&null!=this.currentPage&&(l.innerHTML="",mxUtils.write(l,mxUtils.indexOf(this.pages,this.currentPage)+1+" / "+this.pages.length))});s.style.paddingLeft="0px",s.style.paddingRight="4px",a.style.paddingLeft="4px",a.style.paddingRight="0px";var h=mxUtils.bind(this,function(){null!=this.pages&&this.pages.length>1&&null!=this.currentPage?(a.style.display="",s.style.display="",l.style.display="inline-block"):(a.style.display="none",s.style.display="none",l.style.display="none"),d()});this.editor.addListener("resetGraphView",h),this.editor.addListener("pageSelected",d),r(mxUtils.bind(this,function(t){this.actions.get("zoomOut").funct(),mxEvent.consume(t)}),Editor.zoomOutLargeImage,mxResources.get("zoomOut")+" (Alt+Mousewheel)"),r(mxUtils.bind(this,function(t){this.actions.get("zoomIn").funct(),mxEvent.consume(t)}),Editor.zoomInLargeImage,mxResources.get("zoomIn")+" (Alt+Mousewheel)"),r(mxUtils.bind(this,function(i){t.lightbox?(1==t.view.scale?this.lightboxFit():t.zoomTo(1),e(!1)):e(!0),mxEvent.consume(i)}),Editor.actualSizeLargeImage,mxResources.get("fit"));var c=null,u=null,g=mxUtils.bind(this,function(t){null!=c&&(window.clearTimeout(c),fadeThead=null),null!=u&&(window.clearTimeout(u),fadeThead2=null),c=window.setTimeout(mxUtils.bind(this,function(){mxUtils.setOpacity(this.chromelessToolbar,0),c=null,u=window.setTimeout(mxUtils.bind(this,function(){this.chromelessToolbar.style.display="none",u=null}),600)}),t||200)}),m=mxUtils.bind(this,function(t){null!=c&&(window.clearTimeout(c),fadeThead=null),null!=u&&(window.clearTimeout(u),fadeThead2=null),this.chromelessToolbar.style.display="",mxUtils.setOpacity(this.chromelessToolbar,t||30)});if("1"==urlParams.layers){this.layersDialog=null;var p=r(mxUtils.bind(this,function(e){if(null!=this.layersDialog)this.layersDialog.parentNode.removeChild(this.layersDialog),this.layersDialog=null;else{this.layersDialog=t.createLayersDialog(),mxEvent.addListener(this.layersDialog,"mouseleave",mxUtils.bind(this,function(){this.layersDialog.parentNode.removeChild(this.layersDialog),this.layersDialog=null}));var i=p.getBoundingClientRect();mxUtils.setPrefixedStyle(this.layersDialog.style,"borderRadius","5px"),this.layersDialog.style.position="fixed",this.layersDialog.style.fontFamily="Helvetica,Arial",this.layersDialog.style.backgroundColor="#000000",this.layersDialog.style.width="160px",this.layersDialog.style.padding="4px 2px 4px 2px",this.layersDialog.style.color="#ffffff",mxUtils.setOpacity(this.layersDialog,70),this.layersDialog.style.left=i.left+"px",this.layersDialog.style.bottom=parseInt(this.chromelessToolbar.style.bottom)+this.chromelessToolbar.offsetHeight+4+"px";var n=mxUtils.getCurrentStyle(this.editor.graph.container);this.layersDialog.style.zIndex=n.zIndex,document.body.appendChild(this.layersDialog)}mxEvent.consume(e)}),Editor.layersLargeImage,mxResources.get("layers")),f=t.getModel();f.addListener(mxEvent.CHANGE,function(){p.style.display=f.getChildCount(f.root)>1?"":"none"})}r(mxUtils.bind(this,function(t){this.actions.get("print").funct(),mxEvent.consume(t)}),Editor.printLargeImage,mxResources.get("print")),null!=this.editor.editButtonLink&&r(mxUtils.bind(this,function(t){"_blank"==this.editor.editButtonLink?this.editor.editAsNew(this.getEditBlankXml(),null,!0):window.open(this.editor.editButtonLink,"editWindow"),mxEvent.consume(t)}),Editor.editLargeImage,mxResources.get("openInNewWindow")),!t.lightbox||"1"!=urlParams.close&&this.container==document.body||r(mxUtils.bind(this,function(t){"1"==urlParams.close?window.close():(this.destroy(),mxEvent.consume(t))}),Editor.closeLargeImage,mxResources.get("close")+" (Escape)"),this.chromelessToolbar.style.display="none",mxUtils.setPrefixedStyle(this.chromelessToolbar.style,"transform","translate(-50%,0)"),t.container.appendChild(this.chromelessToolbar),this.addChromelessClickHandler(),mxEvent.addListener(t.container,mxClient.IS_POINTER?"pointermove":"mousemove",mxUtils.bind(this,function(t){mxEvent.isTouchEvent(t)||(mxEvent.isShiftDown(t)||m(30),g())})),mxEvent.addListener(this.chromelessToolbar,mxClient.IS_POINTER?"pointermove":"mousemove",function(t){mxEvent.consume(t)}),mxEvent.addListener(this.chromelessToolbar,"mouseenter",mxUtils.bind(this,function(t){mxEvent.isShiftDown(t)?g():m(100)})),mxEvent.addListener(this.chromelessToolbar,"mousemove",mxUtils.bind(this,function(t){mxEvent.isShiftDown(t)?g():m(100),mxEvent.consume(t)})),mxEvent.addListener(this.chromelessToolbar,"mouseleave",mxUtils.bind(this,function(t){mxEvent.isTouchEvent(t)||m(30)}));var x=t.getTolerance(),v=this;t.addMouseListener({startX:0,startY:0,scrollLeft:0,scrollTop:0,mouseDown:function(e,i){this.startX=i.getGraphX(),this.startY=i.getGraphY(),this.scrollLeft=t.container.scrollLeft,this.scrollTop=t.container.scrollTop},mouseMove:function(t,e){},mouseUp:function(e,i){mxEvent.isTouchEvent(i.getEvent())&&Math.abs(this.scrollLeft-t.container.scrollLeft)<x&&Math.abs(this.scrollTop-t.container.scrollTop)<x&&Math.abs(this.startX-i.getGraphX())<x&&Math.abs(this.startY-i.getGraphY())<x&&(parseFloat(v.chromelessToolbar.style.opacity||0)>0?g():m(30))}})}else if(this.editor.extendCanvas){var y=t.view.validate;t.view.validate=function(){if(null!=this.graph.container&&mxUtils.hasScrollbars(this.graph.container)){var t=this.graph.getPagePadding(),e=this.graph.getPageSize();this.translate.x,this.translate.y;this.translate.x=t.x-(this.x0||0)*e.width,this.translate.y=t.y-(this.y0||0)*e.height}y.apply(this,arguments)};var E=t.sizeDidChange;t.sizeDidChange=function(){if(null!=this.container&&mxUtils.hasScrollbars(this.container)){var e=this.getPageLayout(),i=this.getPagePadding(),n=this.getPageSize(),o=Math.ceil(2*i.x+e.width*n.width),r=Math.ceil(2*i.y+e.height*n.height),s=t.minimumGraphSize;null!=s&&s.width==o&&s.height==r||(t.minimumGraphSize=new mxRectangle(0,0,o,r));var l=i.x-e.x*n.width,a=i.y-e.y*n.height;if(!this.autoTranslate&&(this.view.translate.x!=l||this.view.translate.y!=a)){this.autoTranslate=!0,this.view.x0=e.x,this.view.y0=e.y;var d=t.view.translate.x,h=t.view.translate.y;return t.view.setTranslate(l,a),t.container.scrollLeft+=Math.round((l-d)*t.view.scale),t.container.scrollTop+=Math.round((a-h)*t.view.scale),void(this.autoTranslate=!1)}E.apply(this,arguments)}}}t.updateZoomTimeout=null,t.cumulativeZoomFactor=1;var b=null;t.lazyZoom=function(i){null!=this.updateZoomTimeout&&window.clearTimeout(this.updateZoomTimeout),i?this.view.scale*this.cumulativeZoomFactor<.15?this.cumulativeZoomFactor=(this.view.scale+.01)/this.view.scale:(this.cumulativeZoomFactor*=this.zoomFactor,this.cumulativeZoomFactor=Math.round(this.view.scale*this.cumulativeZoomFactor*20)/20/this.view.scale):this.view.scale*this.cumulativeZoomFactor<=.15?this.cumulativeZoomFactor=(this.view.scale-.01)/this.view.scale:(this.cumulativeZoomFactor/=this.zoomFactor,this.cumulativeZoomFactor=Math.round(this.view.scale*this.cumulativeZoomFactor*20)/20/this.view.scale),this.cumulativeZoomFactor=Math.max(.01,Math.min(this.view.scale*this.cumulativeZoomFactor,160)/this.view.scale),this.updateZoomTimeout=window.setTimeout(mxUtils.bind(this,function(){if(this.zoom(this.cumulativeZoomFactor),null!=e&&e(!1),null!=b&&mxUtils.hasScrollbars(t.container)){var i=mxUtils.getOffset(t.container),n=t.container.offsetWidth/2-b.x+i.x,o=t.container.offsetHeight/2-b.y+i.y;t.container.scrollLeft-=n*(this.cumulativeZoomFactor-1),t.container.scrollTop-=o*(this.cumulativeZoomFactor-1)}this.cumulativeZoomFactor=1,this.updateZoomTimeout=null}),20)},mxEvent.addMouseWheelListener(mxUtils.bind(this,function(e,i){if((mxEvent.isAltDown(e)||mxEvent.isControlDown(e)&&!mxClient.IS_MAC||t.panningHandler.isActive())&&(null==this.dialogs||0==this.dialogs.length))for(var n=mxEvent.getSource(e);null!=n;){if(n==t.container)return b=new mxPoint(mxEvent.getClientX(e),mxEvent.getClientY(e)),t.lazyZoom(i),void mxEvent.consume(e);n=n.parentNode}}))},EditorUi.prototype.createTemporaryGraph=function(t){var e=new Graph(document.createElement("div"),null,null,t);return e.resetViewOnRootChange=!1,e.setConnectable(!1),e.gridEnabled=!1,e.autoScroll=!1,e.setTooltips(!1),e.setEnabled(!1),e.container.style.visibility="hidden",e.container.style.position="absolute",e.container.style.overflow="hidden",e.container.style.height="1px",e.container.style.width="1px",e},EditorUi.prototype.addChromelessClickHandler=function(){var t=urlParams.highlight;null!=t&&t.length>0&&(t="#"+t),this.editor.graph.addClickHandler(t)},EditorUi.prototype.toggleFormatPanel=function(t){this.formatWidth=t||this.formatWidth>0?0:240,this.formatContainer.style.display=t||this.formatWidth>0?"":"none",this.refresh(),this.format.refresh(),this.fireEvent(new mxEventObject("formatWidthChanged"))},EditorUi.prototype.lightboxFit=function(){this.editor.graph.maxFitScale=2,this.editor.graph.fit(60),this.editor.graph.maxFitScale=null},EditorUi.prototype.isSelectionAllowed=function(t){return"SELECT"==mxEvent.getSource(t).nodeName||"INPUT"==mxEvent.getSource(t).nodeName&&mxUtils.isAncestorNode(this.formatContainer,mxEvent.getSource(t))},EditorUi.prototype.addBeforeUnloadListener=function(){window.onbeforeunload=mxUtils.bind(this,function(){if(!this.editor.chromeless)return this.onBeforeUnload()})},EditorUi.prototype.onBeforeUnload=function(){if(this.editor.modified)return mxResources.get("allChangesLost")},EditorUi.prototype.open=function(){try{null!=window.opener&&null!=window.opener.openFile&&window.opener.openFile.setConsumer(mxUtils.bind(this,function(t,e){try{var i=mxUtils.parseXml(t);return this.editor.setGraphXml(i.documentElement),this.editor.setModified(!1),this.editor.undoManager.clear(),void(null!=e&&(this.editor.setFilename(e),this.updateDocumentTitle()))}catch(t){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+t.message)}}))}catch(t){}this.editor.graph.view.validate(),this.editor.graph.sizeDidChange(),this.editor.fireEvent(new mxEventObject("resetGraphView"))},EditorUi.prototype.setCurrentMenu=function(t,e){this.currentMenuElt=e,this.currentMenu=t},EditorUi.prototype.resetCurrentMenu=function(){this.currentMenuElt=null,this.currentMenu=null},EditorUi.prototype.hideCurrentMenu=function(t,e){null!=this.currentMenu&&(this.currentMenu.hideMenu(),this.resetCurrentMenu())},EditorUi.prototype.updateDocumentTitle=function(){var t=this.editor.getOrCreateFilename();null!=this.editor.appName&&(t+=" - "+this.editor.appName),document.title=t},EditorUi.prototype.createHoverIcons=function(){return new HoverIcons(this.editor.graph)},EditorUi.prototype.redo=function(){try{this.editor.graph.isEditing()?document.execCommand("redo",!1,null):this.editor.undoManager.redo()}catch(t){}},EditorUi.prototype.undo=function(){try{var t=this.editor.graph;if(t.isEditing()){var e=t.cellEditor.textarea.innerHTML;document.execCommand("undo",!1,null),e==t.cellEditor.textarea.innerHTML&&(t.stopEditing(!0),this.editor.undoManager.undo())}else this.editor.undoManager.undo()}catch(t){}},EditorUi.prototype.canRedo=function(){return this.editor.graph.isEditing()||this.editor.undoManager.canRedo()},EditorUi.prototype.canUndo=function(){return this.editor.graph.isEditing()||this.editor.undoManager.canUndo()},EditorUi.prototype.getEditBlankXml=function(){return mxUtils.getXml(this.getGraphXml())},EditorUi.prototype.getUrl=function(t){var e=null!=t?t:window.location.pathname,i=e.indexOf("?")>0?1:0;for(var n in urlParams)e+=0==i?"?":"&",e+=n+"="+urlParams[n],i++;return e},EditorUi.prototype.setScrollbars=function(t){var e=this.editor.graph,i=e.container.style.overflow;if(e.scrollbars=t,this.editor.updateGraphComponents(),i!=e.container.style.overflow)if("hidden"==e.container.style.overflow){var n=e.view.translate;e.view.setTranslate(n.x-e.container.scrollLeft/e.view.scale,n.y-e.container.scrollTop/e.view.scale),e.container.scrollLeft=0,e.container.scrollTop=0,e.minimumGraphSize=null,e.sizeDidChange()}else{var o=e.view.translate.x,r=e.view.translate.y;e.view.translate.x=0,e.view.translate.y=0,e.sizeDidChange(),e.container.scrollLeft-=Math.round(o*e.view.scale),e.container.scrollTop-=Math.round(r*e.view.scale)}this.fireEvent(new mxEventObject("scrollbarsChanged"))},EditorUi.prototype.hasScrollbars=function(){return this.editor.graph.scrollbars},EditorUi.prototype.resetScrollbars=function(){var t=this.editor.graph;if(this.editor.extendCanvas){if(!this.editor.chromeless)if(mxUtils.hasScrollbars(t.container))if(t.pageVisible){var e=t.getPagePadding();t.container.scrollTop=Math.floor(e.y-this.editor.initialTopSpacing),t.container.scrollLeft=Math.floor(Math.min(e.x,(t.container.scrollWidth-t.container.clientWidth)/2)),(i=t.getGraphBounds()).width>0&&i.height>0&&(i.x>t.container.scrollLeft+.9*t.container.clientWidth&&(t.container.scrollLeft=Math.min(i.x+i.width-t.container.clientWidth,i.x-10)),i.y>t.container.scrollTop+.9*t.container.clientHeight&&(t.container.scrollTop=Math.min(i.y+i.height-t.container.clientHeight,i.y-10)))}else{var i=t.getGraphBounds(),n=Math.max(i.width,t.scrollTileSize.width*t.view.scale),o=Math.max(i.height,t.scrollTileSize.height*t.view.scale);t.container.scrollTop=Math.floor(Math.max(0,i.y-Math.max(20,(t.container.clientHeight-o)/4))),t.container.scrollLeft=Math.floor(Math.max(0,i.x-Math.max(0,(t.container.clientWidth-n)/2)))}else if(t.pageVisible){var r=t.view.getBackgroundPageBounds();t.view.setTranslate(Math.floor(Math.max(0,(t.container.clientWidth-r.width)/2)-r.x),Math.floor(Math.max(0,(t.container.clientHeight-r.height)/2)-r.y))}else{i=t.getGraphBounds();t.view.setTranslate(Math.floor(Math.max(0,Math.max(0,(t.container.clientWidth-i.width)/2)-i.x)),Math.floor(Math.max(0,Math.max(20,(t.container.clientHeight-i.height)/4))-i.y))}}else t.container.scrollTop=0,t.container.scrollLeft=0,mxUtils.hasScrollbars(t.container)||t.view.setTranslate(0,0)},EditorUi.prototype.setPageVisible=function(t){var e=this.editor.graph,i=mxUtils.hasScrollbars(e.container),n=0,o=0;if(i&&(n=e.view.translate.x*e.view.scale-e.container.scrollLeft,o=e.view.translate.y*e.view.scale-e.container.scrollTop),e.pageVisible=t,e.pageBreaksVisible=t,e.preferPageSize=t,e.view.validateBackground(),i){var r=e.getSelectionCells();e.clearSelection(),e.setSelectionCells(r)}e.sizeDidChange(),i&&(e.container.scrollLeft=e.view.translate.x*e.view.scale-n,e.container.scrollTop=e.view.translate.y*e.view.scale-o),this.fireEvent(new mxEventObject("pageViewChanged"))},ChangePageSetup.prototype.execute=function(){var t=this.ui.editor.graph;if(!this.ignoreColor){e=t.background;this.ui.setBackgroundColor(this.previousColor),this.previousColor=e}if(!this.ignoreImage){e=t.backgroundImage;this.ui.setBackgroundImage(this.previousImage),this.previousImage=e}if(null!=this.previousFormat){var e=t.pageFormat;this.previousFormat.width==e.width&&this.previousFormat.height==e.height||(this.ui.setPageFormat(this.previousFormat),this.previousFormat=e)}},EditorUi.prototype.setBackgroundColor=function(t){this.editor.graph.background=t,this.editor.graph.view.validateBackground(),this.fireEvent(new mxEventObject("backgroundColorChanged"))},EditorUi.prototype.setFoldingEnabled=function(t){this.editor.graph.foldingEnabled=t,this.editor.graph.view.revalidate(),this.fireEvent(new mxEventObject("foldingEnabledChanged"))},EditorUi.prototype.setPageFormat=function(t){this.editor.graph.pageFormat=t,this.editor.graph.pageVisible?(this.editor.graph.view.validateBackground(),this.editor.graph.sizeDidChange()):this.actions.get("pageView").funct(),this.fireEvent(new mxEventObject("pageFormatChanged"))},EditorUi.prototype.setPageScale=function(t){this.editor.graph.pageScale=t,this.editor.graph.pageVisible?(this.editor.graph.view.validateBackground(),this.editor.graph.sizeDidChange()):this.actions.get("pageView").funct(),this.fireEvent(new mxEventObject("pageScaleChanged"))},EditorUi.prototype.setGridColor=function(t){this.editor.graph.view.gridColor=t,this.editor.graph.view.validateBackground(),this.fireEvent(new mxEventObject("gridColorChanged"))},EditorUi.prototype.addUndoListener=function(){var t=this.actions.get("undo"),e=this.actions.get("redo"),i=this.editor.undoManager,n=mxUtils.bind(this,function(){t.setEnabled(this.canUndo()),e.setEnabled(this.canRedo())});i.addListener(mxEvent.ADD,n),i.addListener(mxEvent.UNDO,n),i.addListener(mxEvent.REDO,n),i.addListener(mxEvent.CLEAR,n);var o=this.editor.graph.cellEditor.startEditing;this.editor.graph.cellEditor.startEditing=function(){o.apply(this,arguments),n()};var r=this.editor.graph.cellEditor.stopEditing;this.editor.graph.cellEditor.stopEditing=function(t,e){r.apply(this,arguments),n()},n()},EditorUi.prototype.updateActionStates=function(){var t=this.editor.graph,e=!t.isSelectionEmpty(),i=!1,n=!1,o=t.getSelectionCells();if(null!=o)for(l=0;l<o.length;l++){var r=o[l];if(t.getModel().isEdge(r)&&(n=!0),t.getModel().isVertex(r)&&(i=!0),n&&i)break}for(var s=["cut","copy","bold","italic","underline","delete","duplicate","editStyle","editTooltip","editLink","backgroundColor","borderColor","edit","toFront","toBack","lockUnlock","solid","dashed","dotted","fillColor","gradientColor","shadow","fontColor","formattedText","rounded","toggleRounded","sharp","strokeColor"],l=0;l<s.length;l++)this.actions.get(s[l]).setEnabled(e);this.actions.get("setAsDefaultStyle").setEnabled(1==t.getSelectionCount()),this.actions.get("clearWaypoints").setEnabled(!t.isSelectionEmpty()),this.actions.get("turn").setEnabled(!t.isSelectionEmpty()),this.actions.get("curved").setEnabled(n),this.actions.get("rotation").setEnabled(i),this.actions.get("wordWrap").setEnabled(i),this.actions.get("autosize").setEnabled(i),this.actions.get("collapsible").setEnabled(i);var a=i&&1==t.getSelectionCount();this.actions.get("group").setEnabled(t.getSelectionCount()>1||a&&!t.isContainer(t.getSelectionCell())),this.actions.get("ungroup").setEnabled(1==t.getSelectionCount()&&(t.getModel().getChildCount(t.getSelectionCell())>0||a&&t.isContainer(t.getSelectionCell()))),this.actions.get("removeFromGroup").setEnabled(a&&t.getModel().isVertex(t.getModel().getParent(t.getSelectionCell())));t.view.getState(t.getSelectionCell());this.menus.get("navigation").setEnabled(e||null!=t.view.currentRoot),this.actions.get("collapsible").setEnabled(i&&1==t.getSelectionCount()&&(t.isContainer(t.getSelectionCell())||t.model.getChildCount(t.getSelectionCell())>0)),this.actions.get("home").setEnabled(null!=t.view.currentRoot),this.actions.get("exitGroup").setEnabled(null!=t.view.currentRoot),this.actions.get("enterGroup").setEnabled(1==t.getSelectionCount()&&t.isValidRoot(t.getSelectionCell()));var d=1==t.getSelectionCount()&&t.isCellFoldable(t.getSelectionCell());this.actions.get("expand").setEnabled(d),this.actions.get("collapse").setEnabled(d),this.actions.get("editLink").setEnabled(1==t.getSelectionCount()),this.actions.get("openLink").setEnabled(1==t.getSelectionCount()&&null!=t.getLinkForCell(t.getSelectionCell())),this.actions.get("guides").setEnabled(t.isEnabled()),this.actions.get("grid").setEnabled(!this.editor.chromeless);var h=t.isEnabled()&&!t.isCellLocked(t.getDefaultParent());this.menus.get("layout").setEnabled(h),this.menus.get("insert").setEnabled(h),this.menus.get("direction").setEnabled(h&&i),this.menus.get("align").setEnabled(h&&i&&t.getSelectionCount()>1),this.menus.get("distribute").setEnabled(h&&i&&t.getSelectionCount()>1),this.actions.get("selectVertices").setEnabled(h),this.actions.get("selectEdges").setEnabled(h),this.actions.get("selectAll").setEnabled(h),this.actions.get("selectNone").setEnabled(h),this.updatePasteActionStates()},EditorUi.prototype.refresh=function(t){t=null==t||t;var e=mxClient.IS_IE&&(null==document.documentMode||5==document.documentMode),i=this.container.clientWidth,n=this.container.clientHeight;this.container==document.body&&(i=document.body.clientWidth||document.documentElement.clientWidth,n=e?document.body.clientHeight||document.documentElement.clientHeight:document.documentElement.clientHeight);var o=0;mxClient.IS_IOS&&!window.navigator.standalone&&window.innerHeight!=document.documentElement.clientHeight&&(o=document.documentElement.clientHeight-window.innerHeight,window.scrollTo(0,0));var r=Math.max(0,Math.min(this.hsplitPosition,i-this.splitSize-20)),s=0;null!=this.menubar&&(this.menubarContainer.style.height=this.menubarHeight+"px",s+=this.menubarHeight),null!=this.toolbar&&(this.toolbarContainer.style.top=this.menubarHeight+"px",this.toolbarContainer.style.height=this.toolbarHeight+"px",s+=this.toolbarHeight),s>0&&!mxClient.IS_QUIRKS&&(s+=1);var l=0;if(null!=this.sidebarFooterContainer){var a=this.footerHeight+o;l=Math.max(0,Math.min(n-s-a,this.sidebarFooterHeight)),this.sidebarFooterContainer.style.width=r+"px",this.sidebarFooterContainer.style.height=l+"px",this.sidebarFooterContainer.style.bottom=a+"px"}var d=null!=this.format?this.formatWidth:0;if(this.sidebarContainer.style.top=s+"px",this.sidebarContainer.style.width=r+"px",this.formatContainer.style.top=s+"px",this.formatContainer.style.width=d+"px",this.formatContainer.style.display=null!=this.format?"":"none",this.diagramContainer.style.left=null!=this.hsplit.parentNode?r+this.splitSize+"px":"0px",this.diagramContainer.style.top=this.sidebarContainer.style.top,this.footerContainer.style.height=this.footerHeight+"px",this.hsplit.style.top=this.sidebarContainer.style.top,this.hsplit.style.bottom=this.footerHeight+o+"px",this.hsplit.style.left=r+"px",null!=this.tabContainer&&(this.tabContainer.style.left=this.diagramContainer.style.left),e){this.menubarContainer.style.width=i+"px",this.toolbarContainer.style.width=this.menubarContainer.style.width;var h=Math.max(0,n-this.footerHeight-this.menubarHeight-this.toolbarHeight);this.sidebarContainer.style.height=h-l+"px",this.formatContainer.style.height=h+"px",this.diagramContainer.style.width=null!=this.hsplit.parentNode?Math.max(0,i-r-this.splitSize-d)+"px":i+"px",this.footerContainer.style.width=this.menubarContainer.style.width;var c=Math.max(0,n-this.footerHeight-this.menubarHeight-this.toolbarHeight);null!=this.tabContainer&&(this.tabContainer.style.width=this.diagramContainer.style.width,this.tabContainer.style.bottom=this.footerHeight+o+"px",c-=this.tabContainer.clientHeight),this.diagramContainer.style.height=c+"px",this.hsplit.style.height=c+"px"}else{this.footerHeight>0&&(this.footerContainer.style.bottom=o+"px"),this.diagramContainer.style.right=d+"px";var u=0;null!=this.tabContainer&&(this.tabContainer.style.bottom=this.footerHeight+o+"px",this.tabContainer.style.right=this.diagramContainer.style.right,u=this.tabContainer.clientHeight),this.sidebarContainer.style.bottom=this.footerHeight+l+o+"px",this.formatContainer.style.bottom=this.footerHeight+o+"px",this.diagramContainer.style.bottom=this.footerHeight+o+u+"px"}t&&this.editor.graph.sizeDidChange()},EditorUi.prototype.createTabContainer=function(){return null},EditorUi.prototype.createDivs=function(){this.menubarContainer=this.createDiv("geMenubarContainer"),this.toolbarContainer=this.createDiv("geToolbarContainer"),this.sidebarContainer=this.createDiv("geSidebarContainer"),this.formatContainer=this.createDiv("geSidebarContainer"),this.diagramContainer=this.createDiv("geDiagramContainer"),this.footerContainer=this.createDiv("geFooterContainer"),this.hsplit=this.createDiv("geHsplit"),this.hsplit.setAttribute("title",mxResources.get("collapseExpand")),this.menubarContainer.style.top="0px",this.menubarContainer.style.left="0px",this.menubarContainer.style.right="0px",this.toolbarContainer.style.left="0px",this.toolbarContainer.style.right="0px",this.sidebarContainer.style.left="0px",this.formatContainer.style.right="0px",this.formatContainer.style.zIndex="1",this.diagramContainer.style.right=(null!=this.format?this.formatWidth:0)+"px",this.footerContainer.style.left="0px",this.footerContainer.style.right="0px",this.footerContainer.style.bottom="0px",this.footerContainer.style.zIndex=mxPopupMenu.prototype.zIndex-2,this.hsplit.style.width=this.splitSize+"px",this.formatContainer.style.backgroundColor="whiteSmoke",this.formatContainer.style.overflowX="hidden",this.formatContainer.style.overflowY="auto",this.formatContainer.style.fontSize="12px",this.sidebarFooterContainer=this.createSidebarFooterContainer(),this.sidebarFooterContainer&&(this.sidebarFooterContainer.style.left="0px"),this.editor.chromeless||(this.tabContainer=this.createTabContainer())},EditorUi.prototype.createSidebarFooterContainer=function(){return null},EditorUi.prototype.createUi=function(){this.menubar=this.editor.chromeless?null:this.menus.createMenubar(this.createDiv("geMenubar")),null!=this.menubar&&this.menubarContainer.appendChild(this.menubar.container),null!=this.menubar&&(this.statusContainer=this.createStatusContainer(),this.editor.addListener("statusChanged",mxUtils.bind(this,function(){this.setStatusText(this.editor.getStatus())})),this.setStatusText(this.editor.getStatus()),this.menubar.container.appendChild(this.statusContainer),this.container.appendChild(this.menubarContainer)),this.sidebar=this.editor.chromeless?null:this.createSidebar(this.sidebarContainer),null!=this.sidebar&&this.container.appendChild(this.sidebarContainer),this.format=this.editor.chromeless||!this.formatEnabled?null:this.createFormat(this.formatContainer),null!=this.format&&this.container.appendChild(this.formatContainer);var t=this.editor.chromeless?null:this.createFooter();null!=t&&(this.footerContainer.appendChild(t),this.container.appendChild(this.footerContainer)),null!=this.sidebar&&this.sidebarFooterContainer&&this.container.appendChild(this.sidebarFooterContainer),this.container.appendChild(this.diagramContainer),null!=this.container&&null!=this.tabContainer&&this.container.appendChild(this.tabContainer),this.toolbar=this.editor.chromeless?null:this.createToolbar(this.createDiv("geToolbar")),null!=this.toolbar&&(this.toolbarContainer.appendChild(this.toolbar.container),this.container.appendChild(this.toolbarContainer)),null!=this.sidebar&&(this.container.appendChild(this.hsplit),this.addSplitHandler(this.hsplit,!0,0,mxUtils.bind(this,function(t){this.hsplitPosition=t,this.refresh()})))},EditorUi.prototype.createStatusContainer=function(){var t=document.createElement("a");return t.className="geItem geStatus",screen.width<420&&(t.style.maxWidth=Math.max(20,screen.width-320)+"px",t.style.overflow="hidden"),t},EditorUi.prototype.setStatusText=function(t){this.statusContainer.innerHTML=t},EditorUi.prototype.createToolbar=function(t){return new Toolbar(this,t)},EditorUi.prototype.createSidebar=function(t){return new Sidebar(this,t)},EditorUi.prototype.createFormat=function(t){return new Format(this,t)},EditorUi.prototype.createFooter=function(){return this.createDiv("geFooter")},EditorUi.prototype.createDiv=function(t){var e=document.createElement("div");return e.className=t,e},EditorUi.prototype.addSplitHandler=function(t,e,i,n){function o(t){if(null!=s){var o=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t));n(Math.max(0,l+(e?o.x-s.x:s.y-o.y)-i)),mxEvent.consume(t),l!=h()&&(a=!0,d=null)}}function r(t){o(t),l=null,s=null}var s=null,l=null,a=!0,d=null;mxClient.IS_POINTER&&(t.style.touchAction="none");var h=mxUtils.bind(this,function(){var n=parseInt(e?t.style.left:t.style.bottom);return e||(n=n+i-this.footerHeight),n});mxEvent.addGestureListeners(t,function(t){s=new mxPoint(mxEvent.getClientX(t),mxEvent.getClientY(t)),l=h(),a=!1,mxEvent.consume(t)}),mxEvent.addListener(t,"click",function(t){if(!a){var e=null!=d?d-i:0;d=h(),n(e),mxEvent.consume(t)}}),mxEvent.addGestureListeners(document,null,o,r),this.destroyFunctions.push(function(){mxEvent.removeGestureListeners(document,null,o,r)})},EditorUi.prototype.showDialog=function(t,e,i,n,o,r){this.editor.graph.tooltipHandler.hideTooltip(),null==this.dialogs&&(this.dialogs=[]),this.dialog=new Dialog(this,t,e,i,n,o,r),this.dialogs.push(this.dialog)},EditorUi.prototype.hideDialog=function(t){null!=this.dialogs&&this.dialogs.length>0&&(this.dialogs.pop().close(t),this.dialog=this.dialogs.length>0?this.dialogs[this.dialogs.length-1]:null,null==this.dialog&&"hidden"!=this.editor.graph.container.style.visibility&&this.editor.graph.container.focus(),this.editor.fireEvent(new mxEventObject("hideDialog")))},EditorUi.prototype.pickColor=function(t,e){var i=this.editor.graph,n=i.cellEditor.saveSelection(),o=new ColorDialog(this,t||"none",function(t){i.cellEditor.restoreSelection(n),e(t)},function(){i.cellEditor.restoreSelection(n)});this.showDialog(o.container,220,430,!0,!1),o.init()},EditorUi.prototype.openFile=function(){window.openFile=new OpenFile(mxUtils.bind(this,function(t){this.hideDialog(t)})),this.showDialog(new OpenDialog(this).container,Editor.useLocalStorage?640:320,Editor.useLocalStorage?480:220,!0,!0,function(){window.openFile=null})},EditorUi.prototype.extractGraphModelFromHtml=function(t){var e=null;try{var i=t.indexOf("&lt;mxGraphModel ");if(i>=0){var n=t.lastIndexOf("&lt;/mxGraphModel&gt;");n>i&&(e=t.substring(i,n+21).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/\\&quot;/g,'"').replace(/\n/g,""))}}catch(t){}return e},EditorUi.prototype.extractGraphModelFromEvent=function(t){var e=null,i=null;if(null!=t){var n=null!=t.dataTransfer?t.dataTransfer:t.clipboardData;if(null!=n&&(10==document.documentMode||11==document.documentMode?i=n.getData("Text"):(i=mxUtils.indexOf(n.types,"text/html")>=0?n.getData("text/html"):null,mxUtils.indexOf(n.types,null==i||0==i.length)&&(i=n.getData("text/plain"))),null!=i)){i=this.editor.graph.zapGremlins(mxUtils.trim(i));var o=this.extractGraphModelFromHtml(i);null!=o&&(i=o)}}return null!=i&&this.isCompatibleString(i)&&(e=i),e},EditorUi.prototype.isCompatibleString=function(t){return!1},EditorUi.prototype.saveFile=function(t){if(t||null==this.editor.filename){var e=new FilenameDialog(this,this.editor.getOrCreateFilename(),mxResources.get("save"),mxUtils.bind(this,function(t){this.save(t)}),null,mxUtils.bind(this,function(t){return null!=t&&t.length>0||(mxUtils.confirm(mxResources.get("invalidName")),!1)}));this.showDialog(e.container,300,100,!0,!0),e.init()}else this.save(this.editor.getOrCreateFilename())},EditorUi.prototype.save=function(t){if(null!=t){this.editor.graph.isEditing()&&this.editor.graph.stopEditing();var e=mxUtils.getXml(this.editor.getGraphXml());try{if(Editor.useLocalStorage){if(null!=localStorage.getItem(t)&&!mxUtils.confirm(mxResources.get("replaceIt",[t])))return;localStorage.setItem(t,e),this.editor.setStatus(mxUtils.htmlEntities(mxResources.get("saved"))+" "+new Date)}else{if(!(e.length<MAX_REQUEST_SIZE))return mxUtils.alert(mxResources.get("drawingTooLarge")),void mxUtils.popup(e);new mxXmlRequest(SAVE_URL,"filename="+encodeURIComponent(t)+"&xml="+encodeURIComponent(e)).simulate(document,"_blank")}this.editor.setModified(!1),this.editor.setFilename(t),this.updateDocumentTitle()}catch(t){this.editor.setStatus(mxUtils.htmlEntities(mxResources.get("errorSavingFile")))}}},EditorUi.prototype.executeLayout=function(t,e,i){var n=this.editor.graph;if(n.isEnabled()){n.getModel().beginUpdate();try{t()}catch(t){throw t}finally{if(this.allowAnimation&&e&&navigator.userAgent.indexOf("Camino")<0){var o=new mxMorphing(n);o.addListener(mxEvent.DONE,mxUtils.bind(this,function(){n.getModel().endUpdate(),null!=i&&i()})),o.startAnimation()}else n.getModel().endUpdate(),null!=i&&i()}}},EditorUi.prototype.showImageDialog=function(t,e,i,n){var o=this.editor.graph.cellEditor,r=o.saveSelection(),s=mxUtils.prompt(t,e);if(o.restoreSelection(r),null!=s&&s.length>0){var l=new Image;l.onload=function(){i(s,l.width,l.height)},l.onerror=function(){i(null),mxUtils.alert(mxResources.get("fileNotFound"))},l.src=s}else i(null)},EditorUi.prototype.showLinkDialog=function(t,e,i){var n=new LinkDialog(this,t,e,i);this.showDialog(n.container,420,90,!0,!0),n.init()},EditorUi.prototype.showBackgroundImageDialog=function(t){t=null!=t?t:mxUtils.bind(this,function(t){var e=new ChangeGraphBackground(this,null,t);e.ignoreColor=!0,this.editor.graph.model.execute(e)});var e=mxUtils.prompt(mxResources.get("backgroundImage"),"");if(null!=e&&e.length>0){var i=new Image;i.onload=function(){t(new mxImage(e,i.width,i.height))},i.onerror=function(){t(null),mxUtils.alert(mxResources.get("fileNotFound"))},i.src=e}else t(null)},EditorUi.prototype.setBackgroundImage=function(t){this.editor.graph.setBackgroundImage(t),this.editor.graph.view.validateBackgroundImage(),this.fireEvent(new mxEventObject("backgroundImageChanged"))},EditorUi.prototype.confirm=function(t,e,i){mxUtils.confirm(t)?null!=e&&e():null!=i&&i()},EditorUi.prototype.createOutline=function(t){var e=new mxOutline(this.editor.graph);return e.border=20,mxEvent.addListener(window,"resize",function(){e.update()}),this.addListener("pageFormatChanged",function(){e.update()}),e},EditorUi.prototype.createKeyHandler=function(t){function e(t,e,i){s.push(function(){if(!n.isSelectionEmpty()&&n.isEnabled())if(e=null!=e?e:1,i){n.getModel().beginUpdate();try{for(var o=n.getSelectionCells(),r=0;r<o.length;r++)if(n.getModel().isVertex(o[r])&&n.isCellResizable(o[r])){var s=n.getCellGeometry(o[r]);null!=s&&(s=s.clone(),37==t?s.width=Math.max(0,s.width-e):38==t?s.height=Math.max(0,s.height-e):39==t?s.width+=e:40==t&&(s.height+=e),n.getModel().setGeometry(o[r],s))}}finally{n.getModel().endUpdate()}}else{var l=n.getSelectionCell(),a=n.model.getParent(l),d=null;if(1==n.getSelectionCount()&&n.model.isVertex(l)&&null!=n.layoutManager&&!n.isCellLocked(l)&&(d=n.layoutManager.getLayout(a)),null!=d&&d.constructor==mxStackLayout){var h=a.getIndex(l);37==t||38==t?n.model.add(a,l,Math.max(0,h-1)):39!=t&&40!=t||n.model.add(a,l,Math.min(n.model.getChildCount(a),h+1))}else{var c=0,u=0;37==t?c=-e:38==t?u=-e:39==t?c=e:40==t&&(u=e),n.moveCells(n.getMovableCells(n.getSelectionCells()),c,u)}}}),null!=l&&window.clearTimeout(l),l=window.setTimeout(function(){if(s.length>0){n.getModel().beginUpdate();try{for(var t=0;t<s.length;t++)s[t]();s=[]}finally{n.getModel().endUpdate()}n.scrollCellToVisible(n.getSelectionCell())}},200)}var i=this,n=this.editor.graph,o=new mxKeyHandler(n),r=o.isEventIgnored;o.isEventIgnored=function(t){return(!this.isControlDown(t)||mxEvent.isShiftDown(t)||90!=t.keyCode&&89!=t.keyCode&&188!=t.keyCode&&190!=t.keyCode&&85!=t.keyCode)&&(66!=t.keyCode&&73!=t.keyCode||!this.isControlDown(t)||this.graph.cellEditor.isContentEditing()&&!mxClient.IS_FF&&!mxClient.IS_SF)&&r.apply(this,arguments)},o.isEnabledForEvent=function(t){return!mxEvent.isConsumed(t)&&this.isGraphEvent(t)&&this.isEnabled()},o.isControlDown=function(t){return mxEvent.isControlDown(t)||mxClient.IS_MAC&&t.metaKey};var s=[],l=null,a={37:mxConstants.DIRECTION_WEST,38:mxConstants.DIRECTION_NORTH,39:mxConstants.DIRECTION_EAST,40:mxConstants.DIRECTION_SOUTH},d=o.getFunction,h={67:this.actions.get("clearWaypoints"),65:this.actions.get("connectionArrows"),80:this.actions.get("connectionPoints")};mxKeyHandler.prototype.getFunction=function(t){if(n.isEnabled()){if(mxEvent.isShiftDown(t)&&mxEvent.isAltDown(t)){var o=h[t.keyCode];if(null!=o)return o.funct}if(9==t.keyCode&&mxEvent.isAltDown(t))return mxEvent.isShiftDown(t)?function(){n.selectParentCell()}:function(){n.selectChildCell()};if(null!=a[t.keyCode]&&!n.isSelectionEmpty()){if(!mxEvent.isShiftDown(t)||!mxEvent.isAltDown(t))return this.isControlDown(t)?function(){e(t.keyCode,mxEvent.isShiftDown(t)?n.gridSize:null,!0)}:function(){e(t.keyCode,mxEvent.isShiftDown(t)?n.gridSize:null)};if(n.model.isVertex(n.getSelectionCell()))return function(){var e=n.connectVertex(n.getSelectionCell(),a[t.keyCode],n.defaultEdgeLength,t,!0);null!=e&&e.length>0&&(1==e.length&&n.model.isEdge(e[0])?n.setSelectionCell(n.model.getTerminal(e[0],!1)):n.setSelectionCell(e[e.length-1]),null!=i.hoverIcons&&i.hoverIcons.update(n.view.getState(n.getSelectionCell())))}}}return d.apply(this,arguments)},o.bindAction=mxUtils.bind(this,function(t,e,i,n){var r=this.actions.get(i);if(null!=r){var s=function(){r.isEnabled()&&r.funct()};e?n?o.bindControlShiftKey(t,s):o.bindControlKey(t,s):n?o.bindShiftKey(t,s):o.bindKey(t,s)}});var c=o.escape;return o.escape=function(t){c.apply(this,arguments)},o.enter=function(){},o.bindControlShiftKey(36,function(){n.exitGroup()}),o.bindControlShiftKey(35,function(){n.enterGroup()}),o.bindKey(36,function(){n.home()}),o.bindKey(35,function(){n.refresh()}),o.bindAction(107,!0,"zoomIn"),o.bindAction(109,!0,"zoomOut"),o.bindAction(80,!0,"print"),o.bindAction(79,!0,"outline",!0),o.bindAction(112,!1,"about"),this.editor.chromeless||(o.bindControlKey(36,function(){n.isEnabled()&&n.foldCells(!0)}),o.bindControlKey(35,function(){n.isEnabled()&&n.foldCells(!1)}),o.bindControlKey(13,function(){n.isEnabled()&&n.setSelectionCells(n.duplicateCells(n.getSelectionCells(),!1))}),o.bindAction(8,!1,"delete"),o.bindAction(8,!0,"deleteAll"),o.bindAction(46,!1,"delete"),o.bindAction(46,!0,"deleteAll"),o.bindAction(72,!0,"resetView"),o.bindAction(72,!0,"fitWindow",!0),o.bindAction(74,!0,"fitPage"),o.bindAction(74,!0,"fitTwoPages",!0),o.bindAction(48,!0,"customZoom"),o.bindAction(82,!0,"turn"),o.bindAction(82,!0,"clearDefaultStyle",!0),o.bindAction(83,!0,"save"),o.bindAction(83,!0,"saveAs",!0),o.bindAction(65,!0,"selectAll"),o.bindAction(65,!0,"selectNone",!0),o.bindAction(73,!0,"selectVertices",!0),o.bindAction(69,!0,"selectEdges",!0),o.bindAction(69,!0,"editStyle"),o.bindAction(66,!0,"bold"),o.bindAction(66,!0,"toBack",!0),o.bindAction(70,!0,"toFront",!0),o.bindAction(68,!0,"duplicate"),o.bindAction(68,!0,"setAsDefaultStyle",!0),o.bindAction(90,!0,"undo"),o.bindAction(89,!0,"autosize",!0),o.bindAction(88,!0,"cut"),o.bindAction(67,!0,"copy"),o.bindAction(86,!0,"paste"),o.bindAction(71,!0,"group"),o.bindAction(77,!0,"editData"),o.bindAction(71,!0,"grid",!0),o.bindAction(73,!0,"italic"),o.bindAction(76,!0,"lockUnlock"),o.bindAction(76,!0,"layers",!0),o.bindAction(80,!0,"formatPanel",!0),o.bindAction(85,!0,"underline"),o.bindAction(85,!0,"ungroup",!0),o.bindAction(190,!0,"superscript"),o.bindAction(188,!0,"subscript"),o.bindKey(13,function(){n.isEnabled()&&n.startEditingAtCell()}),o.bindKey(113,function(){n.isEnabled()&&n.startEditingAtCell()})),mxClient.IS_WIN?o.bindAction(89,!0,"redo"):o.bindAction(90,!0,"redo",!0),o},EditorUi.prototype.destroy=function(){if(null!=this.editor&&(this.editor.destroy(),this.editor=null),null!=this.menubar&&(this.menubar.destroy(),this.menubar=null),null!=this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),null!=this.sidebar&&(this.sidebar.destroy(),this.sidebar=null),null!=this.keyHandler&&(this.keyHandler.destroy(),this.keyHandler=null),null!=this.keydownHandler&&(mxEvent.removeListener(document,"keydown",this.keydownHandler),this.keydownHandler=null),null!=this.keyupHandler&&(mxEvent.removeListener(document,"keyup",this.keyupHandler),this.keyupHandler=null),null!=this.resizeHandler&&(mxEvent.removeListener(window,"resize",this.resizeHandler),this.resizeHandler=null),null!=this.gestureHandler&&(mxEvent.removeGestureListeners(document,this.gestureHandler),this.gestureHandler=null),null!=this.orientationChangeHandler&&(mxEvent.removeListener(window,"orientationchange",this.orientationChangeHandler),this.orientationChangeHandler=null),null!=this.scrollHandler&&(mxEvent.removeListener(window,"scroll",this.scrollHandler),this.scrollHandler=null),null!=this.destroyFunctions){for(e=0;e<this.destroyFunctions.length;e++)this.destroyFunctions[e]();this.destroyFunctions=null}for(var t=[this.menubarContainer,this.toolbarContainer,this.sidebarContainer,this.formatContainer,this.diagramContainer,this.footerContainer,this.chromelessToolbar,this.hsplit,this.sidebarFooterContainer,this.layersDialog],e=0;e<t.length;e++)null!=t[e]&&null!=t[e].parentNode&&t[e].parentNode.removeChild(t[e])};
/* 2017-11-20 */
function Actions(t){this.editorUi=t,this.actions=new Object,this.init()}function Action(t,e,n,l,i){mxEventSource.call(this),this.label=t,this.funct=this.createFunction(e),this.enabled=null==n||n,this.iconCls=l,this.shortcut=i,this.visible=!0}Actions.prototype.init=function(){function t(t){l.escape();var e=l.getDeletableCells(l.getSelectionCells());if(null!=e&&e.length>0){var n=l.model.getParents(e);if(l.removeCells(e,t),null!=n){for(var i=[],o=0;o<n.length;o++)l.model.contains(n[o])&&(l.model.isVertex(n[o])||l.model.isEdge(n[o]))&&i.push(n[o]);l.setSelectionCells(i)}}}var e=this.editorUi,n=e.editor,l=n.graph,i=function(){return Action.prototype.isEnabled.apply(this,arguments)&&l.isEnabled()};this.addAction("new...",function(){window.open(e.getUrl())}),this.addAction("open...",function(){window.openNew=!0,window.openKey="open",e.openFile()}),this.addAction("import...",function(){window.openNew=!1,window.openKey="import",window.openFile=new OpenFile(mxUtils.bind(this,function(){e.hideDialog()})),window.openFile.setConsumer(mxUtils.bind(this,function(t,e){try{var l=mxUtils.parseXml(t),i=new mxGraphModel;new mxCodec(l).decode(l.documentElement,i);var o=i.getChildren(i.getChildAt(i.getRoot(),0));n.graph.setSelectionCells(n.graph.importCells(o))}catch(t){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+t.message)}})),e.showDialog(new OpenDialog(this).container,320,220,!0,!0,function(){window.openFile=null})}).isEnabled=i,this.addAction("save",function(){e.saveFile(!1)},null,null,Editor.ctrlKey+"+S").isEnabled=i,this.addAction("saveAs...",function(){e.saveFile(!0)},null,null,Editor.ctrlKey+"+Shift+S").isEnabled=i,this.addAction("export...",function(){e.showDialog(new ExportDialog(e).container,300,230,!0,!0)}),this.addAction("editDiagram...",function(){var t=new EditDiagramDialog(e);e.showDialog(t.container,620,420,!0,!1),t.init()}),this.addAction("pageSetup...",function(){e.showDialog(new PageSetupDialog(e).container,320,220,!0,!0)}).isEnabled=i,this.addAction("print...",function(){e.showDialog(new PrintDialog(e).container,300,180,!0,!0)},null,"sprite-print",Editor.ctrlKey+"+P"),this.addAction("preview",function(){mxUtils.show(l,null,10,10)}),this.addAction("undo",function(){e.undo()},null,"sprite-undo",Editor.ctrlKey+"+Z"),this.addAction("redo",function(){e.redo()},null,"sprite-redo",mxClient.IS_WIN?Editor.ctrlKey+"+Y":Editor.ctrlKey+"+Shift+Z"),this.addAction("cut",function(){mxClipboard.cut(l)},null,"sprite-cut",Editor.ctrlKey+"+X"),this.addAction("copy",function(){mxClipboard.copy(l)},null,"sprite-copy",Editor.ctrlKey+"+C"),this.addAction("paste",function(){l.isEnabled()&&!l.isCellLocked(l.getDefaultParent())&&mxClipboard.paste(l)},!1,"sprite-paste",Editor.ctrlKey+"+V"),this.addAction("pasteHere",function(t){if(l.isEnabled()&&!l.isCellLocked(l.getDefaultParent())){l.getModel().beginUpdate();try{var e=mxClipboard.paste(l);if(null!=e){var n=l.getBoundingBoxFromGeometry(e);if(null!=n){var i=l.view.translate,o=l.view.scale,s=i.x,a=i.y,c=Math.round(l.snap(l.popupMenuHandler.triggerX/o-s)),d=Math.round(l.snap(l.popupMenuHandler.triggerY/o-a));l.cellsMoved(e,c-n.x,d-n.y)}}}finally{l.getModel().endUpdate()}}}),this.addAction("delete",function(e){t(null!=e&&mxEvent.isShiftDown(e))},null,null,"Delete"),this.addAction("deleteAll",function(){t(!0)},null,null,Editor.ctrlKey+"+Delete"),this.addAction("duplicate",function(){l.setSelectionCells(l.duplicateCells())},null,null,Editor.ctrlKey+"+D"),this.put("turn",new Action(mxResources.get("turn")+" / "+mxResources.get("reverse"),function(){l.turnShapes(l.getSelectionCells())},null,null,Editor.ctrlKey+"+R")),this.addAction("selectVertices",function(){l.selectVertices()},null,null,Editor.ctrlKey+"+Shift+I"),this.addAction("selectEdges",function(){l.selectEdges()},null,null,Editor.ctrlKey+"+Shift+E"),this.addAction("selectAll",function(){l.selectAll(null,!0)},null,null,Editor.ctrlKey+"+A"),this.addAction("selectNone",function(){l.clearSelection()},null,null,Editor.ctrlKey+"+Shift+A"),this.addAction("lockUnlock",function(){if(!l.isSelectionEmpty()){l.getModel().beginUpdate();try{var t=l.isCellMovable(l.getSelectionCell())?1:0;l.toggleCellStyles(mxConstants.STYLE_MOVABLE,t),l.toggleCellStyles(mxConstants.STYLE_RESIZABLE,t),l.toggleCellStyles(mxConstants.STYLE_ROTATABLE,t),l.toggleCellStyles(mxConstants.STYLE_DELETABLE,t),l.toggleCellStyles(mxConstants.STYLE_EDITABLE,t),l.toggleCellStyles("connectable",t)}finally{l.getModel().endUpdate()}}},null,null,Editor.ctrlKey+"+L"),this.addAction("home",function(){l.home()},null,null,"Home"),this.addAction("exitGroup",function(){l.exitGroup()},null,null,Editor.ctrlKey+"+Shift+Page Up"),this.addAction("enterGroup",function(){l.enterGroup()},null,null,Editor.ctrlKey+"+Shift+Page Down"),this.addAction("expand",function(){l.foldCells(!1)},null,null,Editor.ctrlKey+"+Page Down"),this.addAction("collapse",function(){l.foldCells(!0)},null,null,Editor.ctrlKey+"+Page Up"),this.addAction("toFront",function(){l.orderCells(!1)},null,null,Editor.ctrlKey+"+Shift+F"),this.addAction("toBack",function(){l.orderCells(!0)},null,null,Editor.ctrlKey+"+Shift+B"),this.addAction("group",function(){1==l.getSelectionCount()?l.setCellStyles("container","1"):l.setSelectionCell(l.groupCells(null,0))},null,null,Editor.ctrlKey+"+G"),this.addAction("ungroup",function(){1==l.getSelectionCount()&&0==l.getModel().getChildCount(l.getSelectionCell())?l.setCellStyles("container","0"):l.setSelectionCells(l.ungroupCells())},null,null,Editor.ctrlKey+"+Shift+U"),this.addAction("removeFromGroup",function(){l.removeCellsFromParent()}),this.addAction("edit",function(){l.isEnabled()&&l.startEditingAtCell()},null,null,"F2/Enter"),this.addAction("editData...",function(){var t=l.getSelectionCell()||l.getModel().getRoot();if(null!=t){var n=new EditDataDialog(e,t);e.showDialog(n.container,320,320,!0,!1),n.init()}},null,null,Editor.ctrlKey+"+M"),this.addAction("editTooltip...",function(){var t=e.editor.graph;if(t.isEnabled()&&!t.isSelectionEmpty()){var n=t.getSelectionCell(),l="";if(mxUtils.isNode(n.value)){var i=n.value.getAttribute("tooltip");null!=i&&(l=i)}var o=new TextareaDialog(e,mxResources.get("editTooltip")+":",l,function(e){t.setTooltipForCell(n,e)});e.showDialog(o.container,320,200,!0,!0),o.init()}}),this.addAction("openLink",function(){var t=l.getLinkForCell(l.getSelectionCell());null!=t&&window.open(t)}),this.addAction("editLink...",function(){var t=e.editor.graph;if(t.isEnabled()&&!t.isSelectionEmpty()){var n=t.getSelectionCell(),l=t.getLinkForCell(n)||"";e.showLinkDialog(l,mxResources.get("apply"),function(e){e=mxUtils.trim(e),t.setLinkForCell(n,e.length>0?e:null)})}}),this.addAction("insertLink...",function(){if(l.isEnabled()&&!l.isCellLocked(l.getDefaultParent())){var t=new LinkDialog(e,"",mxResources.get("insert"),function(t,e){if((t=mxUtils.trim(t)).length>0){var n=t.substring(t.lastIndexOf("/")+1),i=null;null!=e&&e.length>0&&(i=e[0].iconUrl,(n=(n=e[0].name||e[0].type).charAt(0).toUpperCase()+n.substring(1)).length>30&&(n=n.substring(0,30)+"..."));var o=l.getFreeInsertPoint(),s=new mxCell(n,new mxGeometry(o.x,o.y,100,40),"fontColor=#0000EE;fontStyle=4;rounded=1;overflow=hidden;"+(null!=i?"shape=label;imageWidth=16;imageHeight=16;spacingLeft=26;align=left;image="+i:"spacing=10;"));s.vertex=!0,l.setLinkForCell(s,t),l.cellSizeUpdated(s,!0),l.setSelectionCell(l.addCell(s)),l.scrollCellToVisible(l.getSelectionCell())}});e.showDialog(t.container,420,90,!0,!0),t.init()}}).isEnabled=i,this.addAction("link...",mxUtils.bind(this,function(){var t=e.editor.graph;if(t.isEnabled())if(t.cellEditor.isContentEditing()){var n=t.getParentByName(t.getSelectedElement(),"A",t.cellEditor.textarea),l="";null!=n&&(l=n.getAttribute("href")||"");var i=t.cellEditor.saveSelection();e.showLinkDialog(l,mxResources.get("apply"),mxUtils.bind(this,function(e){t.cellEditor.restoreSelection(i),null!=e&&t.insertLink(e)}))}else t.isSelectionEmpty()?this.get("insertLink").funct():this.get("editLink").funct()})).isEnabled=i,this.addAction("autosize",function(){var t=l.getSelectionCells();if(null!=t){l.getModel().beginUpdate();try{for(var e=0;e<t.length;e++){var n=t[e];if(l.getModel().getChildCount(n))l.updateGroupBounds([n],20);else{var i=l.view.getState(n),o=l.getCellGeometry(n);l.getModel().isVertex(n)&&null!=i&&null!=i.text&&null!=o&&l.isWrapping(n)?((o=o.clone()).height=i.text.boundingBox.height/l.view.scale,l.getModel().setGeometry(n,o)):l.updateCellSize(n)}}}finally{l.getModel().endUpdate()}}},null,null,Editor.ctrlKey+"+Shift+Y"),this.addAction("formattedText",function(){var t=l.getView().getState(l.getSelectionCell());if(null!=t){var n="1";l.stopEditing(),l.getModel().beginUpdate();try{if("1"==t.style.html){n=null;o=l.convertValueToString(t.cell);"0"!=mxUtils.getValue(t.style,"nl2Br","1")&&(o=o.replace(/\n/g,"").replace(/<br\s*.?>/g,"\n"));var i=document.createElement("div");i.innerHTML=o,o=mxUtils.extractTextWithWhitespace(i.childNodes),l.cellLabelChanged(t.cell,o)}else{var o=mxUtils.htmlEntities(l.convertValueToString(t.cell),!1);"0"!=mxUtils.getValue(t.style,"nl2Br","1")&&(o=o.replace(/\n/g,"<br/>")),l.cellLabelChanged(t.cell,l.sanitizeHtml(o))}l.setCellStyles("html",n),e.fireEvent(new mxEventObject("styleChanged","keys",["html"],"values",[null!=n?n:"0"],"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}}}),this.addAction("wordWrap",function(){var t=l.getView().getState(l.getSelectionCell()),e="wrap";l.stopEditing(),null!=t&&"wrap"==t.style[mxConstants.STYLE_WHITE_SPACE]&&(e=null),l.setCellStyles(mxConstants.STYLE_WHITE_SPACE,e)}),this.addAction("rotation",function(){var t="0",n=l.getView().getState(l.getSelectionCell());null!=n&&(t=n.style[mxConstants.STYLE_ROTATION]||t);var i=new FilenameDialog(e,t,mxResources.get("apply"),function(t){null!=t&&t.length>0&&l.setCellStyles(mxConstants.STYLE_ROTATION,t)},mxResources.get("enterValue")+" ("+mxResources.get("rotation")+" 0-360)");e.showDialog(i.container,300,80,!0,!0),i.init()}),this.addAction("resetView",function(){l.zoomTo(1),e.resetScrollbars()},null,null,Editor.ctrlKey+"+H"),this.addAction("zoomIn",function(t){l.zoomIn()},null,null,Editor.ctrlKey+" + (Numpad) / Alt+Mousewheel"),this.addAction("zoomOut",function(t){l.zoomOut()},null,null,Editor.ctrlKey+" - (Numpad) / Alt+Mousewheel"),this.addAction("fitWindow",function(){l.fit()},null,null,Editor.ctrlKey+"+Shift+H"),this.addAction("fitPage",mxUtils.bind(this,function(){l.pageVisible||this.get("pageView").funct();var t=l.pageFormat,e=l.pageScale,n=l.container.clientWidth-10,i=l.container.clientHeight-10,o=Math.floor(20*Math.min(n/t.width/e,i/t.height/e))/20;if(l.zoomTo(o),mxUtils.hasScrollbars(l.container)){var s=l.getPagePadding();l.container.scrollTop=s.y*l.view.scale,l.container.scrollLeft=Math.min(s.x*l.view.scale,(l.container.scrollWidth-l.container.clientWidth)/2)}}),null,null,Editor.ctrlKey+"+J"),this.addAction("fitTwoPages",mxUtils.bind(this,function(){l.pageVisible||this.get("pageView").funct();var t=l.pageFormat,e=l.pageScale,n=l.container.clientWidth-10,i=l.container.clientHeight-10,o=Math.floor(20*Math.min(n/(2*t.width)/e,i/t.height/e))/20;if(l.zoomTo(o),mxUtils.hasScrollbars(l.container)){var s=l.getPagePadding();l.container.scrollTop=Math.min(s.y,(l.container.scrollHeight-l.container.clientHeight)/2),l.container.scrollLeft=Math.min(s.x,(l.container.scrollWidth-l.container.clientWidth)/2)}}),null,null,Editor.ctrlKey+"+Shift+J"),this.addAction("fitPageWidth",mxUtils.bind(this,function(){l.pageVisible||this.get("pageView").funct();var t=l.pageFormat,e=l.pageScale,n=l.container.clientWidth-10,i=Math.floor(20*n/t.width/e)/20;if(l.zoomTo(i),mxUtils.hasScrollbars(l.container)){var o=l.getPagePadding();l.container.scrollLeft=Math.min(o.x*l.view.scale,(l.container.scrollWidth-l.container.clientWidth)/2)}})),this.put("customZoom",new Action(mxResources.get("custom")+"...",mxUtils.bind(this,function(){var t=new FilenameDialog(this.editorUi,parseInt(100*l.getView().getScale()),mxResources.get("apply"),mxUtils.bind(this,function(t){var e=parseInt(t);!isNaN(e)&&e>0&&l.zoomTo(e/100)}),mxResources.get("zoom")+" (%)");this.editorUi.showDialog(t.container,300,80,!0,!0),t.init()}),null,null,Editor.ctrlKey+"+0")),this.addAction("pageScale...",mxUtils.bind(this,function(){var t=new FilenameDialog(this.editorUi,parseInt(100*l.pageScale),mxResources.get("apply"),mxUtils.bind(this,function(t){var n=parseInt(t);!isNaN(n)&&n>0&&e.setPageScale(n/100)}),mxResources.get("pageScale")+" (%)");this.editorUi.showDialog(t.container,300,80,!0,!0),t.init()}));var o=null;(o=this.addAction("grid",function(){l.setGridEnabled(!l.isGridEnabled()),e.fireEvent(new mxEventObject("gridEnabledChanged"))},null,null,Editor.ctrlKey+"+Shift+G")).setToggleAction(!0),o.setSelectedCallback(function(){return l.isGridEnabled()}),o.setEnabled(!1),(o=this.addAction("guides",function(){l.graphHandler.guidesEnabled=!l.graphHandler.guidesEnabled,e.fireEvent(new mxEventObject("guidesEnabledChanged"))})).setToggleAction(!0),o.setSelectedCallback(function(){return l.graphHandler.guidesEnabled}),o.setEnabled(!1),(o=this.addAction("tooltips",function(){l.tooltipHandler.setEnabled(!l.tooltipHandler.isEnabled())})).setToggleAction(!0),o.setSelectedCallback(function(){return l.tooltipHandler.isEnabled()}),(o=this.addAction("collapseExpand",function(){e.setFoldingEnabled(!l.foldingEnabled)})).setToggleAction(!0),o.setSelectedCallback(function(){return l.foldingEnabled}),o.isEnabled=i,(o=this.addAction("scrollbars",function(){e.setScrollbars(!e.hasScrollbars())})).setToggleAction(!0),o.setSelectedCallback(function(){return l.scrollbars}),(o=this.addAction("pageView",mxUtils.bind(this,function(){e.setPageVisible(!l.pageVisible)}))).setToggleAction(!0),o.setSelectedCallback(function(){return l.pageVisible}),(o=this.addAction("connectionArrows",function(){l.connectionArrowsEnabled=!l.connectionArrowsEnabled,e.fireEvent(new mxEventObject("connectionArrowsChanged"))},null,null,"Alt+Shift+A")).setToggleAction(!0),o.setSelectedCallback(function(){return l.connectionArrowsEnabled}),(o=this.addAction("connectionPoints",function(){l.setConnectable(!l.connectionHandler.isEnabled()),e.fireEvent(new mxEventObject("connectionPointsChanged"))},null,null,"Alt+Shift+P")).setToggleAction(!0),o.setSelectedCallback(function(){return l.connectionHandler.isEnabled()}),(o=this.addAction("copyConnect",function(){l.connectionHandler.setCreateTarget(!l.connectionHandler.isCreateTarget()),e.fireEvent(new mxEventObject("copyConnectChanged"))})).setToggleAction(!0),o.setSelectedCallback(function(){return l.connectionHandler.isCreateTarget()}),o.isEnabled=i,(o=this.addAction("autosave",function(){e.editor.setAutosave(!e.editor.autosave)})).setToggleAction(!0),o.setSelectedCallback(function(){return e.editor.autosave}),o.isEnabled=i,o.visible=!1,this.addAction("help",function(){var t="";mxResources.isLanguageSupported(mxClient.language)&&(t="_"+mxClient.language),window.open(RESOURCES_PATH+"/help"+t+".html")}),this.put("about",new Action(mxResources.get("about")+" Graph Editor...",function(){e.showDialog(new AboutDialog(e).container,320,280,!0,!0)},null,null,"F1"));var s=mxUtils.bind(this,function(t,e,n,i){return this.addAction(t,function(){null!=n&&l.cellEditor.isContentEditing()?n():(l.stopEditing(!1),l.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,e))},null,null,i)});s("bold",mxConstants.FONT_BOLD,function(){document.execCommand("bold",!1,null)},Editor.ctrlKey+"+B"),s("italic",mxConstants.FONT_ITALIC,function(){document.execCommand("italic",!1,null)},Editor.ctrlKey+"+I"),s("underline",mxConstants.FONT_UNDERLINE,function(){document.execCommand("underline",!1,null)},Editor.ctrlKey+"+U"),this.addAction("fontColor...",function(){e.menus.pickColor(mxConstants.STYLE_FONTCOLOR,"forecolor","000000")}),this.addAction("strokeColor...",function(){e.menus.pickColor(mxConstants.STYLE_STROKECOLOR)}),this.addAction("fillColor...",function(){e.menus.pickColor(mxConstants.STYLE_FILLCOLOR)}),this.addAction("gradientColor...",function(){e.menus.pickColor(mxConstants.STYLE_GRADIENTCOLOR)}),this.addAction("backgroundColor...",function(){e.menus.pickColor(mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"backcolor")}),this.addAction("borderColor...",function(){e.menus.pickColor(mxConstants.STYLE_LABEL_BORDERCOLOR)}),this.addAction("vertical",function(){e.menus.toggleStyle(mxConstants.STYLE_HORIZONTAL,!0)}),this.addAction("shadow",function(){e.menus.toggleStyle(mxConstants.STYLE_SHADOW)}),this.addAction("solid",function(){l.getModel().beginUpdate();try{l.setCellStyles(mxConstants.STYLE_DASHED,null),l.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",[null,null],"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}}),this.addAction("dashed",function(){l.getModel().beginUpdate();try{l.setCellStyles(mxConstants.STYLE_DASHED,"1"),l.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1",null],"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}}),this.addAction("dotted",function(){l.getModel().beginUpdate();try{l.setCellStyles(mxConstants.STYLE_DASHED,"1"),l.setCellStyles(mxConstants.STYLE_DASH_PATTERN,"1 4"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1","1 4"],"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}}),this.addAction("sharp",function(){l.getModel().beginUpdate();try{l.setCellStyles(mxConstants.STYLE_ROUNDED,"0"),l.setCellStyles(mxConstants.STYLE_CURVED,"0"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","0"],"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}}),this.addAction("rounded",function(){l.getModel().beginUpdate();try{l.setCellStyles(mxConstants.STYLE_ROUNDED,"1"),l.setCellStyles(mxConstants.STYLE_CURVED,"0"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["1","0"],"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}}),this.addAction("toggleRounded",function(){if(!l.isSelectionEmpty()&&l.isEnabled()){l.getModel().beginUpdate();try{var t=l.getSelectionCells(),n=l.view.getState(t[0]),i=null!=n?n.style:l.getCellStyle(t[0]),o="1"==mxUtils.getValue(i,mxConstants.STYLE_ROUNDED,"0")?"0":"1";l.setCellStyles(mxConstants.STYLE_ROUNDED,o),l.setCellStyles(mxConstants.STYLE_CURVED,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",[o,"0"],"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}}}),this.addAction("curved",function(){l.getModel().beginUpdate();try{l.setCellStyles(mxConstants.STYLE_ROUNDED,"0"),l.setCellStyles(mxConstants.STYLE_CURVED,"1"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","1"],"cells",l.getSelectionCells()))}finally{l.getModel().endUpdate()}}),this.addAction("collapsible",function(){var t=l.view.getState(l.getSelectionCell()),n="1";null!=t&&null!=l.getFoldingImage(t)&&(n="0"),l.setCellStyles("collapsible",n),e.fireEvent(new mxEventObject("styleChanged","keys",["collapsible"],"values",[n],"cells",l.getSelectionCells()))}),this.addAction("editStyle...",mxUtils.bind(this,function(){var t=l.getSelectionCells();if(null!=t&&t.length>0){var e=l.getModel(),n=new TextareaDialog(this.editorUi,mxResources.get("editStyle")+":",e.getStyle(t[0])||"",function(e){null!=e&&l.setCellStyle(mxUtils.trim(e),t)},null,null,400,220);this.editorUi.showDialog(n.container,420,300,!0,!0),n.init()}}),null,null,Editor.ctrlKey+"+E"),this.addAction("setAsDefaultStyle",function(){l.isEnabled()&&!l.isSelectionEmpty()&&e.setDefaultStyle(l.getSelectionCell())},null,null,Editor.ctrlKey+"+Shift+D"),this.addAction("clearDefaultStyle",function(){l.isEnabled()&&e.clearDefaultStyle()},null,null,Editor.ctrlKey+"+Shift+R"),this.addAction("addWaypoint",function(){var t=l.getSelectionCell();if(null!=t&&l.getModel().isEdge(t)){var e=n.graph.selectionCellsHandler.getHandler(t);if(e instanceof mxEdgeHandler){for(var i=l.view.translate,o=l.view.scale,s=i.x,a=i.y,c=l.getModel().getParent(t),d=l.getCellGeometry(c);l.getModel().isVertex(c)&&null!=d;)s+=d.x,a+=d.y,c=l.getModel().getParent(c),d=l.getCellGeometry(c);var r=Math.round(l.snap(l.popupMenuHandler.triggerX/o-s)),u=Math.round(l.snap(l.popupMenuHandler.triggerY/o-a));e.addPointAt(e.state,r,u)}}}),this.addAction("removeWaypoint",function(){var t=e.actions.get("removeWaypoint");null!=t.handler&&t.handler.removePoint(t.handler.state,t.index)}),this.addAction("clearWaypoints",function(){var t=l.getSelectionCells();if(null!=t){t=l.addAllEdges(t),l.getModel().beginUpdate();try{for(var e=0;e<t.length;e++){var n=t[e];if(l.getModel().isEdge(n)){var i=l.getCellGeometry(n);null!=i&&((i=i.clone()).points=null,l.getModel().setGeometry(n,i))}}}finally{l.getModel().endUpdate()}}},null,null,"Alt+Shift+C"),o=this.addAction("subscript",mxUtils.bind(this,function(){l.cellEditor.isContentEditing()&&document.execCommand("subscript",!1,null)}),null,null,Editor.ctrlKey+"+,"),o=this.addAction("superscript",mxUtils.bind(this,function(){l.cellEditor.isContentEditing()&&document.execCommand("superscript",!1,null)}),null,null,Editor.ctrlKey+"+."),this.addAction("image...",function(){if(l.isEnabled()&&!l.isCellLocked(l.getDefaultParent())){var t=mxResources.get("image")+" ("+mxResources.get("url")+"):",n=l.getView().getState(l.getSelectionCell()),i="";null!=n&&(i=n.style[mxConstants.STYLE_IMAGE]||i);var o=l.cellEditor.saveSelection();e.showImageDialog(t,i,function(t,e,n){if(l.cellEditor.isContentEditing())l.cellEditor.restoreSelection(o),l.insertImage(t,e,n);else{var i=l.getSelectionCells();if(null!=t){var s=null;l.getModel().beginUpdate();try{if(0==i.length){var a=l.getFreeInsertPoint();s=i=[l.insertVertex(l.getDefaultParent(),null,"",a.x,a.y,e,n,"shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;")]}l.setCellStyles(mxConstants.STYLE_IMAGE,t,i);var c=l.view.getState(i[0]),d=null!=c?c.style:l.getCellStyle(i[0]);if("image"!=d[mxConstants.STYLE_SHAPE]&&"label"!=d[mxConstants.STYLE_SHAPE]&&l.setCellStyles(mxConstants.STYLE_SHAPE,"image",i),1==l.getSelectionCount()&&null!=e&&null!=n){var r=i[0],u=l.getModel().getGeometry(r);null!=u&&((u=u.clone()).width=e,u.height=n,l.getModel().setGeometry(r,u))}}finally{l.getModel().endUpdate()}null!=s&&(l.setSelectionCells(s),l.scrollCellToVisible(s[0]))}}},l.cellEditor.isContentEditing(),!l.cellEditor.isContentEditing())}}).isEnabled=i,this.addAction("insertImage...",function(){l.isEnabled()&&!l.isCellLocked(l.getDefaultParent())&&(l.clearSelection(),e.actions.get("image").funct())}).isEnabled=i,(o=this.addAction("layers",mxUtils.bind(this,function(){null==this.layersWindow?(this.layersWindow=new LayersWindow(e,document.body.offsetWidth-280,120,220,180),this.layersWindow.window.addListener("show",function(){e.fireEvent(new mxEventObject("layers"))}),this.layersWindow.window.addListener("hide",function(){e.fireEvent(new mxEventObject("layers"))}),this.layersWindow.window.setVisible(!0),e.fireEvent(new mxEventObject("layers"))):this.layersWindow.window.setVisible(!this.layersWindow.window.isVisible())}),null,null,Editor.ctrlKey+"+Shift+L")).setToggleAction(!0),o.setSelectedCallback(mxUtils.bind(this,function(){return null!=this.layersWindow&&this.layersWindow.window.isVisible()})),(o=this.addAction("formatPanel",mxUtils.bind(this,function(){e.toggleFormatPanel()}),null,null,Editor.ctrlKey+"+Shift+P")).setToggleAction(!0),o.setSelectedCallback(mxUtils.bind(this,function(){return e.formatWidth>0})),(o=this.addAction("outline",mxUtils.bind(this,function(){null==this.outlineWindow?(this.outlineWindow=new OutlineWindow(e,document.body.offsetWidth-260,100,180,180),this.outlineWindow.window.addListener("show",function(){e.fireEvent(new mxEventObject("outline"))}),this.outlineWindow.window.addListener("hide",function(){e.fireEvent(new mxEventObject("outline"))}),this.outlineWindow.window.setVisible(!0),e.fireEvent(new mxEventObject("outline"))):this.outlineWindow.window.setVisible(!this.outlineWindow.window.isVisible()),e.fireEvent(new mxEventObject("outline"))}),null,null,Editor.ctrlKey+"+Shift+O")).setToggleAction(!0),o.setSelectedCallback(mxUtils.bind(this,function(){return null!=this.outlineWindow&&this.outlineWindow.window.isVisible()}))},Actions.prototype.addAction=function(t,e,n,l,i){var o;return"..."==t.substring(t.length-3)?(t=t.substring(0,t.length-3),o=mxResources.get(t)+"..."):o=mxResources.get(t),this.put(t,new Action(o,e,n,l,i))},Actions.prototype.put=function(t,e){return this.actions[t]=e,e},Actions.prototype.get=function(t){return this.actions[t]},mxUtils.extend(Action,mxEventSource),Action.prototype.createFunction=function(t){return t},Action.prototype.setEnabled=function(t){this.enabled!=t&&(this.enabled=t,this.fireEvent(new mxEventObject("stateChanged")))},Action.prototype.isEnabled=function(){return this.enabled},Action.prototype.setToggleAction=function(t){this.toggleAction=t},Action.prototype.setSelectedCallback=function(t){this.selectedCallback=t},Action.prototype.isSelected=function(){return this.selectedCallback()};